/* esm.sh - esbuild bundle(@automerge/automerge-repo@2.0.0-alpha.11/slim) es2022 production */
(()=>{var a=typeof Reflect=="object"?Reflect:null,g=a&&typeof a.apply=="function"?a.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},p;a&&typeof a.ownKeys=="function"?p=a.ownKeys:Object.getOwnPropertySymbols?p=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:p=function(e){return Object.getOwnPropertyNames(e)};function D(n){console&&console.warn&&console.warn(n)}var w=Number.isNaN||function(e){return e!==e};function s(){L.call(this)}s.EventEmitter=s;s.prototype._events=void 0;s.prototype._eventsCount=0;s.prototype._maxListeners=void 0;var y=10;function d(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return y},set:function(n){if(typeof n!="number"||n<0||w(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");y=n}});function L(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}s.init=L;s.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||w(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function b(n){return n._maxListeners===void 0?s.defaultMaxListeners:n._maxListeners}s.prototype.getMaxListeners=function(){return b(this)};s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i=e==="error",u=this._events;if(u!==void 0)i=i&&u.error===void 0;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var l=u[e];if(l===void 0)return!1;if(typeof l=="function")g(l,this,t);else for(var m=l.length,M=x(l,m),r=0;r<m;++r)g(M[r],this,t);return!0};function _(n,e,t,r){var i,u,o;if(d(t),u=n._events,u===void 0?(u=n._events=Object.create(null),n._eventsCount=0):(u.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),u=n._events),o=u[e]),o===void 0)o=u[e]=t,++n._eventsCount;else if(typeof o=="function"?o=u[e]=r?[t,o]:[o,t]:r?o.unshift(t):o.push(t),i=b(n),i>0&&o.length>i&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=n,c.type=e,c.count=o.length,D(c)}return n}s.prototype.addListener=function(e,t){return _(this,e,t,!1)};s.prototype.on=s.prototype.addListener;s.prototype.prependListener=function(e,t){return _(this,e,t,!0)};function R(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function E(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=R.bind(r);return i.listener=t,r.wrapFn=i,i}s.prototype.once=function(e,t){return d(t),this.on(e,E(this,e,t)),this};s.prototype.prependOnceListener=function(e,t){return d(t),this.prependListener(e,E(this,e,t)),this};s.prototype.removeListener=function(e,t){var r,i,u,o,c;if(d(t),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(u=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){c=r[o].listener,u=o;break}if(u<0)return this;u===0?r.shift():N(r,u),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,c||t)}return this};s.prototype.off=s.prototype.removeListener;s.prototype.removeAllListeners=function(e){var t,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var u=Object.keys(r),o;for(i=0;i<u.length;++i)o=u[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function O(n,e,t){var r=n._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?P(i):x(i,i.length)}s.prototype.listeners=function(e){return O(this,e,!0)};s.prototype.rawListeners=function(e){return O(this,e,!1)};function C(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):s.prototype.listenerCount.call(n,e)}s.listenerCount=C;s.prototype.listenerCount=function(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0};s.prototype.eventNames=function(){return this._eventsCount>0?p(this._events):[]};function x(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}function N(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function P(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function v(n){let e=performance.now(),t=Math.floor(e/1e3),r=Math.floor(e*1e6-t*1e9);if(!n)return[t,r];let[i,u]=n;return[t-i,r-u]}v.bigint=function(){let[n,e]=v();return BigInt(n)*1000000000n+BigInt(e)};var h=class extends s{title="browser";browser=!0;env={};argv=[];pid=0;arch="unknown";platform="browser";version="";versions={};emitWarning=()=>{throw new Error("process.emitWarning is not supported")};binding=()=>{throw new Error("process.binding is not supported")};cwd=()=>{throw new Error("process.cwd is not supported")};chdir=e=>{throw new Error("process.chdir is not supported")};umask=()=>18;nextTick=(e,...t)=>queueMicrotask(()=>e(...t));hrtime=v;constructor(){super()}},f=new h;if(typeof Deno<"u"){f.name="deno",f.browser=!1,f.pid=Deno.pid,f.cwd=()=>Deno.cwd(),f.chdir=e=>Deno.chdir(e),f.arch=Deno.build.arch,f.platform=Deno.build.os,f.version="v18.12.1",f.versions={node:"18.12.1",uv:"1.43.0",zlib:"1.2.11",brotli:"1.0.9",ares:"1.18.1",modules:"108",nghttp2:"1.47.0",napi:"8",llhttp:"6.0.10",openssl:"3.0.7+quic",cldr:"41.0",icu:"71.1",tz:"2022b",unicode:"14.0",ngtcp2:"0.8.1",nghttp3:"0.7.0",...Deno.version},f.env=new Proxy({},{get(e,t){return Deno.env.get(String(t))},ownKeys:()=>Reflect.ownKeys(Deno.env.toObject()),getOwnPropertyDescriptor:(e,t)=>{let r=Deno.env.toObject();if(t in Deno.env.toObject()){let i={enumerable:!0,configurable:!0};return typeof t=="string"&&(i.value=r[t]),i}},set(e,t,r){return Deno.env.set(String(t),String(r)),r}});let n=["","",...Deno.args];Object.defineProperty(n,"0",{get:Deno.execPath}),Object.defineProperty(n,"1",{get:()=>Deno.mainModule.startsWith("file:")?new URL(Deno.mainModule).pathname:join(Deno.cwd(),"$deno$node.js")}),f.argv=n}else{let n="/";f.cwd=()=>n,f.chdir=e=>n=e}var j=f;globalThis.__Process$=j;})();
(()=>{var Lt=Object.create,q=Object.defineProperty,_t=Object.getOwnPropertyDescriptor,xt=Object.getOwnPropertyNames,Ct=Object.getPrototypeOf,Mt=Object.prototype.hasOwnProperty,W=(p,a)=>()=>(a||p((a={exports:{}}).exports,a),a.exports),Pt=(p,a)=>{for(var s in a)q(p,s,{get:a[s],enumerable:!0})},V=(p,a,s,S)=>{if(a&&typeof a=="object"||typeof a=="function")for(let b of xt(a))!Mt.call(p,b)&&b!==s&&q(p,b,{get:()=>a[b],enumerable:!(S=_t(a,b))||S.enumerable});return p},$t=(p,a,s)=>(V(p,a,"default"),s&&V(s,a,"default")),st=(p,a,s)=>(s=p!=null?Lt(Ct(p)):{},V(a||!p||!p.__esModule?q(s,"default",{value:p,enumerable:!0}):s,p)),Nt=W(p=>{"use strict";p.byteLength=T,p.toByteArray=$,p.fromByteArray=P;var a=[],s=[],S=typeof Uint8Array<"u"?Uint8Array:Array,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(B=0,c=b.length;B<c;++B)a[B]=b[B],s[b.charCodeAt(B)]=B;var B,c;s[45]=62,s[95]=63;function f(h){var l=h.length;if(l%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var w=h.indexOf("=");w===-1&&(w=l);var A=w===l?0:4-w%4;return[w,A]}function T(h){var l=f(h),w=l[0],A=l[1];return(w+A)*3/4-A}function L(h,l,w){return(l+w)*3/4-w}function $(h){var l,w=f(h),A=w[0],_=w[1],E=new S(L(h,A,_)),x=0,M=_>0?A-4:A,O;for(O=0;O<M;O+=4)l=s[h.charCodeAt(O)]<<18|s[h.charCodeAt(O+1)]<<12|s[h.charCodeAt(O+2)]<<6|s[h.charCodeAt(O+3)],E[x++]=l>>16&255,E[x++]=l>>8&255,E[x++]=l&255;return _===2&&(l=s[h.charCodeAt(O)]<<2|s[h.charCodeAt(O+1)]>>4,E[x++]=l&255),_===1&&(l=s[h.charCodeAt(O)]<<10|s[h.charCodeAt(O+1)]<<4|s[h.charCodeAt(O+2)]>>2,E[x++]=l>>8&255,E[x++]=l&255),E}function m(h){return a[h>>18&63]+a[h>>12&63]+a[h>>6&63]+a[h&63]}function U(h,l,w){for(var A,_=[],E=l;E<w;E+=3)A=(h[E]<<16&16711680)+(h[E+1]<<8&65280)+(h[E+2]&255),_.push(m(A));return _.join("")}function P(h){for(var l,w=h.length,A=w%3,_=[],E=16383,x=0,M=w-A;x<M;x+=E)_.push(U(h,x,x+E>M?M:x+E));return A===1?(l=h[w-1],_.push(a[l>>2]+a[l<<4&63]+"==")):A===2&&(l=(h[w-2]<<8)+h[w-1],_.push(a[l>>10]+a[l>>4&63]+a[l<<2&63]+"=")),_.join("")}}),jt=W(p=>{p.read=function(a,s,S,b,B){var c,f,T=B*8-b-1,L=(1<<T)-1,$=L>>1,m=-7,U=S?B-1:0,P=S?-1:1,h=a[s+U];for(U+=P,c=h&(1<<-m)-1,h>>=-m,m+=T;m>0;c=c*256+a[s+U],U+=P,m-=8);for(f=c&(1<<-m)-1,c>>=-m,m+=b;m>0;f=f*256+a[s+U],U+=P,m-=8);if(c===0)c=1-$;else{if(c===L)return f?NaN:(h?-1:1)*(1/0);f=f+Math.pow(2,b),c=c-$}return(h?-1:1)*f*Math.pow(2,c-b)},p.write=function(a,s,S,b,B,c){var f,T,L,$=c*8-B-1,m=(1<<$)-1,U=m>>1,P=B===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=b?0:c-1,l=b?1:-1,w=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(T=isNaN(s)?1:0,f=m):(f=Math.floor(Math.log(s)/Math.LN2),s*(L=Math.pow(2,-f))<1&&(f--,L*=2),f+U>=1?s+=P/L:s+=P*Math.pow(2,1-U),s*L>=2&&(f++,L/=2),f+U>=m?(T=0,f=m):f+U>=1?(T=(s*L-1)*Math.pow(2,B),f=f+U):(T=s*Math.pow(2,U-1)*Math.pow(2,B),f=0));B>=8;a[S+h]=T&255,h+=l,T/=256,B-=8);for(f=f<<B|T,$+=B;$>0;a[S+h]=f&255,h+=l,f/=256,$-=8);a[S+h-l]|=w*128}}),ht=W(p=>{"use strict";var a=Nt(),s=jt(),S=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;p.Buffer=f,p.SlowBuffer=_,p.INSPECT_MAX_BYTES=50;var b=2147483647;p.kMaxLength=b,f.TYPED_ARRAY_SUPPORT=B(),!f.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function B(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch{return!1}}Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}});function c(t){if(t>b)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,f.prototype),e}function f(t,e,n){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(t)}return T(t,e,n)}f.poolSize=8192;function T(t,e,n){if(typeof t=="string")return U(t,e);if(ArrayBuffer.isView(t))return h(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(N(t,ArrayBuffer)||t&&N(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(N(t,SharedArrayBuffer)||t&&N(t.buffer,SharedArrayBuffer)))return l(t,e,n);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let r=t.valueOf&&t.valueOf();if(r!=null&&r!==t)return f.from(r,e,n);let o=w(t);if(o)return o;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return f.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}f.from=function(t,e,n){return T(t,e,n)},Object.setPrototypeOf(f.prototype,Uint8Array.prototype),Object.setPrototypeOf(f,Uint8Array);function L(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function $(t,e,n){return L(t),t<=0?c(t):e!==void 0?typeof n=="string"?c(t).fill(e,n):c(t).fill(e):c(t)}f.alloc=function(t,e,n){return $(t,e,n)};function m(t){return L(t),c(t<0?0:A(t)|0)}f.allocUnsafe=function(t){return m(t)},f.allocUnsafeSlow=function(t){return m(t)};function U(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!f.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let n=E(t,e)|0,r=c(n),o=r.write(t,e);return o!==n&&(r=r.slice(0,o)),r}function P(t){let e=t.length<0?0:A(t.length)|0,n=c(e);for(let r=0;r<e;r+=1)n[r]=t[r]&255;return n}function h(t){if(N(t,Uint8Array)){let e=new Uint8Array(t);return l(e.buffer,e.byteOffset,e.byteLength)}return P(t)}function l(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return e===void 0&&n===void 0?r=new Uint8Array(t):n===void 0?r=new Uint8Array(t,e):r=new Uint8Array(t,e,n),Object.setPrototypeOf(r,f.prototype),r}function w(t){if(f.isBuffer(t)){let e=A(t.length)|0,n=c(e);return n.length===0||t.copy(n,0,0,e),n}if(t.length!==void 0)return typeof t.length!="number"||X(t.length)?c(0):P(t);if(t.type==="Buffer"&&Array.isArray(t.data))return P(t.data)}function A(t){if(t>=b)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+b.toString(16)+" bytes");return t|0}function _(t){return+t!=t&&(t=0),f.alloc(+t)}f.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==f.prototype},f.compare=function(t,e){if(N(t,Uint8Array)&&(t=f.from(t,t.offset,t.byteLength)),N(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),!f.isBuffer(t)||!f.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,r=e.length;for(let o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return f.alloc(0);let n;if(e===void 0)for(e=0,n=0;n<t.length;++n)e+=t[n].length;let r=f.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){let i=t[n];if(N(i,Uint8Array))o+i.length>r.length?(f.isBuffer(i)||(i=f.from(i)),i.copy(r,o)):Uint8Array.prototype.set.call(r,i,o);else if(f.isBuffer(i))i.copy(r,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=i.length}return r};function E(t,e){if(f.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||N(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let n=t.length,r=arguments.length>2&&arguments[2]===!0;if(!r&&n===0)return 0;let o=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return G(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n*2;case"hex":return n>>>1;case"base64":return it(t).length;default:if(o)return r?-1:G(t).length;e=(""+e).toLowerCase(),o=!0}}f.byteLength=E;function x(t,e,n){let r=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((n===void 0||n>this.length)&&(n=this.length),n<=0)||(n>>>=0,e>>>=0,n<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return Et(this,e,n);case"utf8":case"utf-8":return H(this,e,n);case"ascii":return Bt(this,e,n);case"latin1":case"binary":return mt(this,e,n);case"base64":return dt(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return vt(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}f.prototype._isBuffer=!0;function M(t,e,n){let r=t[e];t[e]=t[n],t[n]=r}f.prototype.swap16=function(){let t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)M(this,e,e+1);return this},f.prototype.swap32=function(){let t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)M(this,e,e+3),M(this,e+1,e+2);return this},f.prototype.swap64=function(){let t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)M(this,e,e+7),M(this,e+1,e+6),M(this,e+2,e+5),M(this,e+3,e+4);return this},f.prototype.toString=function(){let t=this.length;return t===0?"":arguments.length===0?H(this,0,t):x.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:f.compare(this,t)===0},f.prototype.inspect=function(){let t="",e=p.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},S&&(f.prototype[S]=f.prototype.inspect),f.prototype.compare=function(t,e,n,r,o){if(N(t,Uint8Array)&&(t=f.from(t,t.offset,t.byteLength)),!f.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(e===void 0&&(e=0),n===void 0&&(n=t?t.length:0),r===void 0&&(r=0),o===void 0&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,o>>>=0,this===t)return 0;let i=o-r,u=n-e,g=Math.min(i,u),R=this.slice(r,o),d=t.slice(e,n);for(let y=0;y<g;++y)if(R[y]!==d[y]){i=R[y],u=d[y];break}return i<u?-1:u<i?1:0};function O(t,e,n,r,o){if(t.length===0)return-1;if(typeof n=="string"?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,X(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0)if(o)n=0;else return-1;if(typeof e=="string"&&(e=f.from(e,r)),f.isBuffer(e))return e.length===0?-1:Z(t,e,n,r,o);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):Z(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function Z(t,e,n,r,o){let i=1,u=t.length,g=e.length;if(r!==void 0&&(r=String(r).toLowerCase(),r==="ucs2"||r==="ucs-2"||r==="utf16le"||r==="utf-16le")){if(t.length<2||e.length<2)return-1;i=2,u/=2,g/=2,n/=2}function R(y,v){return i===1?y[v]:y.readUInt16BE(v*i)}let d;if(o){let y=-1;for(d=n;d<u;d++)if(R(t,d)===R(e,y===-1?0:d-y)){if(y===-1&&(y=d),d-y+1===g)return y*i}else y!==-1&&(d-=d-y),y=-1}else for(n+g>u&&(n=u-g),d=n;d>=0;d--){let y=!0;for(let v=0;v<g;v++)if(R(t,d+v)!==R(e,v)){y=!1;break}if(y)return d}return-1}f.prototype.includes=function(t,e,n){return this.indexOf(t,e,n)!==-1},f.prototype.indexOf=function(t,e,n){return O(this,t,e,n,!0)},f.prototype.lastIndexOf=function(t,e,n){return O(this,t,e,n,!1)};function pt(t,e,n,r){n=Number(n)||0;let o=t.length-n;r?(r=Number(r),r>o&&(r=o)):r=o;let i=e.length;r>i/2&&(r=i/2);let u;for(u=0;u<r;++u){let g=parseInt(e.substr(u*2,2),16);if(X(g))return u;t[n+u]=g}return u}function ct(t,e,n,r){return Y(G(e,t.length-n),t,n,r)}function gt(t,e,n,r){return Y(Rt(e),t,n,r)}function yt(t,e,n,r){return Y(it(e),t,n,r)}function wt(t,e,n,r){return Y(Tt(e,t.length-n),t,n,r)}f.prototype.write=function(t,e,n,r){if(e===void 0)r="utf8",n=this.length,e=0;else if(n===void 0&&typeof e=="string")r=e,n=this.length,e=0;else if(isFinite(e))e=e>>>0,isFinite(n)?(n=n>>>0,r===void 0&&(r="utf8")):(r=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-e;if((n===void 0||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return pt(this,t,e,n);case"utf8":case"utf-8":return ct(this,t,e,n);case"ascii":case"latin1":case"binary":return gt(this,t,e,n);case"base64":return yt(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return wt(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function dt(t,e,n){return e===0&&n===t.length?a.fromByteArray(t):a.fromByteArray(t.slice(e,n))}function H(t,e,n){n=Math.min(t.length,n);let r=[],o=e;for(;o<n;){let i=t[o],u=null,g=i>239?4:i>223?3:i>191?2:1;if(o+g<=n){let R,d,y,v;switch(g){case 1:i<128&&(u=i);break;case 2:R=t[o+1],(R&192)===128&&(v=(i&31)<<6|R&63,v>127&&(u=v));break;case 3:R=t[o+1],d=t[o+2],(R&192)===128&&(d&192)===128&&(v=(i&15)<<12|(R&63)<<6|d&63,v>2047&&(v<55296||v>57343)&&(u=v));break;case 4:R=t[o+1],d=t[o+2],y=t[o+3],(R&192)===128&&(d&192)===128&&(y&192)===128&&(v=(i&15)<<18|(R&63)<<12|(d&63)<<6|y&63,v>65535&&v<1114112&&(u=v))}}u===null?(u=65533,g=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|u&1023),r.push(u),o+=g}return bt(r)}var K=4096;function bt(t){let e=t.length;if(e<=K)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=K));return n}function Bt(t,e,n){let r="";n=Math.min(t.length,n);for(let o=e;o<n;++o)r+=String.fromCharCode(t[o]&127);return r}function mt(t,e,n){let r="";n=Math.min(t.length,n);for(let o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function Et(t,e,n){let r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);let o="";for(let i=e;i<n;++i)o+=Ot[t[i]];return o}function vt(t,e,n){let r=t.slice(e,n),o="";for(let i=0;i<r.length-1;i+=2)o+=String.fromCharCode(r[i]+r[i+1]*256);return o}f.prototype.slice=function(t,e){let n=this.length;t=~~t,e=e===void 0?n:~~e,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),e<t&&(e=t);let r=this.subarray(t,e);return Object.setPrototypeOf(r,f.prototype),r};function I(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}f.prototype.readUintLE=f.prototype.readUIntLE=function(t,e,n){t=t>>>0,e=e>>>0,n||I(t,e,this.length);let r=this[t],o=1,i=0;for(;++i<e&&(o*=256);)r+=this[t+i]*o;return r},f.prototype.readUintBE=f.prototype.readUIntBE=function(t,e,n){t=t>>>0,e=e>>>0,n||I(t,e,this.length);let r=this[t+--e],o=1;for(;e>0&&(o*=256);)r+=this[t+--e]*o;return r},f.prototype.readUint8=f.prototype.readUInt8=function(t,e){return t=t>>>0,e||I(t,1,this.length),this[t]},f.prototype.readUint16LE=f.prototype.readUInt16LE=function(t,e){return t=t>>>0,e||I(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUint16BE=f.prototype.readUInt16BE=function(t,e){return t=t>>>0,e||I(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUint32LE=f.prototype.readUInt32LE=function(t,e){return t=t>>>0,e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216},f.prototype.readUint32BE=f.prototype.readUInt32BE=function(t,e){return t=t>>>0,e||I(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readBigUInt64LE=j(function(t){t=t>>>0,F(t,"offset");let e=this[t],n=this[t+7];(e===void 0||n===void 0)&&D(t,this.length-8);let r=e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24,o=this[++t]+this[++t]*2**8+this[++t]*2**16+n*2**24;return BigInt(r)+(BigInt(o)<<BigInt(32))}),f.prototype.readBigUInt64BE=j(function(t){t=t>>>0,F(t,"offset");let e=this[t],n=this[t+7];(e===void 0||n===void 0)&&D(t,this.length-8);let r=e*2**24+this[++t]*2**16+this[++t]*2**8+this[++t],o=this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+n;return(BigInt(r)<<BigInt(32))+BigInt(o)}),f.prototype.readIntLE=function(t,e,n){t=t>>>0,e=e>>>0,n||I(t,e,this.length);let r=this[t],o=1,i=0;for(;++i<e&&(o*=256);)r+=this[t+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},f.prototype.readIntBE=function(t,e,n){t=t>>>0,e=e>>>0,n||I(t,e,this.length);let r=e,o=1,i=this[t+--r];for(;r>0&&(o*=256);)i+=this[t+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},f.prototype.readInt8=function(t,e){return t=t>>>0,e||I(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]},f.prototype.readInt16LE=function(t,e){t=t>>>0,e||I(t,2,this.length);let n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n},f.prototype.readInt16BE=function(t,e){t=t>>>0,e||I(t,2,this.length);let n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n},f.prototype.readInt32LE=function(t,e){return t=t>>>0,e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,e){return t=t>>>0,e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readBigInt64LE=j(function(t){t=t>>>0,F(t,"offset");let e=this[t],n=this[t+7];(e===void 0||n===void 0)&&D(t,this.length-8);let r=this[t+4]+this[t+5]*2**8+this[t+6]*2**16+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24)}),f.prototype.readBigInt64BE=j(function(t){t=t>>>0,F(t,"offset");let e=this[t],n=this[t+7];(e===void 0||n===void 0)&&D(t,this.length-8);let r=(e<<24)+this[++t]*2**16+this[++t]*2**8+this[++t];return(BigInt(r)<<BigInt(32))+BigInt(this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+n)}),f.prototype.readFloatLE=function(t,e){return t=t>>>0,e||I(t,4,this.length),s.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,e){return t=t>>>0,e||I(t,4,this.length),s.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,e){return t=t>>>0,e||I(t,8,this.length),s.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,e){return t=t>>>0,e||I(t,8,this.length),s.read(this,t,!1,52,8)};function C(t,e,n,r,o,i){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}f.prototype.writeUintLE=f.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e=e>>>0,n=n>>>0,!r){let u=Math.pow(2,8*n)-1;C(this,t,e,n,u,0)}let o=1,i=0;for(this[e]=t&255;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},f.prototype.writeUintBE=f.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e=e>>>0,n=n>>>0,!r){let u=Math.pow(2,8*n)-1;C(this,t,e,n,u,0)}let o=n-1,i=1;for(this[e+o]=t&255;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},f.prototype.writeUint8=f.prototype.writeUInt8=function(t,e,n){return t=+t,e=e>>>0,n||C(this,t,e,1,255,0),this[e]=t&255,e+1},f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(t,e,n){return t=+t,e=e>>>0,n||C(this,t,e,2,65535,0),this[e]=t&255,this[e+1]=t>>>8,e+2},f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(t,e,n){return t=+t,e=e>>>0,n||C(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=t&255,e+2},f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(t,e,n){return t=+t,e=e>>>0,n||C(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t&255,e+4},f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(t,e,n){return t=+t,e=e>>>0,n||C(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};function Q(t,e,n,r,o){ft(e,r,o,t,n,7);let i=Number(e&BigInt(4294967295));t[n++]=i,i=i>>8,t[n++]=i,i=i>>8,t[n++]=i,i=i>>8,t[n++]=i;let u=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=u,u=u>>8,t[n++]=u,u=u>>8,t[n++]=u,u=u>>8,t[n++]=u,n}function tt(t,e,n,r,o){ft(e,r,o,t,n,7);let i=Number(e&BigInt(4294967295));t[n+7]=i,i=i>>8,t[n+6]=i,i=i>>8,t[n+5]=i,i=i>>8,t[n+4]=i;let u=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=u,u=u>>8,t[n+2]=u,u=u>>8,t[n+1]=u,u=u>>8,t[n]=u,n+8}f.prototype.writeBigUInt64LE=j(function(t,e=0){return Q(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeBigUInt64BE=j(function(t,e=0){return tt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e=e>>>0,!r){let g=Math.pow(2,8*n-1);C(this,t,e,n,g-1,-g)}let o=0,i=1,u=0;for(this[e]=t&255;++o<n&&(i*=256);)t<0&&u===0&&this[e+o-1]!==0&&(u=1),this[e+o]=(t/i>>0)-u&255;return e+n},f.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e=e>>>0,!r){let g=Math.pow(2,8*n-1);C(this,t,e,n,g-1,-g)}let o=n-1,i=1,u=0;for(this[e+o]=t&255;--o>=0&&(i*=256);)t<0&&u===0&&this[e+o+1]!==0&&(u=1),this[e+o]=(t/i>>0)-u&255;return e+n},f.prototype.writeInt8=function(t,e,n){return t=+t,e=e>>>0,n||C(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=t&255,e+1},f.prototype.writeInt16LE=function(t,e,n){return t=+t,e=e>>>0,n||C(this,t,e,2,32767,-32768),this[e]=t&255,this[e+1]=t>>>8,e+2},f.prototype.writeInt16BE=function(t,e,n){return t=+t,e=e>>>0,n||C(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=t&255,e+2},f.prototype.writeInt32LE=function(t,e,n){return t=+t,e=e>>>0,n||C(this,t,e,4,2147483647,-2147483648),this[e]=t&255,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},f.prototype.writeInt32BE=function(t,e,n){return t=+t,e=e>>>0,n||C(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4},f.prototype.writeBigInt64LE=j(function(t,e=0){return Q(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),f.prototype.writeBigInt64BE=j(function(t,e=0){return tt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function et(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function nt(t,e,n,r,o){return e=+e,n=n>>>0,o||et(t,e,n,4,34028234663852886e22,-34028234663852886e22),s.write(t,e,n,r,23,4),n+4}f.prototype.writeFloatLE=function(t,e,n){return nt(this,t,e,!0,n)},f.prototype.writeFloatBE=function(t,e,n){return nt(this,t,e,!1,n)};function rt(t,e,n,r,o){return e=+e,n=n>>>0,o||et(t,e,n,8,17976931348623157e292,-17976931348623157e292),s.write(t,e,n,r,52,8),n+8}f.prototype.writeDoubleLE=function(t,e,n){return rt(this,t,e,!0,n)},f.prototype.writeDoubleBE=function(t,e,n){return rt(this,t,e,!1,n)},f.prototype.copy=function(t,e,n,r){if(!f.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),!r&&r!==0&&(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);let o=r-n;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),o},f.prototype.fill=function(t,e,n,r){if(typeof t=="string"){if(typeof e=="string"?(r=e,e=0,n=this.length):typeof n=="string"&&(r=n,n=this.length),r!==void 0&&typeof r!="string")throw new TypeError("encoding must be a string");if(typeof r=="string"&&!f.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(t.length===1){let i=t.charCodeAt(0);(r==="utf8"&&i<128||r==="latin1")&&(t=i)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e=e>>>0,n=n===void 0?this.length:n>>>0,t||(t=0);let o;if(typeof t=="number")for(o=e;o<n;++o)this[o]=t;else{let i=f.isBuffer(t)?t:f.from(t,r),u=i.length;if(u===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=i[o%u]}return this};var k={};function z(t,e,n){k[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(r){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:r,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}z("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),z("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError),z("ERR_OUT_OF_RANGE",function(t,e,n){let r=`The value of "${t}" is out of range.`,o=n;return Number.isInteger(n)&&Math.abs(n)>2**32?o=ot(String(n)):typeof n=="bigint"&&(o=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(o=ot(o)),o+="n"),r+=` It must be ${e}. Received ${o}`,r},RangeError);function ot(t){let e="",n=t.length,r=t[0]==="-"?1:0;for(;n>=r+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function At(t,e,n){F(e,"offset"),(t[e]===void 0||t[e+n]===void 0)&&D(e,t.length-(n+1))}function ft(t,e,n,r,o,i){if(t>n||t<e){let u=typeof e=="bigint"?"n":"",g;throw i>3?e===0||e===BigInt(0)?g=`>= 0${u} and < 2${u} ** ${(i+1)*8}${u}`:g=`>= -(2${u} ** ${(i+1)*8-1}${u}) and < 2 ** ${(i+1)*8-1}${u}`:g=`>= ${e}${u} and <= ${n}${u}`,new k.ERR_OUT_OF_RANGE("value",g,t)}At(r,o,i)}function F(t,e){if(typeof t!="number")throw new k.ERR_INVALID_ARG_TYPE(e,"number",t)}function D(t,e,n){throw Math.floor(t)!==t?(F(t,n),new k.ERR_OUT_OF_RANGE(n||"offset","an integer",t)):e<0?new k.ERR_BUFFER_OUT_OF_BOUNDS:new k.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}var It=/[^+/0-9A-Za-z-_]/g;function Ut(t){if(t=t.split("=")[0],t=t.trim().replace(It,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function G(t,e){e=e||1/0;let n,r=t.length,o=null,i=[];for(let u=0;u<r;++u){if(n=t.charCodeAt(u),n>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}else if(u+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,n&63|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,n&63|128)}else if(n<1114112){if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw new Error("Invalid code point")}return i}function Rt(t){let e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n)&255);return e}function Tt(t,e){let n,r,o,i=[];for(let u=0;u<t.length&&!((e-=2)<0);++u)n=t.charCodeAt(u),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function it(t){return a.toByteArray(Ut(t))}function Y(t,e,n,r){let o;for(o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function N(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function X(t){return t!==t}var Ot=function(){let t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){let r=n*16;for(let o=0;o<16;++o)e[r+o]=t[n]+t[o]}return e}();function j(t){return typeof BigInt>"u"?St:t}function St(){throw new Error("BigInt not supported")}}),at={};Pt(at,{Buffer:()=>J,INSPECT_MAX_BYTES:()=>Ft,SlowBuffer:()=>kt,default:()=>zt,kMaxLength:()=>Dt});var lt=st(ht());$t(at,st(ht()));var{Buffer:J,SlowBuffer:kt,INSPECT_MAX_BYTES:Ft,kMaxLength:Dt}=lt,{default:ut,...Yt}=lt,zt=ut!==void 0?ut:Yt;globalThis.__Buffer$=J;})();
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
*/
var __global$ = globalThis || (typeof window !== "undefined" ? window : self);
var yc=Object.create;var Qr=Object.defineProperty;var mc=Object.getOwnPropertyDescriptor;var bc=Object.getOwnPropertyNames;var wc=Object.getPrototypeOf,xc=Object.prototype.hasOwnProperty;var re=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Vn=(t,e)=>{for(var n in e)Qr(t,n,{get:e[n],enumerable:!0})},vc=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of bc(e))!xc.call(t,s)&&s!==n&&Qr(t,s,{get:()=>e[s],enumerable:!(r=mc(e,s))||r.enumerable});return t};var Me=(t,e,n)=>(n=t!=null?yc(wc(t)):{},vc(e||!t||!t.__esModule?Qr(n,"default",{value:t,enumerable:!0}):n,t));var mi=re((Ph,yi)=>{var Dt=1e3,Pt=Dt*60,Bt=Pt*60,bt=Bt*24,df=bt*7,hf=bt*365.25;yi.exports=function(t,e){e=e||{};var n=typeof t;if(n==="string"&&t.length>0)return pf(t);if(n==="number"&&isFinite(t))return e.long?_f(t):gf(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function pf(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*hf;case"weeks":case"week":case"w":return n*df;case"days":case"day":case"d":return n*bt;case"hours":case"hour":case"hrs":case"hr":case"h":return n*Bt;case"minutes":case"minute":case"mins":case"min":case"m":return n*Pt;case"seconds":case"second":case"secs":case"sec":case"s":return n*Dt;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function gf(t){var e=Math.abs(t);return e>=bt?Math.round(t/bt)+"d":e>=Bt?Math.round(t/Bt)+"h":e>=Pt?Math.round(t/Pt)+"m":e>=Dt?Math.round(t/Dt)+"s":t+"ms"}function _f(t){var e=Math.abs(t);return e>=bt?dr(t,e,bt,"day"):e>=Bt?dr(t,e,Bt,"hour"):e>=Pt?dr(t,e,Pt,"minute"):e>=Dt?dr(t,e,Dt,"second"):t+" ms"}function dr(t,e,n,r){var s=e>=n*1.5;return Math.round(t/n)+" "+r+(s?"s":"")}});var wi=re((Bh,bi)=>{function yf(t){n.debug=n,n.default=n,n.coerce=c,n.disable=o,n.enable=s,n.enabled=i,n.humanize=mi(),n.destroy=l,Object.keys(t).forEach(h=>{n[h]=t[h]}),n.names=[],n.skips=[],n.formatters={};function e(h){let f=0;for(let d=0;d<h.length;d++)f=(f<<5)-f+h.charCodeAt(d),f|=0;return n.colors[Math.abs(f)%n.colors.length]}n.selectColor=e;function n(h){let f,d=null,g,w;function A(...C){if(!A.enabled)return;let O=A,j=Number(new Date),q=j-(f||j);O.diff=q,O.prev=f,O.curr=j,f=j,C[0]=n.coerce(C[0]),typeof C[0]!="string"&&C.unshift("%O");let T=0;C[0]=C[0].replace(/%([a-zA-Z%])/g,(X,V)=>{if(X==="%%")return"%";T++;let Y=n.formatters[V];if(typeof Y=="function"){let Z=C[T];X=Y.call(O,Z),C.splice(T,1),T--}return X}),n.formatArgs.call(O,C),(O.log||n.log).apply(O,C)}return A.namespace=h,A.useColors=n.useColors(),A.color=n.selectColor(h),A.extend=r,A.destroy=n.destroy,Object.defineProperty(A,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(g!==n.namespaces&&(g=n.namespaces,w=n.enabled(h)),w),set:C=>{d=C}}),typeof n.init=="function"&&n.init(A),A}function r(h,f){let d=n(this.namespace+(typeof f>"u"?":":f)+h);return d.log=this.log,d}function s(h){n.save(h),n.namespaces=h,n.names=[],n.skips=[];let f,d=(typeof h=="string"?h:"").split(/[\s,]+/),g=d.length;for(f=0;f<g;f++)d[f]&&(h=d[f].replace(/\*/g,".*?"),h[0]==="-"?n.skips.push(new RegExp("^"+h.slice(1)+"$")):n.names.push(new RegExp("^"+h+"$")))}function o(){let h=[...n.names.map(a),...n.skips.map(a).map(f=>"-"+f)].join(",");return n.enable(""),h}function i(h){if(h[h.length-1]==="*")return!0;let f,d;for(f=0,d=n.skips.length;f<d;f++)if(n.skips[f].test(h))return!1;for(f=0,d=n.names.length;f<d;f++)if(n.names[f].test(h))return!0;return!1}function a(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}function c(h){return h instanceof Error?h.stack||h.message:h}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}bi.exports=yf});var rt=re((ve,hr)=>{ve.formatArgs=bf;ve.save=wf;ve.load=xf;ve.useColors=mf;ve.storage=vf();ve.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();ve.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function mf(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let t;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function bf(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+hr.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let n=0,r=0;t[0].replace(/%[a-zA-Z%]/g,s=>{s!=="%%"&&(n++,s==="%c"&&(r=n))}),t.splice(r,0,e)}ve.log=console.debug||console.log||(()=>{});function wf(t){try{t?ve.storage.setItem("debug",t):ve.storage.removeItem("debug")}catch{}}function xf(){let t;try{t=ve.storage.getItem("debug")}catch{}return!t&&typeof __Process$<"u"&&"env"in __Process$&&(t=__Process$.env.DEBUG),t}function vf(){try{return localStorage}catch{}}hr.exports=wi()(ve);var{formatters:Sf}=hr.exports;Sf.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var vi=re((Fh,js)=>{"use strict";var Af=Object.prototype.hasOwnProperty,pe="~";function An(){}Object.create&&(An.prototype=Object.create(null),new An().__proto__||(pe=!1));function Ef(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function xi(t,e,n,r,s){if(typeof n!="function")throw new TypeError("The listener must be a function");var o=new Ef(n,r||t,s),i=pe?pe+e:e;return t._events[i]?t._events[i].fn?t._events[i]=[t._events[i],o]:t._events[i].push(o):(t._events[i]=o,t._eventsCount++),t}function pr(t,e){--t._eventsCount===0?t._events=new An:delete t._events[e]}function le(){this._events=new An,this._eventsCount=0}le.prototype.eventNames=function(){var e=[],n,r;if(this._eventsCount===0)return e;for(r in n=this._events)Af.call(n,r)&&e.push(pe?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(n)):e};le.prototype.listeners=function(e){var n=pe?pe+e:e,r=this._events[n];if(!r)return[];if(r.fn)return[r.fn];for(var s=0,o=r.length,i=new Array(o);s<o;s++)i[s]=r[s].fn;return i};le.prototype.listenerCount=function(e){var n=pe?pe+e:e,r=this._events[n];return r?r.fn?1:r.length:0};le.prototype.emit=function(e,n,r,s,o,i){var a=pe?pe+e:e;if(!this._events[a])return!1;var c=this._events[a],l=arguments.length,h,f;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,n),!0;case 3:return c.fn.call(c.context,n,r),!0;case 4:return c.fn.call(c.context,n,r,s),!0;case 5:return c.fn.call(c.context,n,r,s,o),!0;case 6:return c.fn.call(c.context,n,r,s,o,i),!0}for(f=1,h=new Array(l-1);f<l;f++)h[f-1]=arguments[f];c.fn.apply(c.context,h)}else{var d=c.length,g;for(f=0;f<d;f++)switch(c[f].once&&this.removeListener(e,c[f].fn,void 0,!0),l){case 1:c[f].fn.call(c[f].context);break;case 2:c[f].fn.call(c[f].context,n);break;case 3:c[f].fn.call(c[f].context,n,r);break;case 4:c[f].fn.call(c[f].context,n,r,s);break;default:if(!h)for(g=1,h=new Array(l-1);g<l;g++)h[g-1]=arguments[g];c[f].fn.apply(c[f].context,h)}}return!0};le.prototype.on=function(e,n,r){return xi(this,e,n,r,!1)};le.prototype.once=function(e,n,r){return xi(this,e,n,r,!0)};le.prototype.removeListener=function(e,n,r,s){var o=pe?pe+e:e;if(!this._events[o])return this;if(!n)return pr(this,o),this;var i=this._events[o];if(i.fn)i.fn===n&&(!s||i.once)&&(!r||i.context===r)&&pr(this,o);else{for(var a=0,c=[],l=i.length;a<l;a++)(i[a].fn!==n||s&&!i[a].once||r&&i[a].context!==r)&&c.push(i[a]);c.length?this._events[o]=c.length===1?c[0]:c:pr(this,o)}return this};le.prototype.removeAllListeners=function(e){var n;return e?(n=pe?pe+e:e,this._events[n]&&pr(this,n)):(this._events=new An,this._eventsCount=0),this};le.prototype.off=le.prototype.removeListener;le.prototype.addListener=le.prototype.on;le.prefixed=pe;le.EventEmitter=le;typeof js<"u"&&(js.exports=le)});var gr=re(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});function Si(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof __global$<"u")return __global$}function Ai(){let t=Si();if(t.__xstate__)return t.__xstate__}function kf(t){if(typeof window>"u")return;let e=Ai();e&&e.register(t)}var If=t=>{if(typeof window>"u")return;let e=Ai();e&&e.register(t)};En.devToolsAdapter=If;En.getGlobal=Si;En.registerService=kf});var vr=re(F=>{"use strict";var Cf=gr(),_r=class{constructor(e){this._process=e,this._active=!1,this._current=null,this._last=null}start(){this._active=!0,this.flush()}clear(){this._current&&(this._current.next=null,this._last=this._current)}enqueue(e){let n={value:e,next:null};if(this._current){this._last.next=n,this._last=n;return}this._current=n,this._last=n,this._active&&this.flush()}flush(){for(;this._current;){let e=this._current;this._process(e.value),this._current=e.next}this._last=null}},Ri=".",Tf="",Mi="",Of="#",Rf="*",Ui="xstate.init",Mf="xstate.error",yr="xstate.stop";function Uf(t,e){return{type:`xstate.after.${t}.${e}`}}function Ps(t,e){return{type:`xstate.done.state.${t}`,output:e}}function jf(t,e){return{type:`xstate.done.actor.${t}`,output:e,actorId:t}}function ji(t,e){return{type:`xstate.error.actor.${t}`,error:e,actorId:t}}function Di(t){return{type:Ui,input:t}}function We(t){setTimeout(()=>{throw t})}var Df=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Ls(t,e){let n=Ei(t),r=Ei(e);return typeof r=="string"?typeof n=="string"?r===n:!1:typeof n=="string"?n in r:Object.keys(n).every(s=>s in r?Ls(n[s],r[s]):!1)}function zs(t){if(Fi(t))return t;let e=[],n="";for(let r=0;r<t.length;r++){switch(t.charCodeAt(r)){case 92:n+=t[r+1],r++;continue;case 46:e.push(n),n="";continue}n+=t[r]}return e.push(n),e}function Ei(t){if(Zi(t))return t.value;if(typeof t!="string")return t;let e=zs(t);return Pi(e)}function Pi(t){if(t.length===1)return t[0];let e={},n=e;for(let r=0;r<t.length-1;r++)if(r===t.length-2)n[t[r]]=t[r+1];else{let s=n;n={},s[t[r]]=n}return e}function Pf(t,e){let n={},r=Object.keys(t);for(let s=0;s<r.length;s++){let o=r[s];n[o]=e(t[o],o,t,s)}return n}function Bi(t){return Fi(t)?t:[t]}function kn(t){return t===void 0?[]:Bi(t)}function Bs(t,e,n,r){return typeof t=="function"?t({context:e,event:n,self:r}):t}function Fi(t){return Array.isArray(t)}function Bf(t){return t.type.startsWith("xstate.error.actor")}function Ft(t){return Bi(t).map(e=>typeof e>"u"||typeof e=="string"?{target:e}:e)}function $i(t){if(!(t===void 0||t===Tf))return kn(t)}function mr(t,e,n){let r=typeof t=="object",s=r?t:void 0;return{next:(r?t.next:t)?.bind(s),error:(r?t.error:e)?.bind(s),complete:(r?t.complete:n)?.bind(s)}}function Ff(t,e){return`${e}.${t}`}function Li(t,e){let n=e.match(/^xstate\.invoke\.(\d+)\.(.*)/);if(!n)return t.implementations.actors[e];let[,r,s]=n,i=t.getStateNodeById(s).config.invoke;return(Array.isArray(i)?i[r]:i).src}function $f(t){return[...new Set([...t._nodes.flatMap(e=>e.ownEvents)])]}function ki(t,e){return`${t.sessionId}.${e}`}var Lf=0;function zf(t,e){let n=new Map,r=new Map,s=new WeakMap,o=new Set,i={},{clock:a,logger:c}=e,l={schedule:(d,g,w,A,C=Math.random().toString(36).slice(2))=>{let O={source:d,target:g,event:w,delay:A,id:C,startedAt:Date.now()},j=ki(d,C);f._snapshot._scheduledEvents[j]=O;let q=a.setTimeout(()=>{delete i[j],delete f._snapshot._scheduledEvents[j],f._relay(d,g,w)},A);i[j]=q},cancel:(d,g)=>{let w=ki(d,g),A=i[w];delete i[w],delete f._snapshot._scheduledEvents[w],A!==void 0&&a.clearTimeout(A)},cancelAll:d=>{for(let g in f._snapshot._scheduledEvents){let w=f._snapshot._scheduledEvents[g];w.source===d&&l.cancel(d,w.id)}}},h=d=>{if(!o.size)return;let g={...d,rootId:t.sessionId};o.forEach(w=>w.next?.(g))},f={_snapshot:{_scheduledEvents:(e?.snapshot&&e.snapshot.scheduler)??{}},_bookId:()=>`x:${Lf++}`,_register:(d,g)=>(n.set(d,g),d),_unregister:d=>{n.delete(d.sessionId);let g=s.get(d);g!==void 0&&(r.delete(g),s.delete(d))},get:d=>r.get(d),_set:(d,g)=>{let w=r.get(d);if(w&&w!==g)throw new Error(`Actor with system ID '${d}' already exists.`);r.set(d,g),s.set(g,d)},inspect:d=>{let g=mr(d);return o.add(g),{unsubscribe(){o.delete(g)}}},_sendInspectionEvent:h,_relay:(d,g,w)=>{f._sendInspectionEvent({type:"@xstate.event",sourceRef:d,actorRef:g,event:w}),g._send(w)},scheduler:l,getSnapshot:()=>({_scheduledEvents:{...f._snapshot._scheduledEvents}}),start:()=>{let d=f._snapshot._scheduledEvents;f._snapshot._scheduledEvents={};for(let g in d){let{source:w,target:A,event:C,delay:O,id:j}=d[g];l.schedule(w,A,C,O,j)}},_clock:a,_logger:c};return f}var Hs=1,ge=function(t){return t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped",t}({}),Hf={clock:{setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t)},logger:console.log.bind(console),devTools:!1},br=class{constructor(e,n){this.logic=e,this._snapshot=void 0,this.clock=void 0,this.options=void 0,this.id=void 0,this.mailbox=new _r(this._process.bind(this)),this.observers=new Set,this.eventListeners=new Map,this.logger=void 0,this._processingStatus=ge.NotStarted,this._parent=void 0,this._syncSnapshot=void 0,this.ref=void 0,this._actorScope=void 0,this._systemId=void 0,this.sessionId=void 0,this.system=void 0,this._doneEvent=void 0,this.src=void 0,this._deferred=[];let r={...Hf,...n},{clock:s,logger:o,parent:i,syncSnapshot:a,id:c,systemId:l,inspect:h}=r;this.system=i?i.system:zf(this,{clock:s,logger:o}),h&&!i&&this.system.inspect(mr(h)),this.sessionId=this.system._bookId(),this.id=c??this.sessionId,this.logger=n?.logger??this.system._logger,this.clock=n?.clock??this.system._clock,this._parent=i,this._syncSnapshot=a,this.options=r,this.src=r.src??e,this.ref=this,this._actorScope={self:this,id:this.id,sessionId:this.sessionId,logger:this.logger,defer:f=>{this._deferred.push(f)},system:this.system,stopChild:f=>{if(f._parent!==this)throw new Error(`Cannot stop child actor ${f.id} of ${this.id} because it is not a child`);f._stop()},emit:f=>{let d=this.eventListeners.get(f.type),g=this.eventListeners.get("*");if(!d&&!g)return;let w=new Set([...d?d.values():[],...g?g.values():[]]);for(let A of Array.from(w))A(f)}},this.send=this.send.bind(this),this.system._sendInspectionEvent({type:"@xstate.actor",actorRef:this}),l&&(this._systemId=l,this.system._set(l,this)),this._initState(n?.snapshot??n?.state),l&&this._snapshot.status!=="active"&&this.system._unregister(this)}_initState(e){try{this._snapshot=e?this.logic.restoreSnapshot?this.logic.restoreSnapshot(e,this._actorScope):e:this.logic.getInitialSnapshot(this._actorScope,this.options?.input)}catch(n){this._snapshot={status:"error",output:void 0,error:n}}}update(e,n){this._snapshot=e;let r;for(;r=this._deferred.shift();)try{r()}catch(s){this._deferred.length=0,this._snapshot={...e,status:"error",error:s}}switch(this._snapshot.status){case"active":for(let s of this.observers)try{s.next?.(e)}catch(o){We(o)}break;case"done":for(let s of this.observers)try{s.next?.(e)}catch(o){We(o)}this._stopProcedure(),this._complete(),this._doneEvent=jf(this.id,this._snapshot.output),this._parent&&this.system._relay(this,this._parent,this._doneEvent);break;case"error":this._error(this._snapshot.error);break}this.system._sendInspectionEvent({type:"@xstate.snapshot",actorRef:this,event:n,snapshot:e})}subscribe(e,n,r){let s=mr(e,n,r);if(this._processingStatus!==ge.Stopped)this.observers.add(s);else switch(this._snapshot.status){case"done":try{s.complete?.()}catch(o){We(o)}break;case"error":{let o=this._snapshot.error;if(!s.error)We(o);else try{s.error(o)}catch(i){We(i)}break}}return{unsubscribe:()=>{this.observers.delete(s)}}}on(e,n){let r=this.eventListeners.get(e);r||(r=new Set,this.eventListeners.set(e,r));let s=n.bind(void 0);return r.add(s),{unsubscribe:()=>{r.delete(s)}}}start(){if(this._processingStatus===ge.Running)return this;this._syncSnapshot&&this.subscribe({next:r=>{r.status==="active"&&this.system._relay(this,this._parent,{type:`xstate.snapshot.${this.id}`,snapshot:r})},error:()=>{}}),this.system._register(this.sessionId,this),this._systemId&&this.system._set(this._systemId,this),this._processingStatus=ge.Running;let e=Di(this.options.input);switch(this.system._sendInspectionEvent({type:"@xstate.event",sourceRef:this._parent,actorRef:this,event:e}),this._snapshot.status){case"done":return this.update(this._snapshot,e),this;case"error":return this._error(this._snapshot.error),this}if(this._parent||this.system.start(),this.logic.start)try{this.logic.start(this._snapshot,this._actorScope)}catch(r){return this._snapshot={...this._snapshot,status:"error",error:r},this._error(r),this}return this.update(this._snapshot,e),this.options.devTools&&this.attachDevTools(),this.mailbox.start(),this}_process(e){let n,r;try{n=this.logic.transition(this._snapshot,e,this._actorScope)}catch(s){r={err:s}}if(r){let{err:s}=r;this._snapshot={...this._snapshot,status:"error",error:s},this._error(s);return}this.update(n,e),e.type===yr&&(this._stopProcedure(),this._complete())}_stop(){return this._processingStatus===ge.Stopped?this:(this.mailbox.clear(),this._processingStatus===ge.NotStarted?(this._processingStatus=ge.Stopped,this):(this.mailbox.enqueue({type:yr}),this))}stop(){if(this._parent)throw new Error("A non-root actor cannot be stopped directly.");return this._stop()}_complete(){for(let e of this.observers)try{e.complete?.()}catch(n){We(n)}this.observers.clear()}_reportError(e){if(!this.observers.size){this._parent||We(e);return}let n=!1;for(let r of this.observers){let s=r.error;n||=!s;try{s?.(e)}catch(o){We(o)}}this.observers.clear(),n&&We(e)}_error(e){this._stopProcedure(),this._reportError(e),this._parent&&this.system._relay(this,this._parent,ji(this.id,e))}_stopProcedure(){return this._processingStatus!==ge.Running?this:(this.system.scheduler.cancelAll(this),this.mailbox.clear(),this.mailbox=new _r(this._process.bind(this)),this._processingStatus=ge.Stopped,this.system._unregister(this),this)}_send(e){this._processingStatus!==ge.Stopped&&this.mailbox.enqueue(e)}send(e){this.system._relay(void 0,this,e)}attachDevTools(){let{devTools:e}=this.options;e&&(typeof e=="function"?e:Cf.devToolsAdapter)(this)}toJSON(){return{xstate$$type:Hs,id:this.id}}getPersistedSnapshot(e){return this.logic.getPersistedSnapshot(this._snapshot,e)}[Df](){return this}getSnapshot(){return this._snapshot}};function Ns(t,...[e]){return new br(t,e)}var Nf=Ns;function Vf(t,e,n,r,{sendId:s}){let o=typeof s=="function"?s(n,r):s;return[e,o]}function Wf(t,e){t.defer(()=>{t.system.scheduler.cancel(t.self,e)})}function zi(t){function e(n,r){}return e.type="xstate.cancel",e.sendId=t,e.resolve=Vf,e.execute=Wf,e}function qf(t,e,n,r,{id:s,systemId:o,src:i,input:a,syncSnapshot:c}){let l=typeof i=="string"?Li(e.machine,i):i,h=typeof s=="function"?s(n):s,f;return l&&(f=Ns(l,{id:h,src:i,parent:t.self,syncSnapshot:c,systemId:o,input:typeof a=="function"?a({context:e.context,event:n.event,self:t.self}):a})),[vt(e,{children:{...e.children,[h]:f}}),{id:s,actorRef:f}]}function Jf(t,{id:e,actorRef:n}){n&&t.defer(()=>{n._processingStatus!==ge.Stopped&&n.start()})}function Hi(...[t,{id:e,systemId:n,input:r,syncSnapshot:s=!1}={}]){function o(i,a){}return o.type="snapshot.spawnChild",o.id=e,o.systemId=n,o.src=t,o.input=r,o.syncSnapshot=s,o.resolve=qf,o.execute=Jf,o}function Kf(t,e,n,r,{actorRef:s}){let o=typeof s=="function"?s(n,r):s,i=typeof o=="string"?e.children[o]:o,a=e.children;return i&&(a={...a},delete a[i.id]),[vt(e,{children:a}),i]}function Gf(t,e){if(e){if(t.system._unregister(e),e._processingStatus!==ge.Running){t.stopChild(e);return}t.defer(()=>{t.stopChild(e)})}}function xr(t){function e(n,r){}return e.type="xstate.stopChild",e.actorRef=t,e.resolve=Kf,e.execute=Gf,e}var Xf=xr;function Yf(t,e,{stateValue:n}){if(typeof n=="string"&&Cn(n)){let r=t.machine.getStateNodeById(n);return t._nodes.some(s=>s===r)}return t.matches(n)}function Zf(t){function e(n,r){return!1}return e.check=Yf,e.stateValue=t,e}function Qf(t,{context:e,event:n},{guards:r}){return!Nt(r[0],e,n,t)}function eu(t){function e(n,r){return!1}return e.check=Qf,e.guards=[t],e}function tu(t,{context:e,event:n},{guards:r}){return r.every(s=>Nt(s,e,n,t))}function nu(t){function e(n,r){return!1}return e.check=tu,e.guards=t,e}function ru(t,{context:e,event:n},{guards:r}){return r.some(s=>Nt(s,e,n,t))}function su(t){function e(n,r){return!1}return e.check=ru,e.guards=t,e}function Nt(t,e,n,r){let{machine:s}=r,o=typeof t=="function",i=o?t:s.implementations.guards[typeof t=="string"?t:t.type];if(!o&&!i)throw new Error(`Guard '${typeof t=="string"?t:t.type}' is not implemented.'.`);if(typeof i!="function")return Nt(i,e,n,r);let a={context:e,event:n},c=o||typeof t=="string"?void 0:"params"in t?typeof t.params=="function"?t.params({context:e,event:n}):t.params:void 0;return"check"in i?i.check(r,a,i):i(a,c)}var Vs=t=>t.type==="atomic"||t.type==="final";function Lt(t){return Object.values(t.states).filter(e=>e.type!=="history")}function In(t,e){let n=[];if(e===t)return n;let r=t.parent;for(;r&&r!==e;)n.push(r),r=r.parent;return n}function Ws(t){let e=new Set(t),n=Vi(e);for(let r of e)if(r.type==="compound"&&(!n.get(r)||!n.get(r).length))Ii(r).forEach(s=>e.add(s));else if(r.type==="parallel"){for(let s of Lt(r))if(s.type!=="history"&&!e.has(s)){let o=Ii(s);for(let i of o)e.add(i)}}for(let r of e){let s=r.parent;for(;s;)e.add(s),s=s.parent}return e}function Ni(t,e){let n=e.get(t);if(!n)return{};if(t.type==="compound"){let s=n[0];if(s){if(Vs(s))return s.key}else return{}}let r={};for(let s of n)r[s.key]=Ni(s,e);return r}function Vi(t){let e=new Map;for(let n of t)e.has(n)||e.set(n,[]),n.parent&&(e.has(n.parent)||e.set(n.parent,[]),e.get(n.parent).push(n));return e}function Wi(t,e){let n=Ws(e);return Ni(t,Vi(n))}function qs(t,e){return e.type==="compound"?Lt(e).some(n=>n.type==="final"&&t.has(n)):e.type==="parallel"?Lt(e).every(n=>qs(t,n)):e.type==="final"}var Cn=t=>t[0]===Of;function ou(t,e){return t.transitions.get(e)||[...t.transitions.keys()].filter(r=>{if(r===Rf)return!0;if(!r.endsWith(".*"))return!1;let s=r.split("."),o=e.split(".");for(let i=0;i<s.length;i++){let a=s[i],c=o[i];if(a==="*")return i===s.length-1;if(a!==c)return!1}return!0}).sort((r,s)=>s.length-r.length).flatMap(r=>t.transitions.get(r))}function iu(t){let e=t.config.after;if(!e)return[];let n=(s,o)=>{let i=Uf(s,t.id),a=i.type;return t.entry.push(ta(i,{id:a,delay:s})),t.exit.push(zi(a)),a};return Object.keys(e).flatMap((s,o)=>{let i=e[s],a=typeof i=="string"?{target:i}:i,c=Number.isNaN(+s)?s:+s,l=n(c);return kn(a).map(h=>({...h,event:l,delay:c}))}).map(s=>{let{delay:o}=s;return{...wt(t,s.event,s),delay:o}})}function wt(t,e,n){let r=$i(n.target),s=n.reenter??!1,o=fu(t,r),i={...n,actions:kn(n.actions),guard:n.guard,target:o,source:t,reenter:s,eventType:e,toJSON:()=>({...i,source:`#${t.id}`,target:o?o.map(a=>`#${a.id}`):void 0})};return i}function au(t){let e=new Map;if(t.config.on)for(let n of Object.keys(t.config.on)){if(n===Mi)throw new Error('Null events ("") cannot be specified as a transition key. Use `always: { ... }` instead.');let r=t.config.on[n];e.set(n,Ft(r).map(s=>wt(t,n,s)))}if(t.config.onDone){let n=`xstate.done.state.${t.id}`;e.set(n,Ft(t.config.onDone).map(r=>wt(t,n,r)))}for(let n of t.invoke){if(n.onDone){let r=`xstate.done.actor.${n.id}`;e.set(r,Ft(n.onDone).map(s=>wt(t,r,s)))}if(n.onError){let r=`xstate.error.actor.${n.id}`;e.set(r,Ft(n.onError).map(s=>wt(t,r,s)))}if(n.onSnapshot){let r=`xstate.snapshot.${n.id}`;e.set(r,Ft(n.onSnapshot).map(s=>wt(t,r,s)))}}for(let n of t.after){let r=e.get(n.eventType);r||(r=[],e.set(n.eventType,r)),r.push(n)}return e}function cu(t,e){let n=typeof e=="string"?t.states[e]:e?t.states[e.target]:void 0;if(!n&&e)throw new Error(`Initial state node "${e}" not found on parent state node #${t.id}`);let r={source:t,actions:!e||typeof e=="string"?[]:kn(e.actions),eventType:null,reenter:!1,target:n?[n]:[],toJSON:()=>({...r,source:`#${t.id}`,target:n?[`#${n.id}`]:[]})};return r}function fu(t,e){if(e!==void 0)return e.map(n=>{if(typeof n!="string")return n;if(Cn(n))return t.machine.getStateNodeById(n);let r=n[0]===Ri;if(r&&!t.parent)return wr(t,n.slice(1));let s=r?t.key+n:n;if(t.parent)try{return wr(t.parent,s)}catch(o){throw new Error(`Invalid transition definition for state node '${t.id}':
${o.message}`)}else throw new Error(`Invalid target: "${n}" is not a valid target from the root node. Did you mean ".${n}"?`)})}function qi(t){let e=$i(t.config.target);return e?{target:e.map(n=>typeof n=="string"?wr(t.parent,n):n)}:t.parent.initial}function xt(t){return t.type==="history"}function Ii(t){let e=Ji(t);for(let n of e)for(let r of In(n,t))e.add(r);return e}function Ji(t){let e=new Set;function n(r){if(!e.has(r)){if(e.add(r),r.type==="compound")n(r.initial.target[0]);else if(r.type==="parallel")for(let s of Lt(r))n(s)}}return n(t),e}function zt(t,e){if(Cn(e))return t.machine.getStateNodeById(e);if(!t.states)throw new Error(`Unable to retrieve child state '${e}' from '${t.id}'; no child states exist.`);let n=t.states[e];if(!n)throw new Error(`Child state '${e}' does not exist on '${t.id}'`);return n}function wr(t,e){if(typeof e=="string"&&Cn(e))try{return t.machine.getStateNodeById(e)}catch{}let n=zs(e).slice(),r=t;for(;n.length;){let s=n.shift();if(!s.length)break;r=zt(r,s)}return r}function Js(t,e){if(typeof e=="string"){let s=t.states[e];if(!s)throw new Error(`State '${e}' does not exist on '${t.id}'`);return[t,s]}let n=Object.keys(e),r=n.map(s=>zt(t,s)).filter(Boolean);return[t.machine.root,t].concat(r,n.reduce((s,o)=>{let i=zt(t,o);if(!i)return s;let a=Js(i,e[o]);return s.concat(a)},[]))}function uu(t,e,n,r){let o=zt(t,e).next(n,r);return!o||!o.length?t.next(n,r):o}function lu(t,e,n,r){let s=Object.keys(e),o=zt(t,s[0]),i=Ks(o,e[s[0]],n,r);return!i||!i.length?t.next(n,r):i}function du(t,e,n,r){let s=[];for(let o of Object.keys(e)){let i=e[o];if(!i)continue;let a=zt(t,o),c=Ks(a,i,n,r);c&&s.push(...c)}return s.length?s:t.next(n,r)}function Ks(t,e,n,r){return typeof e=="string"?uu(t,e,n,r):Object.keys(e).length===1?lu(t,e,n,r):du(t,e,n,r)}function hu(t){return Object.keys(t.states).map(e=>t.states[e]).filter(e=>e.type==="history")}function st(t,e){let n=t;for(;n.parent&&n.parent!==e;)n=n.parent;return n.parent===e}function pu(t,e){let n=new Set(t),r=new Set(e);for(let s of n)if(r.has(s))return!0;for(let s of r)if(n.has(s))return!0;return!1}function Ki(t,e,n){let r=new Set;for(let s of t){let o=!1,i=new Set;for(let a of r)if(pu(Fs([s],e,n),Fs([a],e,n)))if(st(s.source,a.source))i.add(a);else{o=!0;break}if(!o){for(let a of i)r.delete(a);r.add(s)}}return Array.from(r)}function gu(t){let[e,...n]=t;for(let r of In(e,void 0))if(n.every(s=>st(s,r)))return r}function Gs(t,e){if(!t.target)return[];let n=new Set;for(let r of t.target)if(xt(r))if(e[r.id])for(let s of e[r.id])n.add(s);else for(let s of Gs(qi(r),e))n.add(s);else n.add(r);return[...n]}function Gi(t,e){let n=Gs(t,e);if(!n)return;if(!t.reenter&&n.every(s=>s===t.source||st(s,t.source)))return t.source;let r=gu(n.concat(t.source));if(r)return r;if(!t.reenter)return t.source.machine.root}function Fs(t,e,n){let r=new Set;for(let s of t)if(s.target?.length){let o=Gi(s,n);s.reenter&&s.source===o&&r.add(o);for(let i of e)st(i,o)&&r.add(i)}return[...r]}function _u(t,e){if(t.length!==e.size)return!1;for(let n of t)if(!e.has(n))return!1;return!0}function $s(t,e,n,r,s,o){if(!t.length)return e;let i=new Set(e._nodes),a=e.historyValue,c=Ki(t,i,a),l=e;s||([l,a]=wu(l,r,n,c,i,a,o)),l=Ht(l,r,n,c.flatMap(f=>f.actions),o),l=mu(l,r,n,c,i,o,a,s);let h=[...i];l.status==="done"&&(l=Ht(l,r,n,h.sort((f,d)=>d.order-f.order).flatMap(f=>f.exit),o));try{return a===e.historyValue&&_u(e._nodes,i)?l:vt(l,{_nodes:h,historyValue:a})}catch(f){throw f}}function yu(t,e,n,r,s){if(r.output===void 0)return;let o=Ps(s.id,s.output!==void 0&&s.parent?Bs(s.output,t.context,e,n.self):void 0);return Bs(r.output,t.context,o,n.self)}function mu(t,e,n,r,s,o,i,a){let c=t,l=new Set,h=new Set;bu(r,i,h,l),a&&h.add(t.machine.root);let f=new Set;for(let d of[...l].sort((g,w)=>g.order-w.order)){s.add(d);let g=[];g.push(...d.entry);for(let w of d.invoke)g.push(Hi(w.src,{...w,syncSnapshot:!!w.onSnapshot}));if(h.has(d)){let w=d.initial.actions;g.push(...w)}if(c=Ht(c,e,n,g,o,d.invoke.map(w=>w.id)),d.type==="final"){let w=d.parent,A=w?.type==="parallel"?w:w?.parent,C=A||d;for(w?.type==="compound"&&o.push(Ps(w.id,d.output!==void 0?Bs(d.output,c.context,e,n.self):void 0));A?.type==="parallel"&&!f.has(A)&&qs(s,A);)f.add(A),o.push(Ps(A.id)),C=A,A=A.parent;if(A)continue;c=vt(c,{status:"done",output:yu(c,e,n,c.machine.root,C)})}}return c}function bu(t,e,n,r){for(let s of t){let o=Gi(s,e);for(let a of s.target||[])!xt(a)&&(s.source!==a||s.source!==o||s.reenter)&&(r.add(a),n.add(a)),$t(a,e,n,r);let i=Gs(s,e);for(let a of i){let c=In(a,o);o?.type==="parallel"&&c.push(o),Xi(r,e,n,c,!s.source.parent&&s.reenter?void 0:o)}}}function $t(t,e,n,r){if(xt(t))if(e[t.id]){let s=e[t.id];for(let o of s)r.add(o),$t(o,e,n,r);for(let o of s)Ds(o,t.parent,r,e,n)}else{let s=qi(t);for(let o of s.target)r.add(o),s===t.parent?.initial&&n.add(t.parent),$t(o,e,n,r);for(let o of s.target)Ds(o,t.parent,r,e,n)}else if(t.type==="compound"){let[s]=t.initial.target;xt(s)||(r.add(s),n.add(s)),$t(s,e,n,r),Ds(s,t,r,e,n)}else if(t.type==="parallel")for(let s of Lt(t).filter(o=>!xt(o)))[...r].some(o=>st(o,s))||(xt(s)||(r.add(s),n.add(s)),$t(s,e,n,r))}function Xi(t,e,n,r,s){for(let o of r)if((!s||st(o,s))&&t.add(o),o.type==="parallel")for(let i of Lt(o).filter(a=>!xt(a)))[...t].some(a=>st(a,i))||(t.add(i),$t(i,e,n,t))}function Ds(t,e,n,r,s){Xi(n,r,s,In(t,e))}function wu(t,e,n,r,s,o,i){let a=t,c=Fs(r,s,o);c.sort((h,f)=>f.order-h.order);let l;for(let h of c)for(let f of hu(h)){let d;f.history==="deep"?d=g=>Vs(g)&&st(g,h):d=g=>g.parent===h,l??={...o},l[f.id]=Array.from(s).filter(d)}for(let h of c)a=Ht(a,e,n,[...h.exit,...h.invoke.map(f=>xr(f.id))],i),s.delete(h);return[a,l||o]}var Ci=!1;function Yi(t,e,n,r,s,o){let{machine:i}=t,a=t;for(let c of r){let g=function(){n.system._sendInspectionEvent({type:"@xstate.action",actorRef:n.self,action:{type:typeof c=="string"?c:typeof c=="object"?c.type:c.name||"(anonymous)",params:d}});try{Ci=h,h(f,d)}finally{Ci=!1}},l=typeof c=="function",h=l?c:i.implementations.actions[typeof c=="string"?c:c.type];if(!h)continue;let f={context:a.context,event:e,self:n.self,system:n.system},d=l||typeof c=="string"?void 0:"params"in c?typeof c.params=="function"?c.params({context:a.context,event:e}):c.params:void 0;if(!("resolve"in h)){n.self._processingStatus===ge.Running?g():n.defer(()=>{g()});continue}let w=h,[A,C,O]=w.resolve(n,a,f,d,h,s);a=A,"retryResolve"in w&&o?.push([w,C]),"execute"in w&&(n.self._processingStatus===ge.Running?w.execute(n,C):n.defer(w.execute.bind(null,n,C))),O&&(a=Yi(a,e,n,O,s,o))}return a}function Ht(t,e,n,r,s,o){let i=o?[]:void 0,a=Yi(t,e,n,r,{internalQueue:s,deferredActorIds:o},i);return i?.forEach(([c,l])=>{c.retryResolve(n,a,l)}),a}function xu(t,e,n,r=[]){let s=t,o=[];function i(l,h,f){n.system._sendInspectionEvent({type:"@xstate.microstep",actorRef:n.self,event:h,snapshot:l,_transitions:f}),o.push(l)}if(e.type===yr)return s=vt(Ti(s,e,n),{status:"stopped"}),i(s,e,[]),{snapshot:s,microstates:o};let a=e;if(a.type!==Ui){let l=a,h=Bf(l),f=Oi(l,s);if(h&&!f.length)return s=vt(t,{status:"error",error:l.error}),i(s,l,[]),{snapshot:s,microstates:o};s=$s(f,t,n,a,!1,r),i(s,l,f)}let c=!0;for(;s.status==="active";){let l=c?vu(s,a):[],h=l.length?s:void 0;if(!l.length){if(!r.length)break;a=r.shift(),l=Oi(a,s)}s=$s(l,s,n,a,!1,r),c=s!==h,i(s,a,l)}return s.status!=="active"&&Ti(s,a,n),{snapshot:s,microstates:o}}function Ti(t,e,n){return Ht(t,e,n,Object.values(t.children).map(r=>xr(r)),[])}function Oi(t,e){return e.machine.getTransitionData(e,t)}function vu(t,e){let n=new Set,r=t._nodes.filter(Vs);for(let s of r)e:for(let o of[s].concat(In(s,void 0)))if(o.always){for(let i of o.always)if(i.guard===void 0||Nt(i.guard,t.context,e,t)){n.add(i);break e}}return Ki(Array.from(n),new Set(t._nodes),t.historyValue)}function Su(t,e){let n=Ws(Js(t,e));return Wi(t,[...n])}function Zi(t){return!!t&&typeof t=="object"&&"machine"in t&&"value"in t}var Au=function(e){return Ls(e,this.value)},Eu=function(e){return this.tags.has(e)},ku=function(e){let n=this.machine.getTransitionData(this,e);return!!n?.length&&n.some(r=>r.target!==void 0||r.actions.length)},Iu=function(){let{_nodes:e,tags:n,machine:r,getMeta:s,toJSON:o,can:i,hasTag:a,matches:c,...l}=this;return{...l,tags:Array.from(n)}},Cu=function(){return this._nodes.reduce((e,n)=>(n.meta!==void 0&&(e[n.id]=n.meta),e),{})};function Qi(t,e){return{status:t.status,output:t.output,error:t.error,machine:e,context:t.context,_nodes:t._nodes,value:Wi(e.root,t._nodes),tags:new Set(t._nodes.flatMap(n=>n.tags)),children:t.children,historyValue:t.historyValue||{},matches:Au,hasTag:Eu,can:ku,getMeta:Cu,toJSON:Iu}}function vt(t,e={}){return Qi({...t,...e},t.machine)}function Tu(t,e){let{_nodes:n,tags:r,machine:s,children:o,context:i,can:a,hasTag:c,matches:l,getMeta:h,toJSON:f,...d}=t,g={};for(let A in o){let C=o[A];g[A]={snapshot:C.getPersistedSnapshot(e),src:C.src,systemId:C._systemId,syncSnapshot:C._syncSnapshot}}return{...d,context:ea(i),children:g}}function ea(t){let e;for(let n in t){let r=t[n];if(r&&typeof r=="object")if("sessionId"in r&&"send"in r&&"ref"in r)e??=Array.isArray(t)?t.slice():{...t},e[n]={xstate$$type:Hs,id:r.id};else{let s=ea(r);s!==r&&(e??=Array.isArray(t)?t.slice():{...t},e[n]=s)}}return e??t}function Ou(t,e,n,r,{event:s,id:o,delay:i},{internalQueue:a}){let c=e.machine.implementations.delays;if(typeof s=="string")throw new Error(`Only event objects may be used with raise; use raise({ type: "${s}" }) instead`);let l=typeof s=="function"?s(n,r):s,h;if(typeof i=="string"){let f=c&&c[i];h=typeof f=="function"?f(n,r):f}else h=typeof i=="function"?i(n,r):i;return typeof h!="number"&&a.push(l),[e,{event:l,id:o,delay:h}]}function Ru(t,e){let{event:n,delay:r,id:s}=e;if(typeof r=="number"){t.defer(()=>{let o=t.self;t.system.scheduler.schedule(o,o,n,r,s)});return}}function ta(t,e){function n(r,s){}return n.type="xstate.raise",n.event=t,n.id=e?.id,n.delay=e?.delay,n.resolve=Ou,n.execute=Ru,n}F.$$ACTOR_TYPE=Hs;F.Actor=br;F.NULL_EVENT=Mi;F.ProcessingStatus=ge;F.STATE_DELIMITER=Ri;F.XSTATE_ERROR=Mf;F.XSTATE_STOP=yr;F.and=nu;F.cancel=zi;F.cloneMachineSnapshot=vt;F.createActor=Ns;F.createErrorActorEvent=ji;F.createInitEvent=Di;F.createInvokeId=Ff;F.createMachineSnapshot=Qi;F.evaluateGuard=Nt;F.formatInitialTransition=cu;F.formatTransition=wt;F.formatTransitions=au;F.getAllOwnEventDescriptors=$f;F.getAllStateNodes=Ws;F.getCandidates=ou;F.getDelayedTransitions=iu;F.getInitialStateNodes=Ji;F.getPersistedSnapshot=Tu;F.getStateNodeByPath=wr;F.getStateNodes=Js;F.interpret=Nf;F.isInFinalState=qs;F.isMachineSnapshot=Zi;F.isStateId=Cn;F.macrostep=xu;F.mapValues=Pf;F.matchesState=Ls;F.microstep=$s;F.not=eu;F.or=su;F.pathToStateValue=Pi;F.raise=ta;F.resolveActionsAndContext=Ht;F.resolveReferencedActor=Li;F.resolveStateValue=Su;F.spawnChild=Hi;F.stateIn=Zf;F.stop=Xf;F.stopChild=xr;F.toArray=kn;F.toObserver=mr;F.toStatePath=zs;F.toTransitionConfigArray=Ft;F.transitionNode=Ks});var aa=re(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var Tn=vr();gr();function ia(t,e){return{config:t,transition:(n,r,s)=>({...n,context:t(n.context,r,s)}),getInitialSnapshot:(n,r)=>({status:"active",output:void 0,error:void 0,context:typeof e=="function"?e({input:r}):e}),getPersistedSnapshot:n=>n,restoreSnapshot:n=>n}}var na=new WeakMap;function Mu(t){return{config:t,start:(n,r)=>{let{self:s,system:o,emit:i}=r,a={receivers:void 0,dispose:void 0};na.set(s,a),a.dispose=t({input:n.input,system:o,self:s,sendBack:c=>{s.getSnapshot().status!=="stopped"&&s._parent&&o._relay(s,s._parent,c)},receive:c=>{a.receivers??=new Set,a.receivers.add(c)},emit:i})},transition:(n,r,s)=>{let o=na.get(s.self);return r.type===Tn.XSTATE_STOP?(n={...n,status:"stopped",error:void 0},o.dispose?.(),n):(o.receivers?.forEach(i=>i(r)),n)},getInitialSnapshot:(n,r)=>({status:"active",output:void 0,error:void 0,input:r}),getPersistedSnapshot:n=>n,restoreSnapshot:n=>n}}var ra="xstate.observable.next",Ar="xstate.observable.error",Er="xstate.observable.complete";function Uu(t){return{config:t,transition:(n,r)=>{if(n.status!=="active")return n;switch(r.type){case ra:return{...n,context:r.data};case Ar:return{...n,status:"error",error:r.data,input:void 0,_subscription:void 0};case Er:return{...n,status:"done",input:void 0,_subscription:void 0};case Tn.XSTATE_STOP:return n._subscription.unsubscribe(),{...n,status:"stopped",input:void 0,_subscription:void 0};default:return n}},getInitialSnapshot:(n,r)=>({status:"active",output:void 0,error:void 0,context:void 0,input:r,_subscription:void 0}),start:(n,{self:r,system:s,emit:o})=>{n.status!=="done"&&(n._subscription=t({input:n.input,system:s,self:r,emit:o}).subscribe({next:i=>{s._relay(r,r,{type:ra,data:i})},error:i=>{s._relay(r,r,{type:Ar,data:i})},complete:()=>{s._relay(r,r,{type:Er})}}))},getPersistedSnapshot:({_subscription:n,...r})=>r,restoreSnapshot:n=>({...n,_subscription:void 0})}}function ju(t){return{config:t,transition:(n,r)=>{if(n.status!=="active")return n;switch(r.type){case Ar:return{...n,status:"error",error:r.data,input:void 0,_subscription:void 0};case Er:return{...n,status:"done",input:void 0,_subscription:void 0};case Tn.XSTATE_STOP:return n._subscription.unsubscribe(),{...n,status:"stopped",input:void 0,_subscription:void 0};default:return n}},getInitialSnapshot:(n,r)=>({status:"active",output:void 0,error:void 0,context:void 0,input:r,_subscription:void 0}),start:(n,{self:r,system:s,emit:o})=>{n.status!=="done"&&(n._subscription=t({input:n.input,system:s,self:r,emit:o}).subscribe({next:i=>{r._parent&&s._relay(r,r._parent,i)},error:i=>{s._relay(r,r,{type:Ar,data:i})},complete:()=>{s._relay(r,r,{type:Er})}}))},getPersistedSnapshot:({_subscription:n,...r})=>r,restoreSnapshot:n=>({...n,_subscription:void 0})}}var sa="xstate.promise.resolve",oa="xstate.promise.reject",Sr=new WeakMap;function Du(t){return{config:t,transition:(n,r,s)=>{if(n.status!=="active")return n;switch(r.type){case sa:{let o=r.data;return{...n,status:"done",output:o,input:void 0}}case oa:return{...n,status:"error",error:r.data,input:void 0};case Tn.XSTATE_STOP:return Sr.get(s.self)?.abort(),{...n,status:"stopped",input:void 0};default:return n}},start:(n,{self:r,system:s,emit:o})=>{if(n.status!=="active")return;let i=new AbortController;Sr.set(r,i),Promise.resolve(t({input:n.input,system:s,self:r,signal:i.signal,emit:o})).then(c=>{r.getSnapshot().status==="active"&&(Sr.delete(r),s._relay(r,r,{type:sa,data:c}))},c=>{r.getSnapshot().status==="active"&&(Sr.delete(r),s._relay(r,r,{type:oa,data:c}))})},getInitialSnapshot:(n,r)=>({status:"active",output:void 0,error:void 0,input:r}),getPersistedSnapshot:n=>n,restoreSnapshot:n=>n}}var Pu=ia(t=>{},void 0);function Bu(){return Tn.createActor(Pu)}ot.createEmptyActor=Bu;ot.fromCallback=Mu;ot.fromEventObservable=ju;ot.fromObservable=Uu;ot.fromPromise=Du;ot.fromTransition=ia});var la=re(qe=>{"use strict";var Ie=vr();function Fu(t,{machine:e,context:n},r,s){let o=(i,a={})=>{let{systemId:c,input:l}=a;if(typeof i=="string"){let h=Ie.resolveReferencedActor(e,i);if(!h)throw new Error(`Actor logic '${i}' not implemented in machine '${e.id}'`);let f=Ie.createActor(h,{id:a.id,parent:t.self,syncSnapshot:a.syncSnapshot,input:typeof l=="function"?l({context:n,event:r,self:t.self}):l,src:i,systemId:c});return s[f.id]=f,f}else return Ie.createActor(i,{id:a.id,parent:t.self,syncSnapshot:a.syncSnapshot,input:a.input,src:i,systemId:c})};return(i,a)=>{let c=o(i,a);return s[c.id]=c,t.defer(()=>{c._processingStatus!==Ie.ProcessingStatus.Stopped&&c.start()}),c}}function $u(t,e,n,r,{assignment:s}){if(!e.context)throw new Error("Cannot assign to undefined `context`. Ensure that `context` is defined in the machine config.");let o={},i={context:e.context,event:n.event,spawn:Fu(t,e,n.event,o),self:t.self,system:t.system},a={};if(typeof s=="function")a=s(i,r);else for(let l of Object.keys(s)){let h=s[l];a[l]=typeof h=="function"?h(i,r):h}let c=Object.assign({},e.context,a);return[Ie.cloneMachineSnapshot(e,{context:c,children:Object.keys(o).length?{...e.children,...o}:e.children})]}function ca(t){function e(n,r){}return e.type="xstate.assign",e.assignment=t,e.resolve=$u,e}function Lu(t,e,n,r,{event:s}){let o=typeof s=="function"?s(n,r):s;return[e,{event:o}]}function zu(t,{event:e}){t.defer(()=>t.emit(e))}function fa(t){function e(n,r){}return e.type="xstate.emit",e.event=t,e.resolve=Lu,e.execute=zu,e}var kr=function(t){return t.Parent="#_parent",t.Internal="#_internal",t}({});function Hu(t,e,n,r,{to:s,event:o,id:i,delay:a},c){let l=e.machine.implementations.delays;if(typeof o=="string")throw new Error(`Only event objects may be used with sendTo; use sendTo({ type: "${o}" }) instead`);let h=typeof o=="function"?o(n,r):o,f;if(typeof a=="string"){let w=l&&l[a];f=typeof w=="function"?w(n,r):w}else f=typeof a=="function"?a(n,r):a;let d=typeof s=="function"?s(n,r):s,g;if(typeof d=="string"){if(d===kr.Parent?g=t.self._parent:d===kr.Internal?g=t.self:d.startsWith("#_")?g=e.children[d.slice(2)]:g=c.deferredActorIds?.includes(d)?d:e.children[d],!g)throw new Error(`Unable to send event to actor '${d}' from machine '${e.machine.id}'.`)}else g=d||t.self;return[e,{to:g,event:h,id:i,delay:f}]}function Nu(t,e,n){typeof n.to=="string"&&(n.to=e.children[n.to])}function Vu(t,e){t.defer(()=>{let{to:n,event:r,delay:s,id:o}=e;if(typeof s=="number"){t.system.scheduler.schedule(t.self,n,r,s,o);return}t.system._relay(t.self,n,r.type===Ie.XSTATE_ERROR?Ie.createErrorActorEvent(t.self.id,r.data):r)})}function Ir(t,e,n){function r(s,o){}return r.type="xsnapshot.sendTo",r.to=t,r.event=e,r.id=n?.id,r.delay=n?.delay,r.resolve=Hu,r.retryResolve=Nu,r.execute=Vu,r}function ua(t,e){return Ir(kr.Parent,t,e)}function Wu(t,e){return Ir(t,({event:n})=>n,e)}function qu(t,e,n,r,{collect:s}){let o=[],i=function(c){o.push(c)};return i.assign=(...a)=>{o.push(ca(...a))},i.cancel=(...a)=>{o.push(Ie.cancel(...a))},i.raise=(...a)=>{o.push(Ie.raise(...a))},i.sendTo=(...a)=>{o.push(Ir(...a))},i.sendParent=(...a)=>{o.push(ua(...a))},i.spawnChild=(...a)=>{o.push(Ie.spawnChild(...a))},i.stopChild=(...a)=>{o.push(Ie.stopChild(...a))},i.emit=(...a)=>{o.push(fa(...a))},s({context:n.context,event:n.event,enqueue:i,check:a=>Ie.evaluateGuard(a,e.context,n.event,e),self:t.self,system:t.system},r),[e,void 0,o]}function Ju(t){function e(n,r){}return e.type="xstate.enqueueActions",e.collect=t,e.resolve=qu,e}function Ku(t,e,n,r,{value:s,label:o}){return[e,{value:typeof s=="function"?s(n,r):s,label:o}]}function Gu({logger:t},{value:e,label:n}){n?t(n,e):t(e)}function Xu(t=({context:n,event:r})=>({context:n,event:r}),e){function n(r,s){}return n.type="xstate.log",n.value=t,n.label=e,n.resolve=Ku,n.execute=Gu,n}qe.SpecialTargets=kr;qe.assign=ca;qe.emit=fa;qe.enqueueActions=Ju;qe.forwardTo=Wu;qe.log=Xu;qe.sendParent=ua;qe.sendTo=Ir});var ga=re($=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});var Wt=aa(),U=vr(),Je=la();gr();function Yu(t,e){let n=U.toArray(e);if(!n.includes(t.type)){let r=n.length===1?`type "${n[0]}"`:`one of types "${n.join('", "')}"`;throw new Error(`Expected event ${JSON.stringify(t)} to have ${r}`)}}var da=new WeakMap;function Vt(t,e,n){let r=da.get(t);return r?e in r||(r[e]=n()):(r={[e]:n()},da.set(t,r)),r[e]}var Zu={},On=t=>typeof t=="string"?{type:t}:typeof t=="function"?"resolve"in t?{type:t.type}:{type:t.name}:t,Cr=class t{constructor(e,n){if(this.config=e,this.key=void 0,this.id=void 0,this.type=void 0,this.path=void 0,this.states=void 0,this.history=void 0,this.entry=void 0,this.exit=void 0,this.parent=void 0,this.machine=void 0,this.meta=void 0,this.output=void 0,this.order=-1,this.description=void 0,this.tags=[],this.transitions=void 0,this.always=void 0,this.parent=n._parent,this.key=n._key,this.machine=n._machine,this.path=this.parent?this.parent.path.concat(this.key):[],this.id=this.config.id||[this.machine.id,...this.path].join(U.STATE_DELIMITER),this.type=this.config.type||(this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.description=this.config.description,this.order=this.machine.idMap.size,this.machine.idMap.set(this.id,this),this.states=this.config.states?U.mapValues(this.config.states,(r,s)=>new t(r,{_parent:this,_key:s,_machine:this.machine})):Zu,this.type==="compound"&&!this.config.initial)throw new Error(`No initial state specified for compound state node "#${this.id}". Try adding { initial: "${Object.keys(this.states)[0]}" } to the state config.`);this.history=this.config.history===!0?"shallow":this.config.history||!1,this.entry=U.toArray(this.config.entry).slice(),this.exit=U.toArray(this.config.exit).slice(),this.meta=this.config.meta,this.output=this.type==="final"||!this.parent?this.config.output:void 0,this.tags=U.toArray(e.tags).slice()}_initialize(){this.transitions=U.formatTransitions(this),this.config.always&&(this.always=U.toTransitionConfigArray(this.config.always).map(e=>U.formatTransition(this,U.NULL_EVENT,e))),Object.keys(this.states).forEach(e=>{this.states[e]._initialize()})}get definition(){return{id:this.id,key:this.key,version:this.machine.version,type:this.type,initial:this.initial?{target:this.initial.target,source:this,actions:this.initial.actions.map(On),eventType:null,reenter:!1,toJSON:()=>({target:this.initial.target.map(e=>`#${e.id}`),source:`#${this.id}`,actions:this.initial.actions.map(On),eventType:null})}:void 0,history:this.history,states:U.mapValues(this.states,e=>e.definition),on:this.on,transitions:[...this.transitions.values()].flat().map(e=>({...e,actions:e.actions.map(On)})),entry:this.entry.map(On),exit:this.exit.map(On),meta:this.meta,order:this.order||-1,output:this.output,invoke:this.invoke,description:this.description,tags:this.tags}}toJSON(){return this.definition}get invoke(){return Vt(this,"invoke",()=>U.toArray(this.config.invoke).map((e,n)=>{let{src:r,systemId:s}=e,o=e.id??U.createInvokeId(this.id,n),i=typeof r=="string"?r:`xstate.invoke.${U.createInvokeId(this.id,n)}`;return{...e,src:i,id:o,systemId:s,toJSON(){let{onDone:a,onError:c,...l}=e;return{...l,type:"xstate.invoke",src:i,id:o}}}}))}get on(){return Vt(this,"on",()=>[...this.transitions].flatMap(([n,r])=>r.map(s=>[n,s])).reduce((n,[r,s])=>(n[r]=n[r]||[],n[r].push(s),n),{}))}get after(){return Vt(this,"delayedTransitions",()=>U.getDelayedTransitions(this))}get initial(){return Vt(this,"initial",()=>U.formatInitialTransition(this,this.config.initial))}next(e,n){let r=n.type,s=[],o,i=Vt(this,`candidates-${r}`,()=>U.getCandidates(this,r));for(let a of i){let{guard:c}=a,l=e.context,h=!1;try{h=!c||U.evaluateGuard(c,l,n,e)}catch(f){let d=typeof c=="string"?c:typeof c=="object"?c.type:void 0;throw new Error(`Unable to evaluate guard ${d?`'${d}' `:""}in transition for event '${r}' in state node '${this.id}':
${f.message}`)}if(h){s.push(...a.actions),o=a;break}}return o?[o]:void 0}get events(){return Vt(this,"events",()=>{let{states:e}=this,n=new Set(this.ownEvents);if(e)for(let r of Object.keys(e)){let s=e[r];if(s.states)for(let o of s.events)n.add(`${o}`)}return Array.from(n)})}get ownEvents(){let e=new Set([...this.transitions.keys()].filter(n=>this.transitions.get(n).some(r=>!(!r.target&&!r.actions.length&&!r.reenter))));return Array.from(e)}},Qu="#",Tr=class t{constructor(e,n){this.config=e,this.version=void 0,this.schemas=void 0,this.implementations=void 0,this.__xstatenode=!0,this.idMap=new Map,this.root=void 0,this.id=void 0,this.states=void 0,this.events=void 0,this.id=e.id||"(machine)",this.implementations={actors:n?.actors??{},actions:n?.actions??{},delays:n?.delays??{},guards:n?.guards??{}},this.version=this.config.version,this.schemas=this.config.schemas,this.transition=this.transition.bind(this),this.getInitialSnapshot=this.getInitialSnapshot.bind(this),this.getPersistedSnapshot=this.getPersistedSnapshot.bind(this),this.restoreSnapshot=this.restoreSnapshot.bind(this),this.start=this.start.bind(this),this.root=new Cr(e,{_key:this.id,_machine:this}),this.root._initialize(),this.states=this.root.states,this.events=this.root.events}provide(e){let{actions:n,guards:r,actors:s,delays:o}=this.implementations;return new t(this.config,{actions:{...n,...e.actions},guards:{...r,...e.guards},actors:{...s,...e.actors},delays:{...o,...e.delays}})}resolveState(e){let n=U.resolveStateValue(this.root,e.value),r=U.getAllStateNodes(U.getStateNodes(this.root,n));return U.createMachineSnapshot({_nodes:[...r],context:e.context||{},children:{},status:U.isInFinalState(r,this.root)?"done":e.status||"active",output:e.output,error:e.error,historyValue:e.historyValue},this)}transition(e,n,r){return U.macrostep(e,n,r).snapshot}microstep(e,n,r){return U.macrostep(e,n,r).microstates}getTransitionData(e,n){return U.transitionNode(this.root,e.value,e,n)||[]}getPreInitialState(e,n,r){let{context:s}=this.config,o=U.createMachineSnapshot({context:typeof s!="function"&&s?s:{},_nodes:[this.root],children:{},status:"active"},this);if(typeof s=="function"){let i=({spawn:a,event:c,self:l})=>s({spawn:a,input:c.input,self:l});return U.resolveActionsAndContext(o,n,e,[Je.assign(i)],r)}return o}getInitialSnapshot(e,n){let r=U.createInitEvent(n),s=[],o=this.getPreInitialState(e,r,s),i=U.microstep([{target:[...U.getInitialStateNodes(this.root)],source:this.root,reenter:!0,actions:[],eventType:null,toJSON:null}],o,e,r,!0,s),{snapshot:a}=U.macrostep(i,r,e,s);return a}start(e){Object.values(e.children).forEach(n=>{n.getSnapshot().status==="active"&&n.start()})}getStateNodeById(e){let n=U.toStatePath(e),r=n.slice(1),s=U.isStateId(n[0])?n[0].slice(Qu.length):n[0],o=this.idMap.get(s);if(!o)throw new Error(`Child state node '#${s}' does not exist on machine '${this.id}'`);return U.getStateNodeByPath(o,r)}get definition(){return this.root.definition}toJSON(){return this.definition}getPersistedSnapshot(e,n){return U.getPersistedSnapshot(e,n)}restoreSnapshot(e,n){let r={},s=e.children;Object.keys(s).forEach(c=>{let l=s[c],h=l.snapshot,f=l.src,d=typeof f=="string"?U.resolveReferencedActor(this,f):f;if(!d)return;let g=U.createActor(d,{id:c,parent:n.self,syncSnapshot:l.syncSnapshot,snapshot:h,src:f,systemId:l.systemId});r[c]=g});let o=U.createMachineSnapshot({...e,children:r,_nodes:Array.from(U.getAllStateNodes(U.getStateNodes(this.root,e.value)))},this),i=new Set;function a(c,l){if(!i.has(c)){i.add(c);for(let h in c){let f=c[h];if(f&&typeof f=="object"){if("xstate$$type"in f&&f.xstate$$type===U.$$ACTOR_TYPE){c[h]=l[f.id];continue}a(f,l)}}}}return a(o.context,r),o}};function ha(t,e){return new Tr(t,e)}function pa(t){let e=U.createActor(t);return{self:e,defer:()=>{},id:"",logger:()=>{},sessionId:"",stopChild:()=>{},system:e.system,emit:()=>{}}}function el(t,...[e]){let n=pa(t);return t.getInitialSnapshot(n,e)}function tl(t,e,n){let r=pa(t);return r.self._snapshot=e,t.transition(e,n,r)}function nl({schemas:t,actors:e,actions:n,guards:r,delays:s}){return{createMachine:o=>ha({...o,schemas:t},{actors:e,actions:n,guards:r,delays:s})}}var Xs=class{constructor(){this.timeouts=new Map,this._now=0,this._id=0,this._flushing=!1,this._flushingInvalidated=!1}now(){return this._now}getId(){return this._id++}setTimeout(e,n){this._flushingInvalidated=this._flushing;let r=this.getId();return this.timeouts.set(r,{start:this.now(),timeout:n,fn:e}),r}clearTimeout(e){this._flushingInvalidated=this._flushing,this.timeouts.delete(e)}set(e){if(this._now>e)throw new Error("Unable to travel back in time");this._now=e,this.flushTimeouts()}flushTimeouts(){if(this._flushing){this._flushingInvalidated=!0;return}this._flushing=!0;let e=[...this.timeouts].sort(([n,r],[s,o])=>{let i=r.start+r.timeout;return o.start+o.timeout>i?-1:1});for(let[n,r]of e){if(this._flushingInvalidated){this._flushingInvalidated=!1,this._flushing=!1,this.flushTimeouts();return}this.now()-r.start>=r.timeout&&(this.timeouts.delete(n),r.fn.call(null))}this._flushing=!1}increment(e){this._now+=e,this.flushTimeouts()}};function rl(t){return new Promise((e,n)=>{t.subscribe({complete:()=>{e(t.getSnapshot().output)},error:n})})}var sl={timeout:1/0};function ol(t,e,n){let r={...sl,...n};return new Promise((s,o)=>{let{signal:i}=r;if(i?.aborted){o(i.reason);return}let a=!1,c=r.timeout===1/0?void 0:setTimeout(()=>{l(),o(new Error(`Timeout of ${r.timeout} ms exceeded`))},r.timeout),l=()=>{clearTimeout(c),a=!0,d?.unsubscribe(),f&&i.removeEventListener("abort",f)};function h(g){e(g)&&(l(),s(g))}let f,d;h(t.getSnapshot()),!a&&(i&&(f=()=>{l(),o(i.reason)},i.addEventListener("abort",f)),d=t.subscribe({next:h,error:g=>{l(),o(g)},complete:()=>{l(),o(new Error("Actor terminated without satisfying predicate"))}}),a&&d.unsubscribe())})}$.createEmptyActor=Wt.createEmptyActor;$.fromCallback=Wt.fromCallback;$.fromEventObservable=Wt.fromEventObservable;$.fromObservable=Wt.fromObservable;$.fromPromise=Wt.fromPromise;$.fromTransition=Wt.fromTransition;$.Actor=U.Actor;$.__unsafe_getAllOwnEventDescriptors=U.getAllOwnEventDescriptors;$.and=U.and;$.cancel=U.cancel;$.createActor=U.createActor;$.getStateNodes=U.getStateNodes;$.interpret=U.interpret;$.isMachineSnapshot=U.isMachineSnapshot;$.matchesState=U.matchesState;$.not=U.not;$.or=U.or;$.pathToStateValue=U.pathToStateValue;$.raise=U.raise;$.spawnChild=U.spawnChild;$.stateIn=U.stateIn;$.stop=U.stop;$.stopChild=U.stopChild;$.toObserver=U.toObserver;$.SpecialTargets=Je.SpecialTargets;$.assign=Je.assign;$.emit=Je.emit;$.enqueueActions=Je.enqueueActions;$.forwardTo=Je.forwardTo;$.log=Je.log;$.sendParent=Je.sendParent;$.sendTo=Je.sendTo;$.SimulatedClock=Xs;$.StateMachine=Tr;$.StateNode=Cr;$.assertEvent=Yu;$.createMachine=ha;$.getInitialSnapshot=el;$.getNextSnapshot=tl;$.setup=nl;$.toPromise=rl;$.waitFor=ol});var Zs=re($e=>{"use strict";Object.defineProperty($e,"__esModule",{value:!0});$e.isBytes=ya;$e.number=Or;$e.bool=_a;$e.bytes=Ys;$e.hash=ma;$e.exists=ba;$e.output=wa;function Or(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function _a(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function ya(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function Ys(t,...e){if(!ya(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function ma(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Or(t.outputLen),Or(t.blockLen)}function ba(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function wa(t,e){Ys(t);let n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var il={number:Or,bool:_a,bytes:Ys,hash:ma,exists:ba,output:wa};$e.default=il});var xa=re(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.crypto=void 0;Rr.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var to=re(H=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.Hash=H.nextTick=H.byteSwapIfBE=H.byteSwap=H.isLE=H.rotl=H.rotr=H.createView=H.u32=H.u8=void 0;H.isBytes=al;H.byteSwap32=pl;H.bytesToHex=_l;H.hexToBytes=yl;H.asyncLoop=bl;H.utf8ToBytes=Sa;H.toBytes=Mr;H.concatBytes=wl;H.checkOpts=vl;H.wrapConstructor=Sl;H.wrapConstructorWithOpts=Al;H.wrapXOFConstructorWithOpts=El;H.randomBytes=kl;var qt=xa(),eo=Zs();function al(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}var cl=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength);H.u8=cl;var fl=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));H.u32=fl;var ul=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);H.createView=ul;var ll=(t,e)=>t<<32-e|t>>>e;H.rotr=ll;var dl=(t,e)=>t<<e|t>>>32-e>>>0;H.rotl=dl;H.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var hl=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;H.byteSwap=hl;H.byteSwapIfBE=H.isLE?t=>t:t=>(0,H.byteSwap)(t);function pl(t){for(let e=0;e<t.length;e++)t[e]=(0,H.byteSwap)(t[e])}var gl=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function _l(t){(0,eo.bytes)(t);let e="";for(let n=0;n<t.length;n++)e+=gl[t[n]];return e}var Ke={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function va(t){if(t>=Ke._0&&t<=Ke._9)return t-Ke._0;if(t>=Ke._A&&t<=Ke._F)return t-(Ke._A-10);if(t>=Ke._a&&t<=Ke._f)return t-(Ke._a-10)}function yl(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length,n=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(n);for(let s=0,o=0;s<n;s++,o+=2){let i=va(t.charCodeAt(o)),a=va(t.charCodeAt(o+1));if(i===void 0||a===void 0){let c=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}r[s]=i*16+a}return r}var ml=async()=>{};H.nextTick=ml;async function bl(t,e,n){let r=Date.now();for(let s=0;s<t;s++){n(s);let o=Date.now()-r;o>=0&&o<e||(await(0,H.nextTick)(),r+=o)}}function Sa(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Mr(t){return typeof t=="string"&&(t=Sa(t)),(0,eo.bytes)(t),t}function wl(...t){let e=0;for(let r=0;r<t.length;r++){let s=t[r];(0,eo.bytes)(s),e+=s.length}let n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){let o=t[r];n.set(o,s),s+=o.length}return n}var Qs=class{clone(){return this._cloneInto()}};H.Hash=Qs;var xl={}.toString;function vl(t,e){if(e!==void 0&&xl.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(t,e)}function Sl(t){let e=r=>t().update(Mr(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Al(t){let e=(r,s)=>t(s).update(Mr(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function El(t){let e=(r,s)=>t(s).update(Mr(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function kl(t=32){if(qt.crypto&&typeof qt.crypto.getRandomValues=="function")return qt.crypto.getRandomValues(new Uint8Array(t));if(qt.crypto&&typeof qt.crypto.randomBytes=="function")return qt.crypto.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}});var Aa=re(it=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0});it.HashMD=it.Maj=it.Chi=void 0;var no=Zs(),Rn=to();function Il(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);let s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),a=Number(n&o),c=r?4:0,l=r?0:4;t.setUint32(e+c,i,r),t.setUint32(e+l,a,r)}var Cl=(t,e,n)=>t&e^~t&n;it.Chi=Cl;var Tl=(t,e,n)=>t&e^t&n^e&n;it.Maj=Tl;var ro=class extends Rn.Hash{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=(0,Rn.createView)(this.buffer)}update(e){(0,no.exists)(this);let{view:n,buffer:r,blockLen:s}=this;e=(0,Rn.toBytes)(e);let o=e.length;for(let i=0;i<o;){let a=Math.min(s-this.pos,o-i);if(a===s){let c=(0,Rn.createView)(e);for(;s<=o-i;i+=s)this.process(c,i);continue}r.set(e.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,no.exists)(this),(0,no.output)(e,this),this.finished=!0;let{buffer:n,view:r,blockLen:s,isLE:o}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(r,0),i=0);for(let f=i;f<s;f++)n[f]=0;Il(r,s-8,BigInt(this.length*8),o),this.process(r,0);let a=(0,Rn.createView)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=c/4,h=this.get();if(l>h.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<l;f++)a.setUint32(4*f,h[f],o)}digest(){let{buffer:e,outputLen:n}=this;this.digestInto(e);let r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:n,buffer:r,length:s,finished:o,destroyed:i,pos:a}=this;return e.length=s,e.pos=a,e.finished=o,e.destroyed=i,s%n&&e.buffer.set(r),e}};it.HashMD=ro});var Ea=re(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.sha224=ft.sha256=ft.SHA256=void 0;var so=Aa(),Ce=to(),Ol=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),at=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ct=new Uint32Array(64),Mn=class extends so.HashMD{constructor(){super(64,32,8,!1),this.A=at[0]|0,this.B=at[1]|0,this.C=at[2]|0,this.D=at[3]|0,this.E=at[4]|0,this.F=at[5]|0,this.G=at[6]|0,this.H=at[7]|0}get(){let{A:e,B:n,C:r,D:s,E:o,F:i,G:a,H:c}=this;return[e,n,r,s,o,i,a,c]}set(e,n,r,s,o,i,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=i|0,this.G=a|0,this.H=c|0}process(e,n){for(let f=0;f<16;f++,n+=4)ct[f]=e.getUint32(n,!1);for(let f=16;f<64;f++){let d=ct[f-15],g=ct[f-2],w=(0,Ce.rotr)(d,7)^(0,Ce.rotr)(d,18)^d>>>3,A=(0,Ce.rotr)(g,17)^(0,Ce.rotr)(g,19)^g>>>10;ct[f]=A+ct[f-7]+w+ct[f-16]|0}let{A:r,B:s,C:o,D:i,E:a,F:c,G:l,H:h}=this;for(let f=0;f<64;f++){let d=(0,Ce.rotr)(a,6)^(0,Ce.rotr)(a,11)^(0,Ce.rotr)(a,25),g=h+d+(0,so.Chi)(a,c,l)+Ol[f]+ct[f]|0,A=((0,Ce.rotr)(r,2)^(0,Ce.rotr)(r,13)^(0,Ce.rotr)(r,22))+(0,so.Maj)(r,s,o)|0;h=l,l=c,c=a,a=i+g|0,i=o,o=s,s=r,r=g+A|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,i=i+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,h=h+this.H|0,this.set(r,s,o,i,a,c,l,h)}roundClean(){ct.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};ft.SHA256=Mn;var oo=class extends Mn{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};ft.sha256=(0,Ce.wrapConstructor)(()=>new Mn);ft.sha224=(0,Ce.wrapConstructor)(()=>new oo)});var Ia=re((Yh,ka)=>{"use strict";function Rl(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var r=0;r<t.length;r++){var s=t.charAt(r),o=s.charCodeAt(0);if(e[o]!==255)throw new TypeError(s+" is ambiguous");e[o]=r}var i=t.length,a=t.charAt(0),c=Math.log(i)/Math.log(256),l=Math.log(256)/Math.log(i);function h(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var w=0,A=0,C=0,O=g.length;C!==O&&g[C]===0;)C++,w++;for(var j=(O-C)*l+1>>>0,q=new Uint8Array(j);C!==O;){for(var T=g[C],N=0,X=j-1;(T!==0||N<A)&&X!==-1;X--,N++)T+=256*q[X]>>>0,q[X]=T%i>>>0,T=T/i>>>0;if(T!==0)throw new Error("Non-zero carry");A=N,C++}for(var V=j-A;V!==j&&q[V]===0;)V++;for(var Y=a.repeat(w);V<j;++V)Y+=t.charAt(q[V]);return Y}function f(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;for(var w=0,A=0,C=0;g[w]===a;)A++,w++;for(var O=(g.length-w)*c+1>>>0,j=new Uint8Array(O);g[w];){var q=e[g.charCodeAt(w)];if(q===255)return;for(var T=0,N=O-1;(q!==0||T<C)&&N!==-1;N--,T++)q+=i*j[N]>>>0,j[N]=q%256>>>0,q=q/256>>>0;if(q!==0)throw new Error("Non-zero carry");C=T,w++}for(var X=O-C;X!==O&&j[X]===0;)X++;for(var V=new Uint8Array(A+(O-X)),Y=A;X!==O;)V[Y++]=j[X++];return V}function d(g){var w=f(g);if(w)return w;throw new Error("Non-base"+i+" character")}return{encode:h,decodeUnsafe:f,decode:d}}ka.exports=Rl});var Ta=re((Zh,Ca)=>{var Ml=Ia(),Ul="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";Ca.exports=Ml(Ul)});var Ra=re((Qh,Oa)=>{"use strict";var io=Ta();Oa.exports=function(t){function e(o){var i=Uint8Array.from(o),a=t(i),c=i.length+4,l=new Uint8Array(c);return l.set(i,0),l.set(a.subarray(0,4),i.length),io.encode(l,c)}function n(o){var i=o.slice(0,-4),a=o.slice(-4),c=t(i);if(!(a[0]^c[0]|a[1]^c[1]|a[2]^c[2]|a[3]^c[3]))return i}function r(o){var i=io.decodeUnsafe(o);if(i)return n(i)}function s(o){var i=io.decode(o),a=n(i,t);if(!a)throw new Error("Invalid checksum");return a}return{encode:e,decode:s,decodeUnsafe:r}}});var ja=re((ep,Ua)=>{"use strict";var{sha256:Ma}=Ea(),jl=Ra();function Dl(t){return Ma(Ma(t))}Ua.exports=jl(Dl)});var fc=re((cc,Gr)=>{(function(t,e){var n={};e(n);var r=n.default;for(var s in n)r[s]=n[s];typeof Gr=="object"&&typeof Gr.exports=="object"?Gr.exports=r:typeof define=="function"&&define.amd?define(function(){return r}):t.sha256=r})(cc,function(t){"use strict";t.__esModule=!0,t.digestLength=32,t.blockSize=64;var e=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function n(f,d,g,w,A){for(var C,O,j,q,T,N,X,V,Y,Z,He,Re,lt;A>=64;){for(C=d[0],O=d[1],j=d[2],q=d[3],T=d[4],N=d[5],X=d[6],V=d[7],Z=0;Z<16;Z++)He=w+Z*4,f[Z]=(g[He]&255)<<24|(g[He+1]&255)<<16|(g[He+2]&255)<<8|g[He+3]&255;for(Z=16;Z<64;Z++)Y=f[Z-2],Re=(Y>>>17|Y<<15)^(Y>>>19|Y<<13)^Y>>>10,Y=f[Z-15],lt=(Y>>>7|Y<<25)^(Y>>>18|Y<<14)^Y>>>3,f[Z]=(Re+f[Z-7]|0)+(lt+f[Z-16]|0);for(Z=0;Z<64;Z++)Re=(((T>>>6|T<<26)^(T>>>11|T<<21)^(T>>>25|T<<7))+(T&N^~T&X)|0)+(V+(e[Z]+f[Z]|0)|0)|0,lt=((C>>>2|C<<30)^(C>>>13|C<<19)^(C>>>22|C<<10))+(C&O^C&j^O&j)|0,V=X,X=N,N=T,T=q+Re|0,q=j,j=O,O=C,C=Re+lt|0;d[0]+=C,d[1]+=O,d[2]+=j,d[3]+=q,d[4]+=T,d[5]+=N,d[6]+=X,d[7]+=V,w+=64,A-=64}return w}var r=function(){function f(){this.digestLength=t.digestLength,this.blockSize=t.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return f.prototype.reset=function(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},f.prototype.clean=function(){for(var d=0;d<this.buffer.length;d++)this.buffer[d]=0;for(var d=0;d<this.temp.length;d++)this.temp[d]=0;this.reset()},f.prototype.update=function(d,g){if(g===void 0&&(g=d.length),this.finished)throw new Error("SHA256: can't update because hash was finished.");var w=0;if(this.bytesHashed+=g,this.bufferLength>0){for(;this.bufferLength<64&&g>0;)this.buffer[this.bufferLength++]=d[w++],g--;this.bufferLength===64&&(n(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(g>=64&&(w=n(this.temp,this.state,d,w,g),g%=64);g>0;)this.buffer[this.bufferLength++]=d[w++],g--;return this},f.prototype.finish=function(d){if(!this.finished){var g=this.bytesHashed,w=this.bufferLength,A=g/536870912|0,C=g<<3,O=g%64<56?64:128;this.buffer[w]=128;for(var j=w+1;j<O-8;j++)this.buffer[j]=0;this.buffer[O-8]=A>>>24&255,this.buffer[O-7]=A>>>16&255,this.buffer[O-6]=A>>>8&255,this.buffer[O-5]=A>>>0&255,this.buffer[O-4]=C>>>24&255,this.buffer[O-3]=C>>>16&255,this.buffer[O-2]=C>>>8&255,this.buffer[O-1]=C>>>0&255,n(this.temp,this.state,this.buffer,0,O),this.finished=!0}for(var j=0;j<8;j++)d[j*4+0]=this.state[j]>>>24&255,d[j*4+1]=this.state[j]>>>16&255,d[j*4+2]=this.state[j]>>>8&255,d[j*4+3]=this.state[j]>>>0&255;return this},f.prototype.digest=function(){var d=new Uint8Array(this.digestLength);return this.finish(d),d},f.prototype._saveState=function(d){for(var g=0;g<this.state.length;g++)d[g]=this.state[g]},f.prototype._restoreState=function(d,g){for(var w=0;w<this.state.length;w++)this.state[w]=d[w];this.bytesHashed=g,this.finished=!1,this.bufferLength=0},f}();t.Hash=r;var s=function(){function f(d){this.inner=new r,this.outer=new r,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var g=new Uint8Array(this.blockSize);if(d.length>this.blockSize)new r().update(d).finish(g).clean();else for(var w=0;w<d.length;w++)g[w]=d[w];for(var w=0;w<g.length;w++)g[w]^=54;this.inner.update(g);for(var w=0;w<g.length;w++)g[w]^=106;this.outer.update(g),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate);for(var w=0;w<g.length;w++)g[w]=0}return f.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},f.prototype.clean=function(){for(var d=0;d<this.istate.length;d++)this.ostate[d]=this.istate[d]=0;this.inner.clean(),this.outer.clean()},f.prototype.update=function(d){return this.inner.update(d),this},f.prototype.finish=function(d){return this.outer.finished?this.outer.finish(d):(this.inner.finish(d),this.outer.update(d,this.digestLength).finish(d)),this},f.prototype.digest=function(){var d=new Uint8Array(this.digestLength);return this.finish(d),d},f}();t.HMAC=s;function o(f){var d=new r().update(f),g=d.digest();return d.clean(),g}t.hash=o,t.default=o;function i(f,d){var g=new s(f).update(d),w=g.digest();return g.clean(),w}t.hmac=i;function a(f,d,g,w){var A=w[0];if(A===0)throw new Error("hkdf: cannot expand more");d.reset(),A>1&&d.update(f),g&&d.update(g),d.update(w),d.finish(f),w[0]++}var c=new Uint8Array(t.digestLength);function l(f,d,g,w){d===void 0&&(d=c),w===void 0&&(w=32);for(var A=new Uint8Array([1]),C=i(d,f),O=new s(C),j=new Uint8Array(O.digestLength),q=j.length,T=new Uint8Array(w),N=0;N<w;N++)q===j.length&&(a(j,O,g,A),q=0),T[N]=j[q++];return O.clean(),j.fill(0),A.fill(0),T}t.hkdf=l;function h(f,d,g,w){for(var A=new s(f),C=A.digestLength,O=new Uint8Array(4),j=new Uint8Array(C),q=new Uint8Array(C),T=new Uint8Array(w),N=0;N*C<w;N++){var X=N+1;O[0]=X>>>24&255,O[1]=X>>>16&255,O[2]=X>>>8&255,O[3]=X>>>0&255,A.reset(),A.update(d),A.update(O),A.finish(q);for(var V=0;V<C;V++)j[V]=q[V];for(var V=2;V<=g;V++){A.reset(),A.update(q).finish(q);for(var Y=0;Y<C;Y++)j[Y]^=q[Y]}for(var V=0;V<C&&N*C+V<w;V++)T[N*C+V]=j[V]}for(var N=0;N<C;N++)j[N]=q[N]=0;for(var N=0;N<4;N++)O[N]=0;return A.clean(),T}t.pbkdf2=h})});var De={};Vn(De,{Counter:()=>de,Float64:()=>et,Int:()=>Ze,RawString:()=>Ue,Uint:()=>Qe,applyChanges:()=>pn,block:()=>sf,change:()=>fn,changeAt:()=>un,clone:()=>ef,decodeChange:()=>ur,decodeSyncMessage:()=>mn,decodeSyncState:()=>mt,deleteAt:()=>ar,diff:()=>jt,dump:()=>Ts,emptyChange:()=>bs,encodeChange:()=>ks,encodeSyncMessage:()=>Is,encodeSyncState:()=>yt,equals:()=>Ot,free:()=>ys,from:()=>tf,generateSyncMessage:()=>gn,getActorId:()=>vs,getAllChanges:()=>hn,getBackend:()=>Qc,getChanges:()=>fr,getConflicts:()=>_i,getCursor:()=>di,getCursorPosition:()=>hi,getHeads:()=>ue,getHistory:()=>As,getLastLocalChange:()=>Ss,getMissingDeps:()=>Cs,getObjectId:()=>cr,hasHeads:()=>Ms,hasOurChanges:()=>Es,init:()=>Ve,initSyncState:()=>yn,initializeBase64Wasm:()=>an,initializeWasm:()=>Tt,insertAt:()=>ir,inspectChange:()=>xn,isAutomerge:()=>Rs,isWasmInitialized:()=>sr,joinBlock:()=>af,load:()=>nf,loadIncremental:()=>_t,mark:()=>pi,marks:()=>uf,marksAt:()=>lf,merge:()=>dn,receiveSyncMessage:()=>_n,save:()=>ln,saveIncremental:()=>xs,saveSince:()=>bn,spans:()=>rf,splice:()=>ui,splitBlock:()=>of,stats:()=>vn,toJS:()=>Os,topoHistoryTraversal:()=>wn,unmark:()=>gi,updateBlock:()=>cf,updateSpans:()=>ff,updateText:()=>li,view:()=>Mt,wasmInitialized:()=>rr});var we=Symbol.for("_am_meta"),Xe=Symbol.for("_am_trace"),Ye=Symbol.for("_am_objectId"),It=Symbol.for("_am_isProxy"),Qt=Symbol.for("_am_clearCache"),Wn=Symbol.for("_am_uint"),qn=Symbol.for("_am_int"),Jn=Symbol.for("_am_f64"),Kn=Symbol.for("_am_counter"),No=Symbol.for("_am_text");var ye=class t{constructor(e){if(typeof e=="string")this.elems=[...e];else if(Array.isArray(e))this.elems=e;else if(e===void 0)this.elems=[];else throw new TypeError(`Unsupported initial value for Text: ${e}`);Reflect.defineProperty(this,No,{value:!0})}get length(){return this.elems.length}get(e){return this.elems[e]}[Symbol.iterator](){let e=this.elems,n=-1;return{next(){return n+=1,n<e.length?{done:!1,value:e[n]}:{done:!0}}}}toString(){if(!this.str){this.str="";for(let e of this.elems)typeof e=="string"?this.str+=e:this.str+="\uFFFC"}return this.str}toSpans(){if(!this.spans){this.spans=[];let e="";for(let n of this.elems)typeof n=="string"?e+=n:(e.length>0&&(this.spans.push(e),e=""),this.spans.push(n));e.length>0&&this.spans.push(e)}return this.spans}toJSON(){return this.toString()}set(e,n){if(this[we])throw new RangeError("object cannot be modified outside of a change block");this.elems[e]=n}insertAt(e,...n){if(this[we])throw new RangeError("object cannot be modified outside of a change block");n.every(r=>typeof r=="string")?this.elems.splice(e,0,...n.join("")):this.elems.splice(e,0,...n)}deleteAt(e,n=1){if(this[we])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(e,n)}map(e){this.elems.map(e)}lastIndexOf(e,n){this.elems.lastIndexOf(e,n)}concat(e){return new t(this.elems.concat(e.elems))}every(e){return this.elems.every(e)}filter(e){return new t(this.elems.filter(e))}find(e){return this.elems.find(e)}findIndex(e){return this.elems.findIndex(e)}forEach(e){this.elems.forEach(e)}includes(e){return this.elems.includes(e)}indexOf(e){return this.elems.indexOf(e)}join(e){return this.elems.join(e)}reduce(e){this.elems.reduce(e)}reduceRight(e){this.elems.reduceRight(e)}slice(e,n){return new t(this.elems.slice(e,n))}some(e){return this.elems.some(e)}toLocaleString(){this.toString()}};var de=class{constructor(e){this.value=e||0,Reflect.defineProperty(this,Kn,{value:!0})}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}increment(e){throw new Error("Counters should not be incremented outside of a change callback")}decrement(e){throw new Error("Counters should not be decremented outside of a change callback")}},es=class extends de{constructor(e,n,r,s,o){super(e),this.context=n,this.path=r,this.objectId=s,this.key=o}increment(e){return e=typeof e=="number"?e:1,this.context.increment(this.objectId,this.key,e),this.value+=e,this.value}decrement(e){return this.increment(typeof e=="number"?-e:-1)}};function Vo(t,e,n,r,s){return new es(t,e,n,r,s)}var Ze=class{constructor(e){if(!(Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER))throw new RangeError(`Value ${e} cannot be a uint`);this.value=e,Reflect.defineProperty(this,qn,{value:!0}),Object.freeze(this)}},Qe=class{constructor(e){if(!(Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=0))throw new RangeError(`Value ${e} cannot be a uint`);this.value=e,Reflect.defineProperty(this,Wn,{value:!0}),Object.freeze(this)}},et=class{constructor(e){if(typeof e!="number")throw new RangeError(`Value ${e} cannot be a float64`);this.value=e||0,Reflect.defineProperty(this,Jn,{value:!0}),Object.freeze(this)}};var Ue=class{constructor(e){this.val=e}toString(){return this.val}toJSON(){return this.val}};function Be(t){if(typeof t=="string"&&/^[0-9]+$/.test(t)&&(t=parseInt(t,10)),typeof t!="number")return t;if(t<0||isNaN(t)||t===1/0||t===-1/0)throw new RangeError("A list index must be positive, but you passed "+t);return t}function Ee(t,e){let{context:n,objectId:r,path:s,textV2:o}=t,i=n.getWithType(r,e);if(i===null)return;let a=i[0],c=i[1];switch(a){case void 0:return;case"map":return dt(n,c,o,[...s,e]);case"list":return Ct(n,c,o,[...s,e]);case"text":return o?n.text(c):en(n,c,[...s,e]);case"str":return c;case"uint":return c;case"int":return c;case"f64":return c;case"boolean":return c;case"null":return null;case"bytes":return c;case"timestamp":return c;case"counter":return Vo(c,n,s,r,e);default:throw RangeError(`datatype ${a} unimplemented`)}}function Gn(t,e,n,r){let s=typeof t;switch(s){case"object":if(t==null)return[null,"null"];if(t[Wn])return[t.value,"uint"];if(t[qn])return[t.value,"int"];if(t[Jn])return[t.value,"f64"];if(t[Kn])return[t.value,"counter"];if(t instanceof Date)return[t.getTime(),"timestamp"];if(t instanceof Ue)return[t.toString(),"str"];if(t instanceof ye)return[t,"text"];if(t instanceof Uint8Array)return[t,"bytes"];if(t instanceof Array)return[t,"list"];if(Object.prototype.toString.call(t)==="[object Object]")return[t,"map"];throw Yn(t,r)?new RangeError("Cannot create a reference to an existing document object"):new RangeError(`Cannot assign unknown object: ${t}`);case"boolean":return[t,"boolean"];case"number":return Number.isInteger(t)?[t,"int"]:[t,"f64"];case"string":return e?[t,"text"]:[t,"str"];case"undefined":throw new RangeError([`Cannot assign undefined value at ${Wo(n)}, `,"because `undefined` is not a valid JSON data type. ","You might consider setting the property's value to `null`, ","or using `delete` to remove it altogether."].join(""));default:throw new RangeError([`Cannot assign ${s} value at ${Wo(n)}. `,"All JSON primitive datatypes (object, array, string, number, boolean, null) ",`are supported in an Automerge document; ${s} values are not. `].join(""))}}function Yn(t,e){var n,r;return t instanceof Date?!1:!!(t&&((r=(n=t[we])===null||n===void 0?void 0:n.handle)===null||r===void 0?void 0:r.__wbg_ptr)===e.__wbg_ptr)}var Sc={get(t,e){let{context:n,objectId:r,cache:s}=t;return e===Symbol.toStringTag?t[Symbol.toStringTag]:e===Ye?r:e===It?!0:e===Xe?t.trace:e===we?{handle:n,textV2:t.textV2}:(s[e]||(s[e]=Ee(t,e)),s[e])},set(t,e,n){let{context:r,objectId:s,path:o,textV2:i}=t;if(t.cache={},Yn(n,r))throw new RangeError("Cannot create a reference to an existing document object");if(e===Xe)return t.trace=n,!0;if(e===Qt)return!0;let[a,c]=Gn(n,i,[...o,e],r);switch(c){case"list":{let l=r.putObject(s,e,[]),h=Ct(r,l,i,[...o,e]);for(let f=0;f<a.length;f++)h[f]=a[f];break}case"text":{if(i)Xn(a),r.putObject(s,e,a);else{ns(a);let l=r.putObject(s,e,"");en(r,l,[...o,e]).splice(0,0,...a)}break}case"map":{let l=r.putObject(s,e,{}),h=dt(r,l,i,[...o,e]);for(let f in a)h[f]=a[f];break}default:r.put(s,e,a,c)}return!0},deleteProperty(t,e){let{context:n,objectId:r}=t;return t.cache={},n.delete(r,e),!0},has(t,e){return this.get(t,e)!==void 0},getOwnPropertyDescriptor(t,e){let n=this.get(t,e);if(typeof n<"u")return{configurable:!0,enumerable:!0,value:n}},ownKeys(t){let{context:e,objectId:n}=t,r=e.keys(n);return[...new Set(r)]}},qo={get(t,e){let{context:n,objectId:r}=t;return e=Be(e),e===Symbol.hasInstance?s=>Array.isArray(s):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===Ye?r:e===It?!0:e===Xe?t.trace:e===we?{handle:n}:e==="length"?n.length(r):typeof e=="number"?Ee(t,e):ts(t)[e]},set(t,e,n){let{context:r,objectId:s,path:o,textV2:i}=t;if(e=Be(e),Yn(n,r))throw new RangeError("Cannot create a reference to an existing document object");if(e===Qt)return!0;if(e===Xe)return t.trace=n,!0;if(typeof e=="string")throw new RangeError("list index must be a number");let[a,c]=Gn(n,i,[...o,e],r);switch(c){case"list":{let l;e>=r.length(s)?l=r.insertObject(s,e,[]):l=r.putObject(s,e,[]),Ct(r,l,i,[...o,e]).splice(0,0,...a);break}case"text":{if(i)Xn(a),e>=r.length(s)?r.insertObject(s,e,a):r.putObject(s,e,a);else{let l;ns(a),e>=r.length(s)?l=r.insertObject(s,e,""):l=r.putObject(s,e,""),en(r,l,[...o,e]).splice(0,0,...a)}break}case"map":{let l;e>=r.length(s)?l=r.insertObject(s,e,{}):l=r.putObject(s,e,{});let h=dt(r,l,i,[...o,e]);for(let f in a)h[f]=a[f];break}default:e>=r.length(s)?r.insert(s,e,a,c):r.put(s,e,a,c)}return!0},deleteProperty(t,e){let{context:n,objectId:r}=t;e=Be(e);let s=n.get(r,e);if(s!=null&&s[0]=="counter")throw new TypeError("Unsupported operation: deleting a counter from a list");return n.delete(r,e),!0},has(t,e){let{context:n,objectId:r}=t;return e=Be(e),typeof e=="number"?e<n.length(r):e==="length"},getOwnPropertyDescriptor(t,e){let{context:n,objectId:r}=t;return e==="length"?{writable:!0,value:n.length(r)}:e===Ye?{configurable:!1,enumerable:!1,value:r}:(e=Be(e),{configurable:!0,enumerable:!0,value:Ee(t,e)})},getPrototypeOf(t){return Object.getPrototypeOf(t)},ownKeys(){let t=[];return t.push("length"),t}},Ac=Object.assign({},qo,{get(t,e){let{context:n,objectId:r}=t;return e=Be(e),e===Symbol.hasInstance?s=>Array.isArray(s):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===Ye?r:e===It?!0:e===Xe?t.trace:e===we?{handle:n}:e==="length"?n.length(r):typeof e=="number"?Ee(t,e):Ec(t)[e]||ts(t)[e]},getPrototypeOf(){return Object.getPrototypeOf(new ye)}});function dt(t,e,n,r){let s={context:t,objectId:e,path:r||[],cache:{},textV2:n},o={};return Object.assign(o,s),new Proxy(o,Sc)}function Ct(t,e,n,r){let s={context:t,objectId:e,path:r||[],cache:{},textV2:n},o=[];return Object.assign(o,s),new Proxy(o,qo)}function en(t,e,n){let r={context:t,objectId:e,path:n||[],cache:{},textV2:!1},s={};return Object.assign(s,r),new Proxy(s,Ac)}function Jo(t,e){return dt(t,"_root",e,[])}function ts(t){let{context:e,objectId:n,path:r,textV2:s}=t;return{deleteAt(i,a){return typeof a=="number"?e.splice(n,i,a):e.delete(n,i),this},fill(i,a,c){let[l,h]=Gn(i,s,[...r,a],e),f=e.length(n);a=Be(a||0),c=Be(c||f);for(let d=a;d<Math.min(c,f);d++)if(h==="list"||h==="map")e.putObject(n,d,l);else if(h==="text")if(s)Xn(l),e.putObject(n,d,l);else{ns(l);let g=e.putObject(n,d,""),w=en(e,g,[...r,d]);for(let A=0;A<l.length;A++)w[A]=l.get(A)}else e.put(n,d,l,h);return this},indexOf(i,a=0){let c=e.length(n);for(let l=a;l<c;l++){let h=e.getWithType(n,l);if(h&&(h[1]===i[Ye]||h[1]===i))return l}return-1},insertAt(i,...a){return this.splice(i,0,...a),this},pop(){let i=e.length(n);if(i==0)return;let a=Ee(t,i-1);return e.delete(n,i-1),a},push(...i){let a=e.length(n);return this.splice(a,0,...i),e.length(n)},shift(){if(e.length(n)==0)return;let i=Ee(t,0);return e.delete(n,0),i},splice(i,a,...c){i=Be(i),typeof a!="number"&&(a=e.length(n)-i),a=Be(a);for(let f of c)if(Yn(f,e))throw new RangeError("Cannot create a reference to an existing document object");let l=[];for(let f=0;f<a;f++){let d=Ee(t,i);d!==void 0&&l.push(d),e.delete(n,i)}let h=c.map((f,d)=>{try{return Gn(f,s,[...r],e)}catch(g){throw g instanceof RangeError?new RangeError(`${g.message} (at index ${d} in the input)`):g}});for(let[f,d]of h){switch(d){case"list":{let g=e.insertObject(n,i,[]);Ct(e,g,s,[...r,i]).splice(0,0,...f);break}case"text":{if(s)Xn(f),e.insertObject(n,i,f);else{let g=e.insertObject(n,i,"");en(e,g,[...r,i]).splice(0,0,...f)}break}case"map":{let g=e.insertObject(n,i,{}),w=dt(e,g,s,[...r,i]);for(let A in f)w[A]=f[A];break}default:e.insert(n,i,f,d)}i+=1}return l},unshift(...i){return this.splice(0,0,...i),e.length(n)},entries(){let i=0;return{next:()=>{let c=Ee(t,i);return c===void 0?{value:void 0,done:!0}:{value:[i++,c],done:!1}},[Symbol.iterator](){return this}}},keys(){let i=0,a=e.length(n);return{next:()=>i<a?{value:i++,done:!1}:{value:void 0,done:!0},[Symbol.iterator](){return this}}},values(){let i=0;return{next:()=>{let c=Ee(t,i++);return c===void 0?{value:void 0,done:!0}:{value:c,done:!1}},[Symbol.iterator](){return this}}},toArray(){let i=[],a;do a=Ee(t,i.length),a!==void 0&&i.push(a);while(a!==void 0);return i},map(i){return this.toArray().map(i)},toString(){return this.toArray().toString()},toLocaleString(){return this.toArray().toLocaleString()},forEach(i){return this.toArray().forEach(i)},concat(i){return this.toArray().concat(i)},every(i){return this.toArray().every(i)},filter(i){return this.toArray().filter(i)},find(i){let a=0;for(let c of this){if(i(c,a))return c;a+=1}},findIndex(i){let a=0;for(let c of this){if(i(c,a))return a;a+=1}return-1},includes(i){return this.find(a=>a===i)!==void 0},join(i){return this.toArray().join(i)},reduce(i,a){return this.toArray().reduce(i,a)},reduceRight(i,a){return this.toArray().reduceRight(i,a)},lastIndexOf(i,a=1/0){return this.toArray().lastIndexOf(i,a)},slice(i,a){return this.toArray().slice(i,a)},some(i){let a=0;for(let c of this){if(i(c,a))return!0;a+=1}return!1},[Symbol.iterator]:function*(){let i=0,a=Ee(t,i);for(;a!==void 0;)yield a,i+=1,a=Ee(t,i)}}}function Ec(t){let{context:e,objectId:n}=t;return{set(s,o){return this[s]=o},get(s){return this[s]},toString(){return e.text(n).replace(//g,"")},toSpans(){let s=[],o="",i=e.length(n);for(let a=0;a<i;a++){let c=this[a];typeof c=="string"?o+=c:(o.length>0&&(s.push(o),o=""),s.push(c))}return o.length>0&&s.push(o),s},toJSON(){return this.toString()},indexOf(s,o=0){return e.text(n).indexOf(s,o)},insertAt(s,...o){o.every(i=>typeof i=="string")?e.splice(n,s,0,o.join("")):ts(t).insertAt(s,...o)}}}function ns(t){if(!(t instanceof ye))throw new Error("value was not a Text instance")}function Xn(t){if(typeof t!="string")throw new Error("value was not a string")}function Wo(t){let e=t.map(n=>{if(typeof n=="number")return n.toString();if(typeof n=="string")return n.replace(/~/g,"~0").replace(/\//g,"~1")});return t.length===0?"":"/"+e.join("/")}function Ko(t,e,n){return Xo(t,e,n,!0,(r,s)=>new ye(r.text(s)))}function Go(t,e,n){return Xo(t,e,n,!0,(r,s)=>r.text(s))}function Xo(t,e,n,r,s){let o=t.getAll(e,n);if(o.length<=1)return;let i={};for(let a of o)switch(a[0]){case"map":i[a[1]]=dt(t,a[1],r,[n]);break;case"list":i[a[1]]=Ct(t,a[1],r,[n]);break;case"text":i[a[1]]=s(t,a[1]);break;case"str":case"uint":case"int":case"f64":case"boolean":case"bytes":case"null":i[a[2]]=a[1];break;case"counter":i[a[2]]=new de(a[1]);break;case"timestamp":i[a[2]]=new Date(a[1]);break;default:throw RangeError(`datatype ${a[0]} unimplemented`)}return i}var Zn,kc=new Uint8Array(16);function rs(){if(!Zn&&(Zn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Zn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Zn(kc)}var Yo=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ic(t){return typeof t=="string"&&Yo.test(t)}var tt=Ic;var fe=[];for(let t=0;t<256;++t)fe.push((t+256).toString(16).slice(1));function ss(t,e=0){return fe[t[e+0]]+fe[t[e+1]]+fe[t[e+2]]+fe[t[e+3]]+"-"+fe[t[e+4]]+fe[t[e+5]]+"-"+fe[t[e+6]]+fe[t[e+7]]+"-"+fe[t[e+8]]+fe[t[e+9]]+"-"+fe[t[e+10]]+fe[t[e+11]]+fe[t[e+12]]+fe[t[e+13]]+fe[t[e+14]]+fe[t[e+15]]}function Cc(t,e=0){let n=ss(t,e);if(!tt(n))throw TypeError("Stringified UUID is invalid");return n}var os=Cc;function Tc(t){if(!tt(t))throw TypeError("Invalid UUID");let e,n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=e&255,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=e&255,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=e&255,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=e&255,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=e&255,n}var is=Tc;var Oc=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),as={randomUUID:Oc};function Rc(t,e,n){if(as.randomUUID&&!e&&!t)return as.randomUUID();t=t||{};let r=t.random||(t.rng||rs)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=r[s];return e}return ss(r)}var ht=Rc;function Qo(){return ht().replace(/-/g,"")}var cs=Qo,Qn=()=>cs();Qn.setFactory=t=>{cs=t};Qn.reset=()=>{cs=Qo};var ls={};Vn(ls,{Automerge:()=>on,SyncState:()=>je,TextRepresentation:()=>Wc,create:()=>jc,decodeChange:()=>Bc,decodeSyncMessage:()=>Hc,decodeSyncState:()=>Vc,default:()=>us,encodeChange:()=>Pc,encodeSyncMessage:()=>zc,encodeSyncState:()=>Nc,exportSyncState:()=>Lc,importSyncState:()=>$c,initSync:()=>Jc,initSyncState:()=>Fc,load:()=>Dc});var u,Ne=new Array(128).fill(void 0);Ne.push(void 0,null,!0,!1);function I(t){return Ne[t]}var sn=Ne.length;function Mc(t){t<132||(Ne[t]=sn,sn=t)}function v(t){let e=I(t);return Mc(t),e}var ke=0,tn=null;function er(){return(tn===null||tn.byteLength===0)&&(tn=new Uint8Array(u.memory.buffer)),tn}var tr=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Uc=typeof tr.encodeInto=="function"?function(t,e){return tr.encodeInto(t,e)}:function(t,e){let n=tr.encode(t);return e.set(n),{read:t.length,written:n.length}};function Fe(t,e,n){if(n===void 0){let a=tr.encode(t),c=e(a.length,1)>>>0;return er().subarray(c,c+a.length).set(a),ke=a.length,c}let r=t.length,s=e(r,1)>>>0,o=er(),i=0;for(;i<r;i++){let a=t.charCodeAt(i);if(a>127)break;o[s+i]=a}if(i!==r){i!==0&&(t=t.slice(i)),s=n(s,r,r=i+t.length*3,1)>>>0;let a=er().subarray(s+i,s+r),c=Uc(t,a);i+=c.written,s=n(s,r,i,1)>>>0}return ke=i,s}function Q(t){return t==null}var nn=null;function _(){return(nn===null||nn.byteLength===0)&&(nn=new Int32Array(u.memory.buffer)),nn}var ni=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&ni.decode();function xe(t,e){return t=t>>>0,ni.decode(er().subarray(t,t+e))}function b(t){sn===Ne.length&&Ne.push(Ne.length+1);let e=sn;return sn=Ne[e],Ne[e]=t,e}var rn=null;function nr(){return(rn===null||rn.byteLength===0)&&(rn=new Float64Array(u.memory.buffer)),rn}function fs(t){let e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){let s=t.description;return s==null?"Symbol":`Symbol(${s})`}if(e=="function"){let s=t.name;return typeof s=="string"&&s.length>0?`Function(${s})`:"Function"}if(Array.isArray(t)){let s=t.length,o="[";s>0&&(o+=fs(t[0]));for(let i=1;i<s;i++)o+=", "+fs(t[i]);return o+="]",o}let n=/\[object ([^\]]+)\]/.exec(toString.call(t)),r;if(n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function pt(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`);return t.ptr}function jc(t){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.create(s,b(t));var e=_()[s/4+0],n=_()[s/4+1],r=_()[s/4+2];if(r)throw v(n);return on.__wrap(e)}finally{u.__wbindgen_add_to_stack_pointer(16)}}function Dc(t,e){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.load(o,b(t),b(e));var n=_()[o/4+0],r=_()[o/4+1],s=_()[o/4+2];if(s)throw v(r);return on.__wrap(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}function Pc(t){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.encodeChange(s,b(t));var e=_()[s/4+0],n=_()[s/4+1],r=_()[s/4+2];if(r)throw v(n);return v(e)}finally{u.__wbindgen_add_to_stack_pointer(16)}}function Bc(t){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.decodeChange(s,b(t));var e=_()[s/4+0],n=_()[s/4+1],r=_()[s/4+2];if(r)throw v(n);return v(e)}finally{u.__wbindgen_add_to_stack_pointer(16)}}function Fc(){let t=u.initSyncState();return je.__wrap(t)}function $c(t){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.importSyncState(s,b(t));var e=_()[s/4+0],n=_()[s/4+1],r=_()[s/4+2];if(r)throw v(n);return je.__wrap(e)}finally{u.__wbindgen_add_to_stack_pointer(16)}}function Lc(t){pt(t,je);let e=u.exportSyncState(t.__wbg_ptr);return v(e)}function zc(t){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.encodeSyncMessage(s,b(t));var e=_()[s/4+0],n=_()[s/4+1],r=_()[s/4+2];if(r)throw v(n);return v(e)}finally{u.__wbindgen_add_to_stack_pointer(16)}}function Hc(t){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.decodeSyncMessage(s,b(t));var e=_()[s/4+0],n=_()[s/4+1],r=_()[s/4+2];if(r)throw v(n);return v(e)}finally{u.__wbindgen_add_to_stack_pointer(16)}}function Nc(t){pt(t,je);let e=u.encodeSyncState(t.__wbg_ptr);return v(e)}function Vc(t){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.decodeSyncState(s,b(t));var e=_()[s/4+0],n=_()[s/4+1],r=_()[s/4+2];if(r)throw v(n);return je.__wrap(e)}finally{u.__wbindgen_add_to_stack_pointer(16)}}function he(t,e){try{return t.apply(this,e)}catch(n){u.__wbindgen_exn_store(b(n))}}var Wc=Object.freeze({Array:0,0:"Array",String:1,1:"String"}),ei=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>u.__wbg_automerge_free(t>>>0)),on=class t{static __wrap(e){e=e>>>0;let n=Object.create(t.prototype);return n.__wbg_ptr=e,ei.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,ei.unregister(this),e}free(){let e=this.__destroy_into_raw();u.__wbg_automerge_free(e)}static new(e,n){try{let c=u.__wbindgen_add_to_stack_pointer(-16);var r=Q(e)?0:Fe(e,u.__wbindgen_malloc,u.__wbindgen_realloc),s=ke;u.automerge_new(c,r,s,n);var o=_()[c/4+0],i=_()[c/4+1],a=_()[c/4+2];if(a)throw v(i);return t.__wrap(o)}finally{u.__wbindgen_add_to_stack_pointer(16)}}clone(e){try{let a=u.__wbindgen_add_to_stack_pointer(-16);var n=Q(e)?0:Fe(e,u.__wbindgen_malloc,u.__wbindgen_realloc),r=ke;u.automerge_clone(a,this.__wbg_ptr,n,r);var s=_()[a/4+0],o=_()[a/4+1],i=_()[a/4+2];if(i)throw v(o);return t.__wrap(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}fork(e,n){try{let c=u.__wbindgen_add_to_stack_pointer(-16);var r=Q(e)?0:Fe(e,u.__wbindgen_malloc,u.__wbindgen_realloc),s=ke;u.automerge_fork(c,this.__wbg_ptr,r,s,b(n));var o=_()[c/4+0],i=_()[c/4+1],a=_()[c/4+2];if(a)throw v(i);return t.__wrap(o)}finally{u.__wbindgen_add_to_stack_pointer(16)}}pendingOps(){let e=u.automerge_pendingOps(this.__wbg_ptr);return v(e)}commit(e,n){var r=Q(e)?0:Fe(e,u.__wbindgen_malloc,u.__wbindgen_realloc),s=ke;let o=u.automerge_commit(this.__wbg_ptr,r,s,!Q(n),Q(n)?0:n);return v(o)}merge(e){try{let o=u.__wbindgen_add_to_stack_pointer(-16);pt(e,t),u.automerge_merge(o,this.__wbg_ptr,e.__wbg_ptr);var n=_()[o/4+0],r=_()[o/4+1],s=_()[o/4+2];if(s)throw v(r);return v(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}rollback(){return u.automerge_rollback(this.__wbg_ptr)}keys(e,n){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_keys(i,this.__wbg_ptr,b(e),Q(n)?0:b(n));var r=_()[i/4+0],s=_()[i/4+1],o=_()[i/4+2];if(o)throw v(s);return v(r)}finally{u.__wbindgen_add_to_stack_pointer(16)}}text(e,n){let r,s;try{let f=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_text(f,this.__wbg_ptr,b(e),Q(n)?0:b(n));var o=_()[f/4+0],i=_()[f/4+1],a=_()[f/4+2],c=_()[f/4+3],l=o,h=i;if(c)throw l=0,h=0,v(a);return r=l,s=h,xe(l,h)}finally{u.__wbindgen_add_to_stack_pointer(16),u.__wbindgen_free(r,s,1)}}spans(e,n){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_spans(i,this.__wbg_ptr,b(e),Q(n)?0:b(n));var r=_()[i/4+0],s=_()[i/4+1],o=_()[i/4+2];if(o)throw v(s);return v(r)}finally{u.__wbindgen_add_to_stack_pointer(16)}}splice(e,n,r,s){try{let a=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_splice(a,this.__wbg_ptr,b(e),n,r,b(s));var o=_()[a/4+0],i=_()[a/4+1];if(i)throw v(o)}finally{u.__wbindgen_add_to_stack_pointer(16)}}updateText(e,n){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_updateText(o,this.__wbg_ptr,b(e),b(n));var r=_()[o/4+0],s=_()[o/4+1];if(s)throw v(r)}finally{u.__wbindgen_add_to_stack_pointer(16)}}updateSpans(e,n){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_updateSpans(o,this.__wbg_ptr,b(e),b(n));var r=_()[o/4+0],s=_()[o/4+1];if(s)throw v(r)}finally{u.__wbindgen_add_to_stack_pointer(16)}}push(e,n,r){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_push(i,this.__wbg_ptr,b(e),b(n),b(r));var s=_()[i/4+0],o=_()[i/4+1];if(o)throw v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}pushObject(e,n){try{let a=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_pushObject(a,this.__wbg_ptr,b(e),b(n));var r=_()[a/4+0],s=_()[a/4+1],o=_()[a/4+2],i=_()[a/4+3];if(i)throw v(o);let c;return r!==0&&(c=xe(r,s).slice(),u.__wbindgen_free(r,s*1,1)),c}finally{u.__wbindgen_add_to_stack_pointer(16)}}insert(e,n,r,s){try{let a=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_insert(a,this.__wbg_ptr,b(e),n,b(r),b(s));var o=_()[a/4+0],i=_()[a/4+1];if(i)throw v(o)}finally{u.__wbindgen_add_to_stack_pointer(16)}}splitBlock(e,n,r){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_splitBlock(i,this.__wbg_ptr,b(e),n,b(r));var s=_()[i/4+0],o=_()[i/4+1];if(o)throw v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}joinBlock(e,n){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_joinBlock(o,this.__wbg_ptr,b(e),n);var r=_()[o/4+0],s=_()[o/4+1];if(s)throw v(r)}finally{u.__wbindgen_add_to_stack_pointer(16)}}updateBlock(e,n,r){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_updateBlock(i,this.__wbg_ptr,b(e),n,b(r));var s=_()[i/4+0],o=_()[i/4+1];if(o)throw v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}getBlock(e,n,r){try{let a=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_getBlock(a,this.__wbg_ptr,b(e),n,Q(r)?0:b(r));var s=_()[a/4+0],o=_()[a/4+1],i=_()[a/4+2];if(i)throw v(o);return v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}insertObject(e,n,r){try{let c=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_insertObject(c,this.__wbg_ptr,b(e),n,b(r));var s=_()[c/4+0],o=_()[c/4+1],i=_()[c/4+2],a=_()[c/4+3];if(a)throw v(i);let l;return s!==0&&(l=xe(s,o).slice(),u.__wbindgen_free(s,o*1,1)),l}finally{u.__wbindgen_add_to_stack_pointer(16)}}put(e,n,r,s){try{let a=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_put(a,this.__wbg_ptr,b(e),b(n),b(r),b(s));var o=_()[a/4+0],i=_()[a/4+1];if(i)throw v(o)}finally{u.__wbindgen_add_to_stack_pointer(16)}}putObject(e,n,r){try{let a=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_putObject(a,this.__wbg_ptr,b(e),b(n),b(r));var s=_()[a/4+0],o=_()[a/4+1],i=_()[a/4+2];if(i)throw v(o);return v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}increment(e,n,r){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_increment(i,this.__wbg_ptr,b(e),b(n),b(r));var s=_()[i/4+0],o=_()[i/4+1];if(o)throw v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}get(e,n,r){try{let a=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_get(a,this.__wbg_ptr,b(e),b(n),Q(r)?0:b(r));var s=_()[a/4+0],o=_()[a/4+1],i=_()[a/4+2];if(i)throw v(o);return v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}getWithType(e,n,r){try{let a=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_getWithType(a,this.__wbg_ptr,b(e),b(n),Q(r)?0:b(r));var s=_()[a/4+0],o=_()[a/4+1],i=_()[a/4+2];if(i)throw v(o);return v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}objInfo(e,n){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_objInfo(i,this.__wbg_ptr,b(e),Q(n)?0:b(n));var r=_()[i/4+0],s=_()[i/4+1],o=_()[i/4+2];if(o)throw v(s);return v(r)}finally{u.__wbindgen_add_to_stack_pointer(16)}}getAll(e,n,r){try{let a=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_getAll(a,this.__wbg_ptr,b(e),b(n),Q(r)?0:b(r));var s=_()[a/4+0],o=_()[a/4+1],i=_()[a/4+2];if(i)throw v(o);return v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}enableFreeze(e){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_enableFreeze(o,this.__wbg_ptr,b(e));var n=_()[o/4+0],r=_()[o/4+1],s=_()[o/4+2];if(s)throw v(r);return v(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}registerDatatype(e,n,r){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_registerDatatype(i,this.__wbg_ptr,b(e),b(n),b(r));var s=_()[i/4+0],o=_()[i/4+1];if(o)throw v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}applyPatches(e,n){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_applyPatches(i,this.__wbg_ptr,b(e),b(n));var r=_()[i/4+0],s=_()[i/4+1],o=_()[i/4+2];if(o)throw v(s);return v(r)}finally{u.__wbindgen_add_to_stack_pointer(16)}}applyAndReturnPatches(e,n){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_applyAndReturnPatches(i,this.__wbg_ptr,b(e),b(n));var r=_()[i/4+0],s=_()[i/4+1],o=_()[i/4+2];if(o)throw v(s);return v(r)}finally{u.__wbindgen_add_to_stack_pointer(16)}}diffIncremental(){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_diffIncremental(s,this.__wbg_ptr);var e=_()[s/4+0],n=_()[s/4+1],r=_()[s/4+2];if(r)throw v(n);return v(e)}finally{u.__wbindgen_add_to_stack_pointer(16)}}updateDiffCursor(){u.automerge_updateDiffCursor(this.__wbg_ptr)}resetDiffCursor(){u.automerge_resetDiffCursor(this.__wbg_ptr)}diff(e,n){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_diff(i,this.__wbg_ptr,b(e),b(n));var r=_()[i/4+0],s=_()[i/4+1],o=_()[i/4+2];if(o)throw v(s);return v(r)}finally{u.__wbindgen_add_to_stack_pointer(16)}}isolate(e){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_isolate(s,this.__wbg_ptr,b(e));var n=_()[s/4+0],r=_()[s/4+1];if(r)throw v(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}integrate(){u.automerge_integrate(this.__wbg_ptr)}length(e,n){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_length(i,this.__wbg_ptr,b(e),Q(n)?0:b(n));var r=nr()[i/8+0],s=_()[i/4+2],o=_()[i/4+3];if(o)throw v(s);return r}finally{u.__wbindgen_add_to_stack_pointer(16)}}delete(e,n){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_delete(o,this.__wbg_ptr,b(e),b(n));var r=_()[o/4+0],s=_()[o/4+1];if(s)throw v(r)}finally{u.__wbindgen_add_to_stack_pointer(16)}}save(){let e=u.automerge_save(this.__wbg_ptr);return v(e)}saveIncremental(){let e=u.automerge_saveIncremental(this.__wbg_ptr);return v(e)}saveSince(e){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_saveSince(o,this.__wbg_ptr,b(e));var n=_()[o/4+0],r=_()[o/4+1],s=_()[o/4+2];if(s)throw v(r);return v(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}saveNoCompress(){let e=u.automerge_saveNoCompress(this.__wbg_ptr);return v(e)}saveAndVerify(){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_saveAndVerify(s,this.__wbg_ptr);var e=_()[s/4+0],n=_()[s/4+1],r=_()[s/4+2];if(r)throw v(n);return v(e)}finally{u.__wbindgen_add_to_stack_pointer(16)}}loadIncremental(e){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_loadIncremental(o,this.__wbg_ptr,b(e));var n=nr()[o/8+0],r=_()[o/4+2],s=_()[o/4+3];if(s)throw v(r);return n}finally{u.__wbindgen_add_to_stack_pointer(16)}}applyChanges(e){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_applyChanges(s,this.__wbg_ptr,b(e));var n=_()[s/4+0],r=_()[s/4+1];if(r)throw v(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}getChanges(e){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_getChanges(o,this.__wbg_ptr,b(e));var n=_()[o/4+0],r=_()[o/4+1],s=_()[o/4+2];if(s)throw v(r);return v(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}getChangeByHash(e){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_getChangeByHash(o,this.__wbg_ptr,b(e));var n=_()[o/4+0],r=_()[o/4+1],s=_()[o/4+2];if(s)throw v(r);return v(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}getDecodedChangeByHash(e){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_getDecodedChangeByHash(o,this.__wbg_ptr,b(e));var n=_()[o/4+0],r=_()[o/4+1],s=_()[o/4+2];if(s)throw v(r);return v(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}getChangesAdded(e){pt(e,t);let n=u.automerge_getChangesAdded(this.__wbg_ptr,e.__wbg_ptr);return v(n)}getHeads(){let e=u.automerge_getHeads(this.__wbg_ptr);return v(e)}getActorId(){let e,n;try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_getActorId(o,this.__wbg_ptr);var r=_()[o/4+0],s=_()[o/4+1];return e=r,n=s,xe(r,s)}finally{u.__wbindgen_add_to_stack_pointer(16),u.__wbindgen_free(e,n,1)}}getLastLocalChange(){let e=u.automerge_getLastLocalChange(this.__wbg_ptr);return v(e)}dump(){u.automerge_dump(this.__wbg_ptr)}getMissingDeps(e){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_getMissingDeps(o,this.__wbg_ptr,Q(e)?0:b(e));var n=_()[o/4+0],r=_()[o/4+1],s=_()[o/4+2];if(s)throw v(r);return v(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}receiveSyncMessage(e,n){try{let o=u.__wbindgen_add_to_stack_pointer(-16);pt(e,je),u.automerge_receiveSyncMessage(o,this.__wbg_ptr,e.__wbg_ptr,b(n));var r=_()[o/4+0],s=_()[o/4+1];if(s)throw v(r)}finally{u.__wbindgen_add_to_stack_pointer(16)}}generateSyncMessage(e){pt(e,je);let n=u.automerge_generateSyncMessage(this.__wbg_ptr,e.__wbg_ptr);return v(n)}toJS(e){try{let o=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_toJS(o,this.__wbg_ptr,b(e));var n=_()[o/4+0],r=_()[o/4+1],s=_()[o/4+2];if(s)throw v(r);return v(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}materialize(e,n,r){try{let a=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_materialize(a,this.__wbg_ptr,b(e),Q(n)?0:b(n),b(r));var s=_()[a/4+0],o=_()[a/4+1],i=_()[a/4+2];if(i)throw v(o);return v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}getCursor(e,n,r){let s,o;try{let d=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_getCursor(d,this.__wbg_ptr,b(e),n,Q(r)?0:b(r));var i=_()[d/4+0],a=_()[d/4+1],c=_()[d/4+2],l=_()[d/4+3],h=i,f=a;if(l)throw h=0,f=0,v(c);return s=h,o=f,xe(h,f)}finally{u.__wbindgen_add_to_stack_pointer(16),u.__wbindgen_free(s,o,1)}}getCursorPosition(e,n,r){try{let a=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_getCursorPosition(a,this.__wbg_ptr,b(e),b(n),Q(r)?0:b(r));var s=nr()[a/8+0],o=_()[a/4+2],i=_()[a/4+3];if(i)throw v(o);return s}finally{u.__wbindgen_add_to_stack_pointer(16)}}emptyChange(e,n){var r=Q(e)?0:Fe(e,u.__wbindgen_malloc,u.__wbindgen_realloc),s=ke;let o=u.automerge_emptyChange(this.__wbg_ptr,r,s,!Q(n),Q(n)?0:n);return v(o)}mark(e,n,r,s,o){try{let c=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_mark(c,this.__wbg_ptr,b(e),b(n),b(r),b(s),b(o));var i=_()[c/4+0],a=_()[c/4+1];if(a)throw v(i)}finally{u.__wbindgen_add_to_stack_pointer(16)}}unmark(e,n,r){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_unmark(i,this.__wbg_ptr,b(e),b(n),b(r));var s=_()[i/4+0],o=_()[i/4+1];if(o)throw v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}marks(e,n){try{let i=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_marks(i,this.__wbg_ptr,b(e),Q(n)?0:b(n));var r=_()[i/4+0],s=_()[i/4+1],o=_()[i/4+2];if(o)throw v(s);return v(r)}finally{u.__wbindgen_add_to_stack_pointer(16)}}marksAt(e,n,r){try{let a=u.__wbindgen_add_to_stack_pointer(-16);u.automerge_marksAt(a,this.__wbg_ptr,b(e),n,Q(r)?0:b(r));var s=_()[a/4+0],o=_()[a/4+1],i=_()[a/4+2];if(i)throw v(o);return v(s)}finally{u.__wbindgen_add_to_stack_pointer(16)}}hasOurChanges(e){pt(e,je);let n=u.automerge_hasOurChanges(this.__wbg_ptr,e.__wbg_ptr);return v(n)}topoHistoryTraversal(){let e=u.automerge_topoHistoryTraversal(this.__wbg_ptr);return v(e)}stats(){let e=u.automerge_stats(this.__wbg_ptr);return v(e)}},ti=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>u.__wbg_syncstate_free(t>>>0)),je=class t{static __wrap(e){e=e>>>0;let n=Object.create(t.prototype);return n.__wbg_ptr=e,ti.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,ti.unregister(this),e}free(){let e=this.__destroy_into_raw();u.__wbg_syncstate_free(e)}get sharedHeads(){let e=u.syncstate_sharedHeads(this.__wbg_ptr);return v(e)}get lastSentHeads(){let e=u.syncstate_lastSentHeads(this.__wbg_ptr);return v(e)}set lastSentHeads(e){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.syncstate_set_lastSentHeads(s,this.__wbg_ptr,b(e));var n=_()[s/4+0],r=_()[s/4+1];if(r)throw v(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}set sentHashes(e){try{let s=u.__wbindgen_add_to_stack_pointer(-16);u.syncstate_set_sentHashes(s,this.__wbg_ptr,b(e));var n=_()[s/4+0],r=_()[s/4+1];if(r)throw v(n)}finally{u.__wbindgen_add_to_stack_pointer(16)}}clone(){let e=u.syncstate_clone(this.__wbg_ptr);return t.__wrap(e)}};async function qc(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}let n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{let n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function ri(){let t={};return t.wbg={},t.wbg.__wbindgen_object_drop_ref=function(e){v(e)},t.wbg.__wbindgen_string_get=function(e,n){let r=I(n),s=typeof r=="string"?r:void 0;var o=Q(s)?0:Fe(s,u.__wbindgen_malloc,u.__wbindgen_realloc),i=ke;_()[e/4+1]=i,_()[e/4+0]=o},t.wbg.__wbindgen_error_new=function(e,n){let r=new Error(xe(e,n));return b(r)},t.wbg.__wbindgen_string_new=function(e,n){let r=xe(e,n);return b(r)},t.wbg.__wbindgen_number_new=function(e){return b(e)},t.wbg.__wbindgen_object_clone_ref=function(e){let n=I(e);return b(n)},t.wbg.__wbindgen_number_get=function(e,n){let r=I(n),s=typeof r=="number"?r:void 0;nr()[e/8+1]=Q(s)?0:s,_()[e/4+0]=!Q(s)},t.wbg.__wbindgen_is_undefined=function(e){return I(e)===void 0},t.wbg.__wbindgen_boolean_get=function(e){let n=I(e);return typeof n=="boolean"?n?1:0:2},t.wbg.__wbindgen_is_null=function(e){return I(e)===null},t.wbg.__wbindgen_is_string=function(e){return typeof I(e)=="string"},t.wbg.__wbindgen_is_function=function(e){return typeof I(e)=="function"},t.wbg.__wbindgen_is_object=function(e){let n=I(e);return typeof n=="object"&&n!==null},t.wbg.__wbindgen_is_array=function(e){return Array.isArray(I(e))},t.wbg.__wbindgen_json_serialize=function(e,n){let r=I(n),s=JSON.stringify(r===void 0?null:r),o=Fe(s,u.__wbindgen_malloc,u.__wbindgen_realloc),i=ke;_()[e/4+1]=i,_()[e/4+0]=o},t.wbg.__wbg_new_abda76e883ba8a5f=function(){let e=new Error;return b(e)},t.wbg.__wbg_stack_658279fe44541cf6=function(e,n){let r=I(n).stack,s=Fe(r,u.__wbindgen_malloc,u.__wbindgen_realloc),o=ke;_()[e/4+1]=o,_()[e/4+0]=s},t.wbg.__wbg_error_f851667af71bcfc6=function(e,n){let r,s;try{r=e,s=n,console.error(xe(e,n))}finally{u.__wbindgen_free(r,s,1)}},t.wbg.__wbindgen_jsval_loose_eq=function(e,n){return I(e)==I(n)},t.wbg.__wbg_String_91fba7ded13ba54c=function(e,n){let r=String(I(n)),s=Fe(r,u.__wbindgen_malloc,u.__wbindgen_realloc),o=ke;_()[e/4+1]=o,_()[e/4+0]=s},t.wbg.__wbindgen_bigint_from_i64=function(e){return b(e)},t.wbg.__wbindgen_bigint_from_u64=function(e){let n=BigInt.asUintN(64,e);return b(n)},t.wbg.__wbg_set_20cbc34131e76824=function(e,n,r){I(e)[v(n)]=v(r)},t.wbg.__wbg_getRandomValues_3aa56aa6edec874c=function(){return he(function(e,n){I(e).getRandomValues(I(n))},arguments)},t.wbg.__wbg_randomFillSync_5c9c955aa56b6049=function(){return he(function(e,n){I(e).randomFillSync(v(n))},arguments)},t.wbg.__wbg_crypto_1d1f22824a6a080c=function(e){let n=I(e).crypto;return b(n)},t.wbg.__wbg_process_4a72847cc503995b=function(e){let n=I(e).process;return b(n)},t.wbg.__wbg_versions_f686565e586dd935=function(e){let n=I(e).versions;return b(n)},t.wbg.__wbg_node_104a2ff8d6ea03a2=function(e){let n=I(e).node;return b(n)},t.wbg.__wbg_require_cca90b1a94a0255b=function(){return he(function(){let e=module.require;return b(e)},arguments)},t.wbg.__wbg_msCrypto_eb05e62b530a1508=function(e){let n=I(e).msCrypto;return b(n)},t.wbg.__wbg_log_5bb5f88f245d7762=function(e){console.log(I(e))},t.wbg.__wbg_log_1746d5c75ec89963=function(e,n){console.log(I(e),I(n))},t.wbg.__wbg_get_bd8e338fbd5f5cc8=function(e,n){let r=I(e)[n>>>0];return b(r)},t.wbg.__wbg_length_cd7af8117672b8b8=function(e){return I(e).length},t.wbg.__wbg_new_16b304a2cfa7ff4a=function(){let e=new Array;return b(e)},t.wbg.__wbg_newnoargs_e258087cd0daa0ea=function(e,n){let r=new Function(xe(e,n));return b(r)},t.wbg.__wbg_next_40fc327bfc8770e6=function(e){let n=I(e).next;return b(n)},t.wbg.__wbg_next_196c84450b364254=function(){return he(function(e){let n=I(e).next();return b(n)},arguments)},t.wbg.__wbg_done_298b57d23c0fc80c=function(e){return I(e).done},t.wbg.__wbg_value_d93c65011f51a456=function(e){let n=I(e).value;return b(n)},t.wbg.__wbg_iterator_2cee6dadfd956dfa=function(){return b(Symbol.iterator)},t.wbg.__wbg_get_e3c254076557e348=function(){return he(function(e,n){let r=Reflect.get(I(e),I(n));return b(r)},arguments)},t.wbg.__wbg_call_27c0f87801dedf93=function(){return he(function(e,n){let r=I(e).call(I(n));return b(r)},arguments)},t.wbg.__wbg_new_72fb9a18b5ae2624=function(){let e=new Object;return b(e)},t.wbg.__wbg_length_dee433d4c85c9387=function(e){return I(e).length},t.wbg.__wbg_set_d4638f722068f043=function(e,n,r){I(e)[n>>>0]=v(r)},t.wbg.__wbg_from_89e3fc3ba5e6fb48=function(e){let n=Array.from(I(e));return b(n)},t.wbg.__wbg_isArray_2ab64d95e09ea0ae=function(e){return Array.isArray(I(e))},t.wbg.__wbg_push_a5b05aedc7234f9f=function(e,n){return I(e).push(I(n))},t.wbg.__wbg_unshift_e22df4b34bcf5070=function(e,n){return I(e).unshift(I(n))},t.wbg.__wbg_instanceof_ArrayBuffer_836825be07d4c9d2=function(e){let n;try{n=I(e)instanceof ArrayBuffer}catch{n=!1}return n},t.wbg.__wbg_new_28c511d9baebfa89=function(e,n){let r=new Error(xe(e,n));return b(r)},t.wbg.__wbg_call_b3ca7c6051f9bec1=function(){return he(function(e,n,r){let s=I(e).call(I(n),I(r));return b(s)},arguments)},t.wbg.__wbg_instanceof_Date_f65cf97fb83fc369=function(e){let n;try{n=I(e)instanceof Date}catch{n=!1}return n},t.wbg.__wbg_getTime_2bc4375165f02d15=function(e){return I(e).getTime()},t.wbg.__wbg_new_cf3ec55744a78578=function(e){let n=new Date(I(e));return b(n)},t.wbg.__wbg_instanceof_Object_71ca3c0a59266746=function(e){let n;try{n=I(e)instanceof Object}catch{n=!1}return n},t.wbg.__wbg_assign_496d2d14fecafbcf=function(e,n){let r=Object.assign(I(e),I(n));return b(r)},t.wbg.__wbg_defineProperty_cc00e2de8a0f5141=function(e,n,r){let s=Object.defineProperty(I(e),I(n),I(r));return b(s)},t.wbg.__wbg_entries_95cc2c823b285a09=function(e){let n=Object.entries(I(e));return b(n)},t.wbg.__wbg_freeze_cc6bc19f75299986=function(e){let n=Object.freeze(I(e));return b(n)},t.wbg.__wbg_keys_91e412b4b222659f=function(e){let n=Object.keys(I(e));return b(n)},t.wbg.__wbg_values_9c75e6e2bfbdb70d=function(e){let n=Object.values(I(e));return b(n)},t.wbg.__wbg_new_dd6a5dd7b538af21=function(e,n){let r=new RangeError(xe(e,n));return b(r)},t.wbg.__wbg_apply_0a5aa603881e6d79=function(){return he(function(e,n,r){let s=Reflect.apply(I(e),I(n),I(r));return b(s)},arguments)},t.wbg.__wbg_deleteProperty_13e721a56f19e842=function(){return he(function(e,n){return Reflect.deleteProperty(I(e),I(n))},arguments)},t.wbg.__wbg_ownKeys_658942b7f28d1fe9=function(){return he(function(e){let n=Reflect.ownKeys(I(e));return b(n)},arguments)},t.wbg.__wbg_set_1f9b04f170055d33=function(){return he(function(e,n,r){return Reflect.set(I(e),I(n),I(r))},arguments)},t.wbg.__wbg_buffer_12d079cc21e14bdb=function(e){let n=I(e).buffer;return b(n)},t.wbg.__wbg_concat_3de229fe4fe90fea=function(e,n){let r=I(e).concat(I(n));return b(r)},t.wbg.__wbg_slice_52fb626ffdc8da8f=function(e,n,r){let s=I(e).slice(n>>>0,r>>>0);return b(s)},t.wbg.__wbg_for_27c67e2dbdce22f6=function(e,n){let r=Symbol.for(xe(e,n));return b(r)},t.wbg.__wbg_toString_7df3c77999517c20=function(e){let n=I(e).toString();return b(n)},t.wbg.__wbg_self_ce0dbfc45cf2f5be=function(){return he(function(){let e=self.self;return b(e)},arguments)},t.wbg.__wbg_window_c6fb939a7f436783=function(){return he(function(){let e=window.window;return b(e)},arguments)},t.wbg.__wbg_globalThis_d1e6af4856ba331b=function(){return he(function(){let e=globalThis.globalThis;return b(e)},arguments)},t.wbg.__wbg_global_207b558942527489=function(){return he(function(){let e=__global$.global;return b(e)},arguments)},t.wbg.__wbg_newwithbyteoffsetandlength_aa4a17c33a06e5cb=function(e,n,r){let s=new Uint8Array(I(e),n>>>0,r>>>0);return b(s)},t.wbg.__wbg_new_63b92bc8671ed464=function(e){let n=new Uint8Array(I(e));return b(n)},t.wbg.__wbg_set_a47bac70306a19a7=function(e,n,r){I(e).set(I(n),r>>>0)},t.wbg.__wbg_length_c20a40f15020d68a=function(e){return I(e).length},t.wbg.__wbg_instanceof_Uint8Array_2b3bbecd033d19f6=function(e){let n;try{n=I(e)instanceof Uint8Array}catch{n=!1}return n},t.wbg.__wbg_newwithlength_e9b4878cebadb3d3=function(e){let n=new Uint8Array(e>>>0);return b(n)},t.wbg.__wbg_subarray_a1f73cd4b5b42fe1=function(e,n,r){let s=I(e).subarray(n>>>0,r>>>0);return b(s)},t.wbg.__wbindgen_debug_string=function(e,n){let r=fs(I(n)),s=Fe(r,u.__wbindgen_malloc,u.__wbindgen_realloc),o=ke;_()[e/4+1]=o,_()[e/4+0]=s},t.wbg.__wbindgen_throw=function(e,n){throw new Error(xe(e,n))},t.wbg.__wbindgen_memory=function(){let e=u.memory;return b(e)},t}function si(t,e){return u=t.exports,oi.__wbindgen_wasm_module=e,rn=null,nn=null,tn=null,u}function Jc(t){if(u!==void 0)return u;let e=ri();t instanceof WebAssembly.Module||(t=new WebAssembly.Module(t));let n=new WebAssembly.Instance(t,e);return si(n,t)}async function oi(t){if(u!==void 0)return u;typeof t>"u"&&(t=new URL("automerge_wasm_bg.wasm",import.meta.url));let e=ri();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));let{instance:n,module:r}=await qc(await t,e);return si(n,r)}var us=oi;var ds=!1,ii=[];function hs(t){for(let e in t)se[e]=t[e];ds=!0;for(let e of ii)e()}var se={create(t){throw new RangeError("Automerge.use() not called")},load(t,e){throw new RangeError("Automerge.use() not called (load)")},encodeChange(t){throw new RangeError("Automerge.use() not called (encodeChange)")},decodeChange(t){throw new RangeError("Automerge.use() not called (decodeChange)")},initSyncState(){throw new RangeError("Automerge.use() not called (initSyncState)")},encodeSyncMessage(t){throw new RangeError("Automerge.use() not called (encodeSyncMessage)")},decodeSyncMessage(t){throw new RangeError("Automerge.use() not called (decodeSyncMessage)")},encodeSyncState(t){throw new RangeError("Automerge.use() not called (encodeSyncState)")},decodeSyncState(t){throw new RangeError("Automerge.use() not called (decodeSyncState)")},exportSyncState(t){throw new RangeError("Automerge.use() not called (exportSyncState)")},importSyncState(t){throw new RangeError("Automerge.use() not called (importSyncState)")}};function Tt(t){return us(t).then(e=>{hs(ls)})}function an(t){return Tt(Uint8Array.from(atob(t),e=>e.charCodeAt(0)))}function rr(){return ds?Promise.resolve():new Promise(t=>{ii.push(t)})}function sr(){return ds}function B(t,e=!0){if(typeof t!="object")throw new RangeError("must be the document root");let n=Reflect.get(t,we);if(n===void 0||n==null||e&&nt(t)!=="_root")throw new RangeError("must be the document root");return n}function gt(t){Reflect.set(t,Qt,!0)}function or(t){return Reflect.get(t,Xe)}function nt(t){return typeof t!="object"||t===null?null:Reflect.get(t,Ye)}function ae(t){return!!Reflect.get(t,It)}var Kc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n},xh=Symbol("_syncstate");function ir(t,e,...n){if(!ae(t))throw new RangeError("object cannot be modified outside of a change block");t.insertAt(e,...n)}function ar(t,e,n){if(!ae(t))throw new RangeError("object cannot be modified outside of a change block");t.deleteAt(e,n)}function Gc(t){hs(t)}function ps(t){return B(t).handle}function gs(t){return typeof t=="object"?t:{actor:t}}function Rt(t){let e=gs(t),n=!!e.freeze,r=e.patchCallback,s=!e.enableTextV2,o=e.actor,i=se.create({actor:o,text_v1:s});i.enableFreeze(!!e.freeze);let a=e.enableTextV2||!1;return fi(i,a),i.materialize("/",void 0,{handle:i,heads:void 0,freeze:n,patchCallback:r,textV2:a})}function Mt(t,e){let n=B(t),r=n.handle;return n.handle.materialize("/",e,Object.assign(Object.assign({},n),{handle:r,heads:e}))}function _s(t,e){let n=B(t),r=n.heads,s=gs(e),o=n.handle.fork(s.actor,r);o.updateDiffCursor();let{heads:i}=n,a=Kc(n,["heads"]);return a.patchCallback=s.patchCallback,o.applyPatches(t,Object.assign(Object.assign({},a),{handle:o}))}function ys(t){return B(t).handle.free()}function ms(t,e){return cn(Rt(e),"from",{},n=>Object.assign(n,t)).newDoc}function fn(t,e,n){if(typeof e=="function")return cn(t,"change",{},e).newDoc;if(typeof n=="function")return typeof e=="string"&&(e={message:e}),cn(t,"change",e,n).newDoc;throw RangeError("Invalid args for change")}function un(t,e,n,r){if(typeof n=="function")return cn(t,"changeAt",{},n,e);if(typeof r=="function")return typeof n=="string"&&(n={message:n}),cn(t,"changeAt",n,r,e);throw RangeError("Invalid args for changeAt")}function Ut(t,e,n,r){if(n==null)return t;let s=B(t),o=Object.assign(Object.assign({},s),{heads:void 0}),{value:i,patches:a}=s.handle.applyAndReturnPatches(t,o);if(a.length>0){r?.(a,{before:t,after:i,source:e});let c=B(i);c.mostRecentPatch={before:B(t).heads,after:c.handle.getHeads(),patches:a}}return s.heads=n,i}function cn(t,e,n,r,s){if(typeof r!="function")throw new RangeError("invalid change function");let o=B(t);if(t===void 0||o===void 0)throw new RangeError("must be the document root");if(o.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(ae(t))throw new RangeError("Calls to Automerge.change cannot be nested");let i=o.handle.getHeads();s&&Yc(s,i)&&(s=void 0),s&&(o.handle.isolate(s),i=s),"time"in n||(n.time=Math.floor(Date.now()/1e3));try{o.heads=i;let a=Jo(o.handle,o.textV2);if(r(a),o.handle.pendingOps()===0)return o.heads=void 0,s&&o.handle.integrate(),{newDoc:t,newHeads:null};{let c=o.handle.commit(n.message,n.time);return o.handle.integrate(),{newDoc:Ut(t,e,i,n.patchCallback||o.patchCallback),newHeads:c!=null?[c]:null}}}catch(a){throw o.heads=void 0,o.handle.rollback(),a}}function bs(t,e){e===void 0&&(e={}),typeof e=="string"&&(e={message:e}),"time"in e||(e.time=Math.floor(Date.now()/1e3));let n=B(t);if(n.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(ae(t))throw new RangeError("Calls to Automerge.change cannot be nested");let r=n.handle.getHeads();return n.handle.emptyChange(e.message,e.time),Ut(t,"emptyChange",r)}function ws(t,e){let n=gs(e),r=n.actor,s=n.patchCallback,o=!n.enableTextV2,i=n.unchecked||!1,a=n.allowMissingChanges||!1,c=n.convertRawStringsToText||!1,l=se.load(t,{text_v1:o,actor:r,unchecked:i,allowMissingDeps:a,convertRawStringsToText:c});l.enableFreeze(!!n.freeze);let h=n.enableTextV2||!1;return fi(l,h),l.materialize("/",void 0,{handle:l,heads:void 0,patchCallback:s,textV2:h})}function _t(t,e,n){n||(n={});let r=B(t);if(r.heads)throw new RangeError("Attempting to change an out of date document - set at: "+or(t));if(ae(t))throw new RangeError("Calls to Automerge.change cannot be nested");let s=r.handle.getHeads();return r.handle.loadIncremental(e),Ut(t,"loadIncremental",s,n.patchCallback||r.patchCallback)}function xs(t){let e=B(t);if(e.heads)throw new RangeError("Attempting to change an out of date document - set at: "+or(t));if(ae(t))throw new RangeError("Calls to Automerge.change cannot be nested");return e.handle.saveIncremental()}function ln(t){return B(t).handle.save()}function dn(t,e){let n=B(t);if(n.heads)throw new RangeError("Attempting to change an out of date document - set at: "+or(t));let r=n.handle.getHeads(),s=B(e),o=n.handle.getChangesAdded(s.handle);return n.handle.applyChanges(o),Ut(t,"merge",r,n.patchCallback)}function vs(t){return B(t).handle.getActorId()}function Xc(t,e){let n=B(t,!1);if(n.textV2)throw new Error("use unstable.getConflicts for an unstable document");let r=nt(t);if(r!=null)return Ko(n.handle,r,e)}function Ss(t){return B(t).handle.getLastLocalChange()||void 0}function cr(t,e){if(e){let n=B(t,!1),r=nt(t);return!n||!r?null:n.handle.get(r,e)}else return nt(t)}function fr(t,e){return B(e).handle.getChanges(ue(t))}function hn(t){return B(t).handle.getChanges([])}function pn(t,e,n){let r=B(t);if(n||(n={}),r.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(ae(t))throw new RangeError("Calls to Automerge.change cannot be nested");let s=r.handle.getHeads();return r.handle.applyChanges(e),r.heads=s,[Ut(t,"applyChanges",s,n.patchCallback||r.patchCallback)]}function As(t){let e=B(t).textV2,n=hn(t);return n.map((r,s)=>({get change(){return ur(r)},get snapshot(){let[o]=pn(Rt({enableTextV2:e}),n.slice(0,s+1));return o}}))}function jt(t,e,n){ai(e,"before"),ai(n,"after");let r=B(t);return r.mostRecentPatch&&Ot(r.mostRecentPatch.before,e)&&Ot(r.mostRecentPatch.after,n)?r.mostRecentPatch.patches:r.handle.diff(e,n)}function Yc(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function ai(t,e){if(!Array.isArray(t))throw new Error(`${e} must be an array`)}function Ot(t,e){if(!ci(t)||!ci(e))return t===e;let n=Object.keys(t).sort(),r=Object.keys(e).sort();if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s]!==r[s]||!Ot(t[n[s]],e[r[s]]))return!1;return!0}function yt(t){let e=se.importSyncState(t),n=se.encodeSyncState(e);return e.free(),n}function mt(t){let e=se.decodeSyncState(t),n=se.exportSyncState(e);return e.free(),n}function gn(t,e){let n=B(t),r=se.importSyncState(e),s=n.handle.generateSyncMessage(r);return[se.exportSyncState(r),s]}function _n(t,e,n,r){let s=se.importSyncState(e);r||(r={});let o=B(t);if(o.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(ae(t))throw new RangeError("Calls to Automerge.change cannot be nested");let i=o.handle.getHeads();o.handle.receiveSyncMessage(s,n);let a=se.exportSyncState(s);return[Ut(t,"receiveSyncMessage",i,r.patchCallback||o.patchCallback),a,null]}function Es(t,e){let n=B(t),r=se.importSyncState(e);return n.handle.hasOurChanges(r)}function yn(){return se.exportSyncState(se.initSyncState())}function ks(t){return se.encodeChange(t)}function ur(t){return se.decodeChange(t)}function Is(t){return se.encodeSyncMessage(t)}function mn(t){return se.decodeSyncMessage(t)}function Cs(t,e){return B(t).handle.getMissingDeps(e)}function ue(t){let e=B(t);return e.heads||e.handle.getHeads()}function Ts(t){B(t).handle.dump()}function Os(t){let e=B(t),n=e.handle.enableFreeze(!1),r=e.handle.materialize();return e.handle.enableFreeze(n),r}function Rs(t){return typeof t=="object"&&t!==null?cr(t)==="_root"&&!!Reflect.get(t,we):!1}function ci(t){return typeof t=="object"&&t!==null}function bn(t,e){return B(t).handle.saveSince(e)}function Ms(t,e){let n=B(t);for(let r of e)if(!n.handle.getChangeByHash(r))return!1;return!0}function fi(t,e){t.registerDatatype("counter",n=>new de(n),n=>{if(n instanceof de)return n.value}),e?t.registerDatatype("str",n=>new Ue(n),n=>{if(n instanceof Ue)return n.val}):t.registerDatatype("text",n=>new ye(n),n=>{if(n instanceof ye)return n.join("")})}function wn(t){return B(t).handle.topoHistoryTraversal()}function xn(t,e){return B(t).handle.getDecodedChangeByHash(e)}function vn(t){return B(t).handle.stats()}var Qc=ps;function Ve(t){let e=lr(t);return e.enableTextV2=!0,Rt(e)}function ef(t,e){let n=lr(e);return n.enableTextV2=!0,_s(t,n)}function tf(t,e){let n=lr(e);return n.enableTextV2=!0,ms(t,n)}function nf(t,e){let n=lr(e);return n.enableTextV2=!0,n.patchCallback?_t(Rt(n),t):ws(t,n)}function lr(t){return typeof t=="object"?t:{actor:t}}function Sn(t,e,n){if(typeof n=="string"){if(/^[0-9]+@[0-9a-zA-z]+$/.test(n))return t.handle.getCursorPosition(e,n);throw new RangeError("index must be a number or cursor")}else return n}function ui(t,e,n,r,s){let o=me(t,e,"splice");if(!ae(t))throw new RangeError("object cannot be modified outside of a change block");let i=B(t,!1);gt(t),n=Sn(i,o,n);try{return i.handle.splice(o,n,r,s)}catch(a){throw new RangeError(`Cannot splice: ${a}`)}}function li(t,e,n){let r=me(t,e,"updateText");if(!ae(t))throw new RangeError("object cannot be modified outside of a change block");let s=B(t,!1);gt(t);try{return s.handle.updateText(r,n)}catch(o){throw new RangeError(`Cannot updateText: ${o}`)}}function rf(t,e){let n=B(t,!1),r=me(t,e,"spans");try{return n.handle.spans(r,n.heads)}catch(s){throw new RangeError(`Cannot splice: ${s}`)}}function sf(t,e,n){let r=me(t,e,"splitBlock"),s=B(t,!1);n=Sn(s,r,n);try{return s.handle.getBlock(r,n)}catch(o){throw new RangeError(`Cannot get block: ${o}`)}}function of(t,e,n,r){if(!ae(t))throw new RangeError("object cannot be modified outside of a change block");let s=me(t,e,"splitBlock"),o=B(t,!1);gt(t),n=Sn(o,s,n);try{o.handle.splitBlock(s,n,r)}catch(i){throw new RangeError(`Cannot splice: ${i}`)}}function af(t,e,n){if(!ae(t))throw new RangeError("object cannot be modified outside of a change block");let r=me(t,e,"joinBlock"),s=B(t,!1);gt(t),n=Sn(s,r,n);try{s.handle.joinBlock(r,n)}catch(o){throw new RangeError(`Cannot joinBlock: ${o}`)}}function cf(t,e,n,r){if(!ae(t))throw new RangeError("object cannot be modified outside of a change block");let s=me(t,e,"updateBlock"),o=B(t,!1);gt(t),n=Sn(o,s,n);try{o.handle.updateBlock(s,n,r)}catch(i){throw new RangeError(`Cannot updateBlock: ${i}`)}}function ff(t,e,n){if(!ae(t))throw new RangeError("object cannot be modified outside of a change block");let r=me(t,e,"updateSpans"),s=B(t,!1);gt(t);try{s.handle.updateSpans(r,n)}catch(o){throw new RangeError(`Cannot updateBlock: ${o}`)}}function di(t,e,n){let r=me(t,e,"getCursor"),s=B(t,!1);try{return s.handle.getCursor(r,n)}catch(o){throw new RangeError(`Cannot getCursor: ${o}`)}}function hi(t,e,n){let r=me(t,e,"getCursorPosition"),s=B(t,!1);try{return s.handle.getCursorPosition(r,n)}catch(o){throw new RangeError(`Cannot getCursorPosition: ${o}`)}}function pi(t,e,n,r,s){let o=me(t,e,"mark");if(!ae(t))throw new RangeError("object cannot be modified outside of a change block");let i=B(t,!1);try{return i.handle.mark(o,n,r,s)}catch(a){throw new RangeError(`Cannot mark: ${a}`)}}function gi(t,e,n,r){let s=me(t,e,"unmark");if(!ae(t))throw new RangeError("object cannot be modified outside of a change block");let o=B(t,!1);try{return o.handle.unmark(s,n,r)}catch(i){throw new RangeError(`Cannot unmark: ${i}`)}}function uf(t,e){let n=me(t,e,"marks"),r=B(t,!1);try{return r.handle.marks(n)}catch(s){throw new RangeError(`Cannot call marks(): ${s}`)}}function lf(t,e,n){let r=me(t,e,"marksAt"),s=B(t,!1);try{return s.handle.marksAt(r,n)}catch(o){throw new RangeError(`Cannot call marksAt(): ${o}`)}}function _i(t,e){let n=B(t,!1);if(!n.textV2)throw new Error("use getConflicts for a stable document");let r=nt(t);if(r!=null)return Go(n.handle,r,e)}function me(t,e,n){e=e.slice();let r=nt(t);if(!r)throw new RangeError(`invalid object for ${n}`);return e.unshift(r),e.join("/")}var sc=Me(rt(),1);var Se=Me(vi(),1);var P=Me(ga(),1);var co=Me(ja(),1),fo="automerge:",Un=t=>{let e=new RegExp(`^${fo}(\\w+)$`),[,n]=t.match(e)||[],r=n,s=Pa(r);if(!s)throw new Error("Invalid document URL: "+t);return{binaryDocumentId:s,documentId:r}},Jt=t=>{let e=t instanceof Uint8Array||typeof t=="string"?t:"documentId"in t?t.documentId:void 0,n=e instanceof Uint8Array?ao(e):typeof e=="string"?e:void 0;if(n===void 0)throw new Error("Invalid documentId: "+e);return fo+n},Da=t=>{if(typeof t!="string"||!t||!t.startsWith(fo))return!1;let e=t;try{let{documentId:n}=Un(e);return uo(n)}catch{return!1}},uo=t=>{if(typeof t!="string")return!1;let e=Pa(t);if(e===void 0)return!1;let n=os(e);return tt(n)},Pl=t=>typeof t=="string"&&tt(t),lo=()=>{let t=ht(null,new Uint8Array(16));return Jt({documentId:t})},Pa=t=>co.default.decodeUnsafe(t),ao=t=>co.default.encode(t);var jn=t=>{if(t instanceof Uint8Array)return ao(t);if(Da(t))return Un(t).documentId;if(uo(t))return t;if(Pl(t)){console.warn("Future versions will not support UUIDs as document IDs; use Automerge URLs instead.");let e=is(t);return ao(e)}throw new Error(`Invalid AutomergeUrl: '${t}'`)};var ec={};Vn(ec,{decode:()=>ud,encode:()=>Oo});var ho;try{ho=new TextDecoder}catch{}var R,At,x=0;var Ha=[],Bl=105,Fl=57342,$l=57343,Ba=57337;var Fa=6,Kt={},Dn=11281e4,Ge=1681e4;var po=Ha,go=0,J={},te,Dr,Pr=0,Bn=0,oe,Te,ne=[],_o=[],be,_e,Pn,$a={useRecords:!1,mapsAsObjects:!0},Fn=!1,Na=2;try{new Function("")}catch{Na=1/0}var Et=class t{constructor(e){if(e&&((e.keyMap||e._keyMap)&&!e.useRecords&&(e.useRecords=!1,e.mapsAsObjects=!0),e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.getStructures&&(e.getShared=e.getStructures),e.getShared&&!e.structures&&((e.structures=[]).uninitialized=!0),e.keyMap)){this.mapKey=new Map;for(let[n,r]of Object.entries(e.keyMap))this.mapKey.set(r,n)}Object.assign(this,e)}decodeKey(e){return this.keyMap&&this.mapKey.get(e)||e}encodeKey(e){return this.keyMap&&this.keyMap.hasOwnProperty(e)?this.keyMap[e]:e}encodeKeys(e){if(!this._keyMap)return e;let n=new Map;for(let[r,s]of Object.entries(e))n.set(this._keyMap.hasOwnProperty(r)?this._keyMap[r]:r,s);return n}decodeKeys(e){if(!this._keyMap||e.constructor.name!="Map")return e;if(!this._mapKey){this._mapKey=new Map;for(let[r,s]of Object.entries(this._keyMap))this._mapKey.set(s,r)}let n={};return e.forEach((r,s)=>n[Oe(this._mapKey.has(s)?this._mapKey.get(s):s)]=r),n}mapDecode(e,n){let r=this.decode(e);if(this._keyMap)switch(r.constructor.name){case"Array":return r.map(s=>this.decodeKeys(s))}return r}decode(e,n){if(R)return Ja(()=>(Br(),this?this.decode(e,n):t.prototype.decode.call($a,e,n)));At=n>-1?n:e.length,x=0,go=0,Bn=0,Dr=null,po=Ha,oe=null,R=e;try{_e=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw R=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof t){if(J=this,be=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return te=this.structures,Ur();(!te||te.length>0)&&(te=[])}else J=$a,(!te||te.length>0)&&(te=[]),be=null;return Ur()}decodeMultiple(e,n){let r,s=0;try{let o=e.length;Fn=!0;let i=this?this.decode(e,o):xo.decode(e,o);if(n){if(n(i)===!1)return;for(;x<o;)if(s=x,n(Ur())===!1)return}else{for(r=[i];x<o;)s=x,r.push(Ur());return r}}catch(o){throw o.lastPosition=s,o.values=r,o}finally{Fn=!1,Br()}}};function Ur(){try{let t=K();if(oe){if(x>=oe.postBundlePosition){let e=new Error("Unexpected bundle position");throw e.incomplete=!0,e}x=oe.postBundlePosition,oe=null}if(x==At)te=null,R=null,Te&&(Te=null);else if(x>At){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}else if(!Fn)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw Br(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function K(){let t=R[x++],e=t>>5;if(t=t&31,t>23)switch(t){case 24:t=R[x++];break;case 25:if(e==7)return Nl();t=_e.getUint16(x),x+=2;break;case 26:if(e==7){let n=_e.getFloat32(x);if(J.useFloat32>2){let r=Fr[(R[x]&127)<<1|R[x+1]>>7];return x+=4,(r*n+(n>0?.5:-.5)>>0)/r}return x+=4,n}t=_e.getUint32(x),x+=4;break;case 27:if(e==7){let n=_e.getFloat64(x);return x+=8,n}if(e>1){if(_e.getUint32(x)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");t=_e.getUint32(x+4)}else J.int64AsNumber?(t=_e.getUint32(x)*4294967296,t+=_e.getUint32(x+4)):t=_e.getBigUint64(x);x+=8;break;case 31:switch(e){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let n=[],r,s=0;for(;(r=K())!=Kt;){if(s>=Dn)throw new Error(`Array length exceeds ${Dn}`);n[s++]=r}return e==4?n:e==3?n.join(""):__Buffer$.concat(n);case 5:let o;if(J.mapsAsObjects){let i={},a=0;if(J.keyMap)for(;(o=K())!=Kt;){if(a++>=Ge)throw new Error(`Property count exceeds ${Ge}`);i[Oe(J.decodeKey(o))]=K()}else for(;(o=K())!=Kt;){if(a++>=Ge)throw new Error(`Property count exceeds ${Ge}`);i[Oe(o)]=K()}return i}else{Pn&&(J.mapsAsObjects=!0,Pn=!1);let i=new Map;if(J.keyMap){let a=0;for(;(o=K())!=Kt;){if(a++>=Ge)throw new Error(`Map size exceeds ${Ge}`);i.set(J.decodeKey(o),K())}}else{let a=0;for(;(o=K())!=Kt;){if(a++>=Ge)throw new Error(`Map size exceeds ${Ge}`);i.set(o,K())}}return i}case 7:return Kt;default:throw new Error("Invalid major type for indefinite length "+e)}default:throw new Error("Unknown token "+t)}switch(e){case 0:return t;case 1:return~t;case 2:return Hl(t);case 3:if(Bn>=x)return Dr.slice(x-Pr,(x+=t)-Pr);if(Bn==0&&At<140&&t<32){let s=t<16?Va(t):zl(t);if(s!=null)return s}return Ll(t);case 4:if(t>=Dn)throw new Error(`Array length exceeds ${Dn}`);let n=new Array(t);for(let s=0;s<t;s++)n[s]=K();return n;case 5:if(t>=Ge)throw new Error(`Map size exceeds ${Dn}`);if(J.mapsAsObjects){let s={};if(J.keyMap)for(let o=0;o<t;o++)s[Oe(J.decodeKey(K()))]=K();else for(let o=0;o<t;o++)s[Oe(K())]=K();return s}else{Pn&&(J.mapsAsObjects=!0,Pn=!1);let s=new Map;if(J.keyMap)for(let o=0;o<t;o++)s.set(J.decodeKey(K()),K());else for(let o=0;o<t;o++)s.set(K(),K());return s}case 6:if(t>=Ba){let s=te[t&8191];if(s)return s.read||(s.read=yo(s)),s.read();if(t<65536){if(t==$l){let o=Xt(),i=K(),a=K();bo(i,a);let c={};if(J.keyMap)for(let l=2;l<o;l++){let h=J.decodeKey(a[l-2]);c[Oe(h)]=K()}else for(let l=2;l<o;l++){let h=a[l-2];c[Oe(h)]=K()}return c}else if(t==Fl){let o=Xt(),i=K();for(let a=2;a<o;a++)bo(i++,K());return K()}else if(t==Ba)return Gl();if(J.getShared&&(wo(),s=te[t&8191],s))return s.read||(s.read=yo(s)),s.read()}}let r=ne[t];if(r)return r.handlesRead?r(K):r(K());{let s=K();for(let o=0;o<_o.length;o++){let i=_o[o](t,s);if(i!==void 0)return i}return new Pe(s,t)}case 7:switch(t){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let s=(be||St())[t];if(s!==void 0)return s;throw new Error("Unknown token "+t)}default:if(isNaN(t)){let s=new Error("Unexpected end of CBOR data");throw s.incomplete=!0,s}throw new Error("Unknown CBOR token "+t)}}var La=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function yo(t){if(!t)throw new Error("Structure is required in record definition");function e(){let n=R[x++];if(n=n&31,n>23)switch(n){case 24:n=R[x++];break;case 25:n=_e.getUint16(x),x+=2;break;case 26:n=_e.getUint32(x),x+=4;break;default:throw new Error("Expected array header, but got "+R[x-1])}let r=this.compiledReader;for(;r;){if(r.propertyCount===n)return r(K);r=r.next}if(this.slowReads++>=Na){let o=this.length==n?this:this.slice(0,n);return r=J.keyMap?new Function("r","return {"+o.map(i=>J.decodeKey(i)).map(i=>La.test(i)?Oe(i)+":r()":"["+JSON.stringify(i)+"]:r()").join(",")+"}"):new Function("r","return {"+o.map(i=>La.test(i)?Oe(i)+":r()":"["+JSON.stringify(i)+"]:r()").join(",")+"}"),this.compiledReader&&(r.next=this.compiledReader),r.propertyCount=n,this.compiledReader=r,r(K)}let s={};if(J.keyMap)for(let o=0;o<n;o++)s[Oe(J.decodeKey(this[o]))]=K();else for(let o=0;o<n;o++)s[Oe(this[o])]=K();return s}return t.slowReads=0,e}function Oe(t){if(typeof t=="string")return t==="__proto__"?"__proto_":t;if(typeof t=="number"||typeof t=="boolean"||typeof t=="bigint")return t.toString();if(t==null)return t+"";throw new Error("Invalid property name type "+typeof t)}var Ll=mo;function mo(t){let e;if(t<16&&(e=Va(t)))return e;if(t>64&&ho)return ho.decode(R.subarray(x,x+=t));let n=x+t,r=[];for(e="";x<n;){let s=R[x++];if(!(s&128))r.push(s);else if((s&224)===192){let o=R[x++]&63;r.push((s&31)<<6|o)}else if((s&240)===224){let o=R[x++]&63,i=R[x++]&63;r.push((s&31)<<12|o<<6|i)}else if((s&248)===240){let o=R[x++]&63,i=R[x++]&63,a=R[x++]&63,c=(s&7)<<18|o<<12|i<<6|a;c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|c&1023),r.push(c)}else r.push(s);r.length>=4096&&(e+=ce.apply(String,r),r.length=0)}return r.length>0&&(e+=ce.apply(String,r)),e}var ce=String.fromCharCode;function zl(t){let e=x,n=new Array(t);for(let r=0;r<t;r++){let s=R[x++];if((s&128)>0){x=e;return}n[r]=s}return ce.apply(String,n)}function Va(t){if(t<4)if(t<2){if(t===0)return"";{let e=R[x++];if((e&128)>1){x-=1;return}return ce(e)}}else{let e=R[x++],n=R[x++];if((e&128)>0||(n&128)>0){x-=2;return}if(t<3)return ce(e,n);let r=R[x++];if((r&128)>0){x-=3;return}return ce(e,n,r)}else{let e=R[x++],n=R[x++],r=R[x++],s=R[x++];if((e&128)>0||(n&128)>0||(r&128)>0||(s&128)>0){x-=4;return}if(t<6){if(t===4)return ce(e,n,r,s);{let o=R[x++];if((o&128)>0){x-=5;return}return ce(e,n,r,s,o)}}else if(t<8){let o=R[x++],i=R[x++];if((o&128)>0||(i&128)>0){x-=6;return}if(t<7)return ce(e,n,r,s,o,i);let a=R[x++];if((a&128)>0){x-=7;return}return ce(e,n,r,s,o,i,a)}else{let o=R[x++],i=R[x++],a=R[x++],c=R[x++];if((o&128)>0||(i&128)>0||(a&128)>0||(c&128)>0){x-=8;return}if(t<10){if(t===8)return ce(e,n,r,s,o,i,a,c);{let l=R[x++];if((l&128)>0){x-=9;return}return ce(e,n,r,s,o,i,a,c,l)}}else if(t<12){let l=R[x++],h=R[x++];if((l&128)>0||(h&128)>0){x-=10;return}if(t<11)return ce(e,n,r,s,o,i,a,c,l,h);let f=R[x++];if((f&128)>0){x-=11;return}return ce(e,n,r,s,o,i,a,c,l,h,f)}else{let l=R[x++],h=R[x++],f=R[x++],d=R[x++];if((l&128)>0||(h&128)>0||(f&128)>0||(d&128)>0){x-=12;return}if(t<14){if(t===12)return ce(e,n,r,s,o,i,a,c,l,h,f,d);{let g=R[x++];if((g&128)>0){x-=13;return}return ce(e,n,r,s,o,i,a,c,l,h,f,d,g)}}else{let g=R[x++],w=R[x++];if((g&128)>0||(w&128)>0){x-=14;return}if(t<15)return ce(e,n,r,s,o,i,a,c,l,h,f,d,g,w);let A=R[x++];if((A&128)>0){x-=15;return}return ce(e,n,r,s,o,i,a,c,l,h,f,d,g,w,A)}}}}}function Hl(t){return J.copyBuffers?Uint8Array.prototype.slice.call(R,x,x+=t):R.subarray(x,x+=t)}var Wa=new Float32Array(1),jr=new Uint8Array(Wa.buffer,0,4);function Nl(){let t=R[x++],e=R[x++],n=(t&127)>>2;if(n===31)return e||t&3?NaN:t&128?-1/0:1/0;if(n===0){let r=((t&3)<<8|e)/16777216;return t&128?-r:r}return jr[3]=t&128|(n>>1)+56,jr[2]=(t&7)<<5|e>>3,jr[1]=e<<5,jr[0]=0,Wa[0]}var np=new Array(4096);var Pe=class{constructor(e,n){this.value=e,this.tag=n}};ne[0]=t=>new Date(t);ne[1]=t=>new Date(Math.round(t*1e3));ne[2]=t=>{let e=BigInt(0);for(let n=0,r=t.byteLength;n<r;n++)e=BigInt(t[n])+(e<<BigInt(8));return e};ne[3]=t=>BigInt(-1)-ne[2](t);ne[4]=t=>+(t[1]+"e"+t[0]);ne[5]=t=>t[1]*Math.exp(t[0]*Math.log(2));var bo=(t,e)=>{t=t-57344;let n=te[t];n&&n.isShared&&((te.restoreStructures||(te.restoreStructures=[]))[t]=n),te[t]=e,e.read=yo(e)};ne[Bl]=t=>{let e=t.length,n=t[1];bo(t[0],n);let r={};for(let s=2;s<e;s++){let o=n[s-2];r[Oe(o)]=t[s]}return r};ne[14]=t=>oe?oe[0].slice(oe.position0,oe.position0+=t):new Pe(t,14);ne[15]=t=>oe?oe[1].slice(oe.position1,oe.position1+=t):new Pe(t,15);var Vl={Error,RegExp};ne[27]=t=>(Vl[t[0]]||Error)(t[1],t[2]);var qa=t=>{if(R[x++]!=132){let n=new Error("Packed values structure must be followed by a 4 element array");throw R.length<x&&(n.incomplete=!0),n}let e=t();if(!e||!e.length){let n=new Error("Packed values structure must be followed by a 4 element array");throw n.incomplete=!0,n}return be=be?e.concat(be.slice(e.length)):e,be.prefixes=t(),be.suffixes=t(),t()};qa.handlesRead=!0;ne[51]=qa;ne[Fa]=t=>{if(!be)if(J.getShared)wo();else return new Pe(t,Fa);if(typeof t=="number")return be[16+(t>=0?2*t:-2*t-1)];let e=new Error("No support for non-integer packed references yet");throw t===void 0&&(e.incomplete=!0),e};ne[28]=t=>{Te||(Te=new Map,Te.id=0);let e=Te.id++,n=x,r=R[x],s;r>>5==4?s=[]:s={};let o={target:s};Te.set(e,o);let i=t();return o.used?(Object.getPrototypeOf(s)!==Object.getPrototypeOf(i)&&(x=n,s=i,Te.set(e,{target:s}),i=t()),Object.assign(s,i)):(o.target=i,i)};ne[28].handlesRead=!0;ne[29]=t=>{let e=Te.get(t);return e.used=!0,e.target};ne[258]=t=>new Set(t);(ne[259]=t=>(J.mapsAsObjects&&(J.mapsAsObjects=!1,Pn=!0),t())).handlesRead=!0;function Gt(t,e){return typeof t=="string"?t+e:t instanceof Array?t.concat(e):Object.assign({},t,e)}function St(){if(!be)if(J.getShared)wo();else throw new Error("No packed values available");return be}var Wl=1399353956;_o.push((t,e)=>{if(t>=225&&t<=255)return Gt(St().prefixes[t-224],e);if(t>=28704&&t<=32767)return Gt(St().prefixes[t-28672],e);if(t>=1879052288&&t<=2147483647)return Gt(St().prefixes[t-1879048192],e);if(t>=216&&t<=223)return Gt(e,St().suffixes[t-216]);if(t>=27647&&t<=28671)return Gt(e,St().suffixes[t-27639]);if(t>=1811940352&&t<=1879048191)return Gt(e,St().suffixes[t-1811939328]);if(t==Wl)return{packedValues:be,structures:te.slice(0),version:e};if(t==55799)return e});var ql=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,za=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],Jl=[64,68,69,70,71,72,77,78,79,85,86];for(let t=0;t<za.length;t++)Kl(za[t],Jl[t]);function Kl(t,e){let n="get"+t.name.slice(0,-5),r;typeof t=="function"?r=t.BYTES_PER_ELEMENT:t=null;for(let s=0;s<2;s++){if(!s&&r==1)continue;let o=r==2?1:r==4?2:r==8?3:0;ne[s?e:e-4]=r==1||s==ql?i=>{if(!t)throw new Error("Could not find typed array for code "+e);return!J.copyBuffers&&(r===1||r===2&&!(i.byteOffset&1)||r===4&&!(i.byteOffset&3)||r===8&&!(i.byteOffset&7))?new t(i.buffer,i.byteOffset,i.byteLength>>o):new t(Uint8Array.prototype.slice.call(i,0).buffer)}:i=>{if(!t)throw new Error("Could not find typed array for code "+e);let a=new DataView(i.buffer,i.byteOffset,i.byteLength),c=i.length>>o,l=new t(c),h=a[n];for(let f=0;f<c;f++)l[f]=h.call(a,f<<o,s);return l}}}function Gl(){let t=Xt(),e=x+K();for(let r=2;r<t;r++){let s=Xt();x+=s}let n=x;return x=e,oe=[mo(Xt()),mo(Xt())],oe.position0=0,oe.position1=0,oe.postBundlePosition=x,x=n,K()}function Xt(){let t=R[x++]&31;if(t>23)switch(t){case 24:t=R[x++];break;case 25:t=_e.getUint16(x),x+=2;break;case 26:t=_e.getUint32(x),x+=4;break}return t}function wo(){if(J.getShared){let t=Ja(()=>(R=null,J.getShared()))||{},e=t.structures||[];J.sharedVersion=t.version,be=J.sharedValues=t.packedValues,te===!0?J.structures=te=e:te.splice.apply(te,[0,e.length].concat(e))}}function Ja(t){let e=At,n=x,r=go,s=Pr,o=Bn,i=Dr,a=po,c=Te,l=oe,h=new Uint8Array(R.slice(0,At)),f=te,d=J,g=Fn,w=t();return At=e,x=n,go=r,Pr=s,Bn=o,Dr=i,po=a,Te=c,oe=l,R=h,Fn=g,te=f,J=d,_e=new DataView(R.buffer,R.byteOffset,R.byteLength),w}function Br(){R=null,Te=null,te=null}var Fr=new Array(147);for(let t=0;t<256;t++)Fr[t]=+("1e"+Math.floor(45.15-t*.30103));var xo=new Et({useRecords:!1}),$n=xo.decode,Xl=xo.decodeMultiple,$r={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4};var Lr;try{Lr=new TextEncoder}catch{}var ko,Qa,Nr=typeof globalThis=="object"&&globalThis.Buffer,Ln=typeof Nr<"u",vo=Ln?Nr.allocUnsafeSlow:Uint8Array,Ka=Ln?Nr:Uint8Array,Ga=256,Xa=Ln?4294967296:2144337920;var So,y,ee,p=0,ut,ie=null,Yl=61440,Zl=/[\u0080-\uFFFF]/,Ae=Symbol("record-id"),kt=class extends Et{constructor(e){super(e),this.offset=0;let n,r,s,o,i,a;e=e||{};let c=Ka.prototype.utf8Write?function(m,M,S){return y.utf8Write(m,M,S)}:Lr&&Lr.encodeInto?function(m,M){return Lr.encodeInto(m,y.subarray(M)).written}:!1,l=this,h=e.structures||e.saveStructures,f=e.maxSharedStructures;if(f==null&&(f=h?128:0),f>8190)throw new Error("Maximum maxSharedStructure is 8190");let d=e.sequential;d&&(f=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let g,w,A=e.sharedValues,C;if(A){C=Object.create(null);for(let m=0,M=A.length;m<M;m++)C[A[m]]=m}let O=[],j=0,q=0;this.mapEncode=function(m,M){if(this._keyMap&&!this._mapped)switch(m.constructor.name){case"Array":m=m.map(S=>this.encodeKeys(S));break}return this.encode(m,M)},this.encode=function(m,M){if(y||(y=new vo(8192),ee=new DataView(y.buffer,0,8192),p=0),ut=y.length-10,ut-p<2048?(y=new vo(y.length),ee=new DataView(y.buffer,0,y.length),ut=y.length-10,p=0):M===Co&&(p=p+7&2147483640),r=p,l.useSelfDescribedHeader&&(ee.setUint32(p,3654940416),p+=3),a=l.structuredClone?new Map:null,l.bundleStrings&&typeof m!="string"?(ie=[],ie.size=1/0):ie=null,s=l.structures,s){if(s.uninitialized){let E=l.getShared()||{};l.structures=s=E.structures||[],l.sharedVersion=E.version;let k=l.sharedValues=E.packedValues;if(k){C={};for(let D=0,L=k.length;D<L;D++)C[k[D]]=D}}let S=s.length;if(S>f&&!d&&(S=f),!s.transitions){s.transitions=Object.create(null);for(let E=0;E<S;E++){let k=s[E];if(!k)continue;let D,L=s.transitions;for(let z=0,W=k.length;z<W;z++){L[Ae]===void 0&&(L[Ae]=E);let G=k[z];D=L[G],D||(D=L[G]=Object.create(null)),L=D}L[Ae]=E|1048576}}d||(s.nextId=S)}if(o&&(o=!1),i=s||[],w=C,e.pack){let S=new Map;if(S.values=[],S.encoder=l,S.maxValues=e.maxPrivatePackedValues||(C?16:1/0),S.objectMap=C||!1,S.samplingPackedValues=g,zr(m,S),S.values.length>0){y[p++]=216,y[p++]=51,ze(4);let E=S.values;T(E),ze(0),ze(0),w=Object.create(C||null);for(let k=0,D=E.length;k<D;k++)w[E[k]]=k}}So=M&Eo;try{if(So)return;if(T(m),ie&&Za(r,T),l.offset=p,a&&a.idsToInsert){p+=a.idsToInsert.length*2,p>ut&&X(p),l.offset=p;let S=td(y.subarray(r,p),a.idsToInsert);return a=null,S}return M&Co?(y.start=r,y.end=p,y):y.subarray(r,p)}finally{if(s){if(q<10&&q++,s.length>f&&(s.length=f),j>1e4)s.transitions=null,q=0,j=0,O.length>0&&(O=[]);else if(O.length>0&&!d){for(let S=0,E=O.length;S<E;S++)O[S][Ae]=void 0;O=[]}}if(o&&l.saveShared){l.structures.length>f&&(l.structures=l.structures.slice(0,f));let S=y.subarray(r,p);return l.updateSharedData()===!1?l.encode(m):S}M&fd&&(p=r)}},this.findCommonStringsToPack=()=>(g=new Map,C||(C=Object.create(null)),m=>{let M=m&&m.threshold||4,S=this.pack?m.maxPrivatePackedValues||16:0;A||(A=this.sharedValues=[]);for(let[E,k]of g)k.count>M&&(C[E]=S++,A.push(E),o=!0);for(;this.saveShared&&this.updateSharedData()===!1;);g=null});let T=m=>{p>ut&&(y=X(p));var M=typeof m,S;if(M==="string"){if(w){let L=w[m];if(L>=0){L<16?y[p++]=L+224:(y[p++]=198,L&1?T(15-L>>1):T(L-16>>1));return}else if(g&&!e.pack){let z=g.get(m);z?z.count++:g.set(m,{count:1})}}let E=m.length;if(ie&&E>=4&&E<1024){if((ie.size+=E)>Yl){let z,W=(ie[0]?ie[0].length*3+ie[1].length:0)+10;p+W>ut&&(y=X(p+W)),y[p++]=217,y[p++]=223,y[p++]=249,y[p++]=ie.position?132:130,y[p++]=26,z=p-r,p+=4,ie.position&&Za(r,T),ie=["",""],ie.size=0,ie.position=z}let L=Zl.test(m);ie[L?0:1]+=m,y[p++]=L?206:207,T(E);return}let k;E<32?k=1:E<256?k=2:E<65536?k=3:k=5;let D=E*3;if(p+D>ut&&(y=X(p+D)),E<64||!c){let L,z,W,G=p+k;for(L=0;L<E;L++)z=m.charCodeAt(L),z<128?y[G++]=z:z<2048?(y[G++]=z>>6|192,y[G++]=z&63|128):(z&64512)===55296&&((W=m.charCodeAt(L+1))&64512)===56320?(z=65536+((z&1023)<<10)+(W&1023),L++,y[G++]=z>>18|240,y[G++]=z>>12&63|128,y[G++]=z>>6&63|128,y[G++]=z&63|128):(y[G++]=z>>12|224,y[G++]=z>>6&63|128,y[G++]=z&63|128);S=G-p-k}else S=c(m,p+k,D);S<24?y[p++]=96|S:S<256?(k<2&&y.copyWithin(p+2,p+1,p+1+S),y[p++]=120,y[p++]=S):S<65536?(k<3&&y.copyWithin(p+3,p+2,p+2+S),y[p++]=121,y[p++]=S>>8,y[p++]=S&255):(k<5&&y.copyWithin(p+5,p+3,p+3+S),y[p++]=122,ee.setUint32(p,S),p+=4),p+=S}else if(M==="number")if(!this.alwaysUseFloat&&m>>>0===m)m<24?y[p++]=m:m<256?(y[p++]=24,y[p++]=m):m<65536?(y[p++]=25,y[p++]=m>>8,y[p++]=m&255):(y[p++]=26,ee.setUint32(p,m),p+=4);else if(!this.alwaysUseFloat&&m>>0===m)m>=-24?y[p++]=31-m:m>=-256?(y[p++]=56,y[p++]=~m):m>=-65536?(y[p++]=57,ee.setUint16(p,~m),p+=2):(y[p++]=58,ee.setUint32(p,~m),p+=4);else{let E;if((E=this.useFloat32)>0&&m<4294967296&&m>=-2147483648){y[p++]=250,ee.setFloat32(p,m);let k;if(E<4||(k=m*Fr[(y[p]&127)<<1|y[p+1]>>7])>>0===k){p+=4;return}else p--}y[p++]=251,ee.setFloat64(p,m),p+=8}else if(M==="object")if(!m)y[p++]=246;else{if(a){let k=a.get(m);if(k){if(y[p++]=216,y[p++]=29,y[p++]=25,!k.references){let D=a.idsToInsert||(a.idsToInsert=[]);k.references=[],D.push(k)}k.references.push(p-r),p+=2;return}else a.set(m,{offset:p-r})}let E=m.constructor;if(E===Object)N(m);else if(E===Array){S=m.length,S<24?y[p++]=128|S:ze(S);for(let k=0;k<S;k++)T(m[k])}else if(E===Map)if((this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)&&(y[p++]=217,y[p++]=1,y[p++]=3),S=m.size,S<24?y[p++]=160|S:S<256?(y[p++]=184,y[p++]=S):S<65536?(y[p++]=185,y[p++]=S>>8,y[p++]=S&255):(y[p++]=186,ee.setUint32(p,S),p+=4),l.keyMap)for(let[k,D]of m)T(l.encodeKey(k)),T(D);else for(let[k,D]of m)T(k),T(D);else{for(let k=0,D=ko.length;k<D;k++){let L=Qa[k];if(m instanceof L){let z=ko[k],W=z.tag;W==null&&(W=z.getTag&&z.getTag.call(this,m)),W<24?y[p++]=192|W:W<256?(y[p++]=216,y[p++]=W):W<65536?(y[p++]=217,y[p++]=W>>8,y[p++]=W&255):W>-1&&(y[p++]=218,ee.setUint32(p,W),p+=4),z.encode.call(this,m,T,X);return}}if(m[Symbol.iterator]){if(So){let k=new Error("Iterable should be serialized as iterator");throw k.iteratorNotHandled=!0,k}y[p++]=159;for(let k of m)T(k);y[p++]=255;return}if(m[Symbol.asyncIterator]||Ao(m)){let k=new Error("Iterable/blob should be serialized as iterator");throw k.iteratorNotHandled=!0,k}if(this.useToJSON&&m.toJSON){let k=m.toJSON();if(k!==m)return T(k)}N(m)}}else if(M==="boolean")y[p++]=m?245:244;else if(M==="bigint"){if(m<BigInt(1)<<BigInt(64)&&m>=0)y[p++]=27,ee.setBigUint64(p,m);else if(m>-(BigInt(1)<<BigInt(64))&&m<0)y[p++]=59,ee.setBigUint64(p,-m-BigInt(1));else if(this.largeBigIntToFloat)y[p++]=251,ee.setFloat64(p,Number(m));else{m>=BigInt(0)?y[p++]=194:(y[p++]=195,m=BigInt(-1)-m);let E=[];for(;m;)E.push(Number(m&BigInt(255))),m>>=BigInt(8);Io(new Uint8Array(E.reverse()),X);return}p+=8}else if(M==="undefined")y[p++]=247;else throw new Error("Unknown type: "+M)},N=this.useRecords===!1?this.variableMapSize?m=>{let M=Object.keys(m),S=Object.values(m),E=M.length;E<24?y[p++]=160|E:E<256?(y[p++]=184,y[p++]=E):E<65536?(y[p++]=185,y[p++]=E>>8,y[p++]=E&255):(y[p++]=186,ee.setUint32(p,E),p+=4);let k;if(l.keyMap)for(let D=0;D<E;D++)T(l.encodeKey(M[D])),T(S[D]);else for(let D=0;D<E;D++)T(M[D]),T(S[D])}:m=>{y[p++]=185;let M=p-r;p+=2;let S=0;if(l.keyMap)for(let E in m)(typeof m.hasOwnProperty!="function"||m.hasOwnProperty(E))&&(T(l.encodeKey(E)),T(m[E]),S++);else for(let E in m)(typeof m.hasOwnProperty!="function"||m.hasOwnProperty(E))&&(T(E),T(m[E]),S++);y[M+++r]=S>>8,y[M+r]=S&255}:(m,M)=>{let S,E=i.transitions||(i.transitions=Object.create(null)),k=0,D=0,L,z;if(this.keyMap){z=Object.keys(m).map(G=>this.encodeKey(G)),D=z.length;for(let G=0;G<D;G++){let Ho=z[G];S=E[Ho],S||(S=E[Ho]=Object.create(null),k++),E=S}}else for(let G in m)(typeof m.hasOwnProperty!="function"||m.hasOwnProperty(G))&&(S=E[G],S||(E[Ae]&1048576&&(L=E[Ae]&65535),S=E[G]=Object.create(null),k++),E=S,D++);let W=E[Ae];if(W!==void 0)W&=65535,y[p++]=217,y[p++]=W>>8|224,y[p++]=W&255;else if(z||(z=E.__keys__||(E.__keys__=Object.keys(m))),L===void 0?(W=i.nextId++,W||(W=0,i.nextId=1),W>=Ga&&(i.nextId=(W=f)+1)):W=L,i[W]=z,W<f){y[p++]=217,y[p++]=W>>8|224,y[p++]=W&255,E=i.transitions;for(let G=0;G<D;G++)(E[Ae]===void 0||E[Ae]&1048576)&&(E[Ae]=W),E=E[z[G]];E[Ae]=W|1048576,o=!0}else{if(E[Ae]=W,ee.setUint32(p,3655335680),p+=3,k&&(j+=q*k),O.length>=Ga-f&&(O.shift()[Ae]=void 0),O.push(E),ze(D+2),T(57344+W),T(z),M)return;for(let G in m)(typeof m.hasOwnProperty!="function"||m.hasOwnProperty(G))&&T(m[G]);return}if(D<24?y[p++]=128|D:ze(D),!M)for(let G in m)(typeof m.hasOwnProperty!="function"||m.hasOwnProperty(G))&&T(m[G])},X=m=>{let M;if(m>16777216){if(m-r>Xa)throw new Error("Encoded buffer would be larger than maximum buffer size");M=Math.min(Xa,Math.round(Math.max((m-r)*(m>67108864?1.25:2),4194304)/4096)*4096)}else M=(Math.max(m-r<<2,y.length-1)>>12)+1<<12;let S=new vo(M);return ee=new DataView(S.buffer,0,M),y.copy?y.copy(S,0,r,m):S.set(y.slice(r,m)),p-=r,r=0,ut=S.length-10,y=S},V=100,Y=1e3;this.encodeAsIterable=function(m,M){return lt(m,M,Z)},this.encodeAsAsyncIterable=function(m,M){return lt(m,M,zo)};function*Z(m,M,S){let E=m.constructor;if(E===Object){let k=l.useRecords!==!1;k?N(m,!0):Ya(Object.keys(m).length,160);for(let D in m){let L=m[D];k||T(D),L&&typeof L=="object"?M[D]?yield*Z(L,M[D]):yield*He(L,M,D):T(L)}}else if(E===Array){let k=m.length;ze(k);for(let D=0;D<k;D++){let L=m[D];L&&(typeof L=="object"||p-r>V)?M.element?yield*Z(L,M.element):yield*He(L,M,"element"):T(L)}}else if(m[Symbol.iterator]&&!m.buffer){y[p++]=159;for(let k of m)k&&(typeof k=="object"||p-r>V)?M.element?yield*Z(k,M.element):yield*He(k,M,"element"):T(k);y[p++]=255}else Ao(m)?(Ya(m.size,64),yield y.subarray(r,p),yield m,Re()):m[Symbol.asyncIterator]?(y[p++]=159,yield y.subarray(r,p),yield m,Re(),y[p++]=255):T(m);S&&p>r?yield y.subarray(r,p):p-r>V&&(yield y.subarray(r,p),Re())}function*He(m,M,S){let E=p-r;try{T(m),p-r>V&&(yield y.subarray(r,p),Re())}catch(k){if(k.iteratorNotHandled)M[S]={},p=r+E,yield*Z.call(this,m,M[S]);else throw k}}function Re(){V=Y,l.encode(null,Eo)}function lt(m,M,S){return M&&M.chunkThreshold?V=Y=M.chunkThreshold:V=100,m&&typeof m=="object"?(l.encode(null,Eo),S(m,l.iterateProperties||(l.iterateProperties={}),!0)):[l.encode(m)]}async function*zo(m,M){for(let S of Z(m,M,!0)){let E=S.constructor;if(E===Ka||E===Uint8Array)yield S;else if(Ao(S)){let k=S.stream().getReader(),D;for(;!(D=await k.read()).done;)yield D.value}else if(S[Symbol.asyncIterator])for await(let k of S)Re(),k?yield*zo(k,M.async||(M.async={})):yield l.encode(k);else yield S}}}useBuffer(e){y=e,ee=new DataView(y.buffer,y.byteOffset,y.byteLength),p=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let e=this.sharedVersion||0;this.sharedVersion=e+1;let n=this.structures.slice(0),r=new Hr(n,this.sharedValues,this.sharedVersion),s=this.saveShared(r,o=>(o&&o.version||0)==e);return s===!1?(r=this.getShared()||{},this.structures=r.structures||[],this.sharedValues=r.packedValues,this.sharedVersion=r.version,this.structures.nextId=this.structures.length):n.forEach((o,i)=>this.structures[i]=o),s}};function Ya(t,e){t<24?y[p++]=e|t:t<256?(y[p++]=e|24,y[p++]=t):t<65536?(y[p++]=e|25,y[p++]=t>>8,y[p++]=t&255):(y[p++]=e|26,ee.setUint32(p,t),p+=4)}var Hr=class{constructor(e,n,r){this.structures=e,this.packedValues=n,this.version=r}};function ze(t){t<24?y[p++]=128|t:t<256?(y[p++]=152,y[p++]=t):t<65536?(y[p++]=153,y[p++]=t>>8,y[p++]=t&255):(y[p++]=154,ee.setUint32(p,t),p+=4)}var Ql=typeof Blob>"u"?function(){}:Blob;function Ao(t){if(t instanceof Ql)return!0;let e=t[Symbol.toStringTag];return e==="Blob"||e==="File"}function zr(t,e){switch(typeof t){case"string":if(t.length>3){if(e.objectMap[t]>-1||e.values.length>=e.maxValues)return;let r=e.get(t);if(r)++r.count==2&&e.values.push(t);else if(e.set(t,{count:1}),e.samplingPackedValues){let s=e.samplingPackedValues.get(t);s?s.count++:e.samplingPackedValues.set(t,{count:1})}}break;case"object":if(t)if(t instanceof Array)for(let r=0,s=t.length;r<s;r++)zr(t[r],e);else{let r=!e.encoder.useRecords;for(var n in t)t.hasOwnProperty(n)&&(r&&zr(n,e),zr(t[n],e))}break;case"function":console.log(t)}}var ed=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;Qa=[Date,Set,Error,RegExp,Pe,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,Hr];ko=[{tag:1,encode(t,e){let n=t.getTime()/1e3;(this.useTimestamp32||t.getMilliseconds()===0)&&n>=0&&n<4294967296?(y[p++]=26,ee.setUint32(p,n),p+=4):(y[p++]=251,ee.setFloat64(p,n),p+=8)}},{tag:258,encode(t,e){let n=Array.from(t);e(n)}},{tag:27,encode(t,e){e([t.name,t.message])}},{tag:27,encode(t,e){e(["RegExp",t.source,t.flags])}},{getTag(t){return t.tag},encode(t,e){e(t.value)}},{encode(t,e,n){Io(t,n)}},{getTag(t){if(t.constructor===Uint8Array&&(this.tagUint8Array||Ln&&this.tagUint8Array!==!1))return 64},encode(t,e,n){Io(t,n)}},Le(68,1),Le(69,2),Le(70,4),Le(71,8),Le(72,1),Le(77,2),Le(78,4),Le(79,8),Le(85,4),Le(86,8),{encode(t,e){let n=t.packedValues||[],r=t.structures||[];if(n.values.length>0){y[p++]=216,y[p++]=51,ze(4);let s=n.values;e(s),ze(0),ze(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let o=0,i=s.length;o<i;o++)packedObjectMap[s[o]]=o}if(r){ee.setUint32(p,3655335424),p+=3;let s=r.slice(0);s.unshift(57344),s.push(new Pe(t.version,1399353956)),e(s)}else e(new Pe(t.version,1399353956))}}];function Le(t,e){return!ed&&e>1&&(t-=4),{tag:t,encode:function(r,s){let o=r.byteLength,i=r.byteOffset||0,a=r.buffer||r;s(Ln?Nr.from(a,i,o):new Uint8Array(a,i,o))}}}function Io(t,e){let n=t.byteLength;n<24?y[p++]=64+n:n<256?(y[p++]=88,y[p++]=n):n<65536?(y[p++]=89,y[p++]=n>>8,y[p++]=n&255):(y[p++]=90,ee.setUint32(p,n),p+=4),p+n>=y.length&&e(p+n),y.set(t.buffer?t:new Uint8Array(t),p),p+=n}function td(t,e){let n,r=e.length*2,s=t.length-r;e.sort((o,i)=>o.offset>i.offset?1:-1);for(let o=0;o<e.length;o++){let i=e[o];i.id=o;for(let a of i.references)t[a++]=o>>8,t[a]=o&255}for(;n=e.pop();){let o=n.offset;t.copyWithin(o+r,o,s),r-=2;let i=o+r;t[i++]=216,t[i++]=28,s=o}return t}function Za(t,e){ee.setUint32(ie.position+t,p-ie.position-t+1);let n=ie;ie=null,e(n[0]),e(n[1])}var To=new kt({useRecords:!1}),nd=To.encode,rd=To.encodeAsIterable,sd=To.encodeAsAsyncIterable,{NEVER:od,ALWAYS:id,DECIMAL_ROUND:ad,DECIMAL_FIT:cd}=$r,Co=512,fd=1024,Eo=2048;function Oo(t){return new kt({tagUint8Array:!1,useRecords:!1}).encode(t)}function ud(t){return $n(t)}var tc=(t,e)=>t.length===e.length&&t.every((n,r)=>n===e[r]);var Yt=(t,e)=>tc(t,e);var nc=async(t,e)=>{let n,r=new Promise((s,o)=>{n=setTimeout(()=>o(new Ro(`withTimeout: timed out after ${e}ms`)),e)});try{return await Promise.race([t,r])}finally{clearTimeout(n)}},Ro=class extends Error{constructor(e){super(e),this.name="TimeoutError"}};var zn=class extends Se.default{documentId;#t;#e;#r=Ve();#n=6e4;#o={};constructor(e,n={}){super(),this.documentId=e,"timeoutDelay"in n&&n.timeoutDelay&&(this.#n=n.timeoutDelay);let r=Ve();this.#t=(0,sc.default)(`automerge-repo:dochandle:${this.documentId.slice(0,5)}`);let s=this.#n,o=(0,P.setup)({types:{context:{},events:{}},actions:{onUpdate:(0,P.assign)(({context:i,event:a})=>{let c=i.doc;(0,P.assertEvent)(a,Vr);let{callback:l}=a.payload;return{doc:l(c)}}),onDelete:(0,P.assign)(()=>(this.emit("delete",{handle:this}),{doc:Ve()})),onUnavailable:()=>{this.emit("unavailable",{handle:this})}}}).createMachine({initial:"idle",context:{documentId:e,doc:r},on:{UPDATE:{actions:"onUpdate"},DELETE:".deleted"},states:{idle:{on:{BEGIN:"loading"}},loading:{on:{REQUEST:"requesting",DOC_READY:"ready"},after:{[s]:"unavailable"}},requesting:{on:{DOC_UNAVAILABLE:"unavailable",DOC_READY:"ready"},after:{[s]:"unavailable"}},unavailable:{entry:"onUnavailable",on:{DOC_READY:"ready"}},ready:{},deleted:{entry:"onDelete",type:"final"}}});this.#e=(0,P.createActor)(o),this.#e.subscribe(i=>{let a=this.#r,c=i.context.doc;this.#t(`\u2192 ${i.value} %o`,c),this.#c(a,c)}),this.#e.start(),this.#e.send({type:dd})}get#i(){return this.#e?.getSnapshot().context.doc}get#a(){return this.#e?.getSnapshot().value}#s(e){let n=Array.isArray(e)?e:[e];return(0,P.waitFor)(this.#e,r=>n.some(s=>r.matches(s)),{timeout:this.#n*2})}#c(e,n){let r=ue(e),s=ue(n);if(!Yt(s,r)){this.emit("heads-changed",{handle:this,doc:n});let i=jt(n,r,s);i.length>0&&this.emit("change",{handle:this,doc:n,patches:i,patchInfo:{before:e,after:n,source:"change"}}),this.isReady()||this.#e.send({type:rc})}this.#r=n}get url(){return Jt({documentId:this.documentId})}isReady=()=>this.inState(["ready"]);isDeleted=()=>this.inState(["deleted"]);isUnavailable=()=>this.inState(["unavailable"]);inState=e=>e.some(n=>this.#e.getSnapshot().matches(n));get state(){return this.#e.getSnapshot().value}async whenReady(e=["ready"]){await nc(this.#s(e),this.#n)}async doc(e=["ready","unavailable"]){try{await this.#s(e)}catch{return}return this.isUnavailable()?void 0:this.#i}docSync(){if(this.isReady())return this.#i}heads(){if(this.isReady())return ue(this.#i)}history(){if(this.isReady())return wn(this.#i).map(e=>[e])}view(e){if(this.isReady())return Mt(this.#i,e)}diff(e,n){if(!this.isReady())return;let r=n?e:this.heads()||[],s=n||e;return jt(this.#i,r,s)}metadata(e){if(this.isReady())return e||(e=this.heads()[0]),xn(this.#i,e)||void 0}update(e){this.#e.send({type:Vr,payload:{callback:e}})}doneLoading(){this.#e.send({type:rc})}setRemoteHeads(e,n){this.#o[e]=n,this.emit("remote-heads",{storageId:e,heads:n})}getRemoteHeads(e){return this.#o[e]}change(e,n={}){if(!this.isReady())throw new Error(`DocHandle#${this.documentId} is in ${this.state} and not ready. Check \`handle.isReady()\` before accessing the document.`);this.#e.send({type:Vr,payload:{callback:r=>fn(r,n,e)}})}changeAt(e,n,r={}){if(!this.isReady())throw new Error(`DocHandle#${this.documentId} is not ready. Check \`handle.isReady()\` before accessing the document.`);let s;return this.#e.send({type:Vr,payload:{callback:o=>{let i=un(o,e,r,n);return s=i.newHeads||void 0,i.newDoc}}}),s}merge(e){if(!this.isReady()||!e.isReady())throw new Error("Both handles must be ready to merge");let n=e.docSync();if(!n)throw new Error("The document to be merged in is falsy, aborting.");this.update(r=>dn(r,n))}unavailable(){this.#e.send({type:gd})}request(){this.#a==="loading"&&this.#e.send({type:hd})}delete(){this.#e.send({type:pd})}broadcast(e){this.emit("ephemeral-message-outbound",{handle:this,data:Oo(e)})}metrics(){return vn(this.#i)}},ld={IDLE:"idle",LOADING:"loading",REQUESTING:"requesting",READY:"ready",DELETED:"deleted",UNAVAILABLE:"unavailable"},{IDLE:jp,LOADING:Dp,REQUESTING:Hn,READY:Wr,DELETED:Pp,UNAVAILABLE:Mo}=ld,dd="BEGIN",hd="REQUEST",rc="DOC_READY",Vr="UPDATE",pd="DELETE";var gd="DOC_UNAVAILABLE";var oc={};Vn(oc,{Counter:()=>de,Float64:()=>et,Int:()=>Ze,Text:()=>ye,Uint:()=>Qe,applyChanges:()=>pn,change:()=>fn,changeAt:()=>un,clone:()=>_s,decodeChange:()=>ur,decodeSyncMessage:()=>mn,decodeSyncState:()=>mt,deleteAt:()=>ar,diff:()=>jt,dump:()=>Ts,emptyChange:()=>bs,encodeChange:()=>ks,encodeSyncMessage:()=>Is,encodeSyncState:()=>yt,equals:()=>Ot,free:()=>ys,from:()=>ms,generateSyncMessage:()=>gn,getActorId:()=>vs,getAllChanges:()=>hn,getBackend:()=>ps,getChanges:()=>fr,getConflicts:()=>Xc,getHeads:()=>ue,getHistory:()=>As,getLastLocalChange:()=>Ss,getMissingDeps:()=>Cs,getObjectId:()=>cr,hasHeads:()=>Ms,hasOurChanges:()=>Es,init:()=>Rt,initSyncState:()=>yn,initializeBase64Wasm:()=>an,initializeWasm:()=>Tt,insertAt:()=>ir,inspectChange:()=>xn,isAutomerge:()=>Rs,isWasmInitialized:()=>sr,load:()=>ws,loadIncremental:()=>_t,merge:()=>dn,next:()=>De,receiveSyncMessage:()=>_n,save:()=>ln,saveIncremental:()=>xs,saveSince:()=>bn,stats:()=>vn,toJS:()=>Os,topoHistoryTraversal:()=>wn,use:()=>Gc,uuid:()=>Qn,view:()=>Mt,wasmInitialized:()=>rr});var _c=Me(rt(),1);var ic=Me(rt(),1),qr=class extends Se.default{#t=new Map;#e=new Set;#r=new Map;#n=new Set;#o=new Map;#i=(0,ic.default)("automerge-repo:remote-heads-subscriptions");subscribeToRemotes(e){this.#i("subscribeToRemotes",e);let n=[];for(let r of e)this.#e.has(r)||(this.#e.add(r),n.push(r));n.length>0&&this.emit("change-remote-subs",{add:n,peers:Array.from(this.#n)})}unsubscribeFromRemotes(e){this.#i("subscribeToRemotes",e);let n=[];for(let r of e)this.#e.has(r)&&(this.#e.delete(r),this.#r.has(r)||n.push(r));n.length>0&&this.emit("change-remote-subs",{remove:n,peers:Array.from(this.#n)})}handleControlMessage(e){let n=[],r=[],s=[];if(this.#i("handleControlMessage",e),e.add)for(let o of e.add){let i=this.#r.get(o);(this.#e.has(o)||i)&&s.push(o),i||(i=new Set,this.#r.set(o,i),this.#e.has(o)||n.push(o)),i.add(e.senderId)}if(e.remove)for(let o of e.remove){let i=this.#r.get(o);i&&(i.delete(e.senderId),i.size==0&&!this.#e.has(o)&&r.push(o))}(n.length>0||r.length>0)&&this.emit("change-remote-subs",{peers:Array.from(this.#n),add:n,remove:r});for(let o of s){let i=this.#o.get(e.senderId);if(i)for(let a of i){let c=this.#t.get(a);if(!c)continue;let l=c.get(o);l&&this.emit("notify-remote-heads",{targetId:e.senderId,documentId:a,heads:l.heads,timestamp:l.timestamp,storageId:o})}}}handleRemoteHeads(e){this.#i("handleRemoteHeads",e);let n=this.#s(e);for(let r of n)this.#e.has(r.storageId)&&this.emit("remote-heads-changed",r);for(let r of n)for(let s of this.#n)s!==e.senderId&&this.emit("notify-remote-heads",{targetId:s,documentId:r.documentId,heads:r.remoteHeads,timestamp:r.timestamp,storageId:r.storageId});for(let r of n){let s=this.#r.get(r.storageId);if(s)for(let o of s)this.#a(o,r.documentId)&&this.emit("notify-remote-heads",{targetId:o,documentId:r.documentId,heads:r.remoteHeads,timestamp:r.timestamp,storageId:r.storageId})}}handleImmediateRemoteHeadsChanged(e,n,r){this.#i("handleLocalHeadsChanged",e,n,r);let s=this.#t.get(e),o=Date.now();if(!s)this.#t.set(e,new Map([[n,{heads:r,timestamp:o}]]));else{let a=s.get(n);(!a||a.timestamp<Date.now())&&s.set(n,{heads:r,timestamp:Date.now()})}let i=this.#r.get(n);if(i)for(let a of i)this.#a(a,e)&&this.emit("notify-remote-heads",{targetId:a,documentId:e,heads:r,timestamp:o,storageId:n})}addGenerousPeer(e){this.#i("addGenerousPeer",e),this.#n.add(e),this.#e.size>0&&this.emit("change-remote-subs",{add:Array.from(this.#e),peers:[e]});for(let[n,r]of this.#t)for(let[s,{heads:o,timestamp:i}]of r)this.emit("notify-remote-heads",{targetId:e,documentId:n,heads:o,timestamp:i,storageId:s})}removePeer(e){this.#i("removePeer",e);let n=[];this.#n.delete(e),this.#o.delete(e);for(let[r,s]of this.#r)s.has(e)&&(s.delete(e),s.size==0&&(n.push(r),this.#r.delete(r)));n.length>0&&this.emit("change-remote-subs",{remove:n,peers:Array.from(this.#n)})}subscribePeerToDoc(e,n){let r=this.#o.get(e);r||(r=new Set,this.#o.set(e,r)),r.add(n);let s=this.#t.get(n);if(s)for(let[o,i]of s){let a=this.#r.get(o);a&&a.has(e)&&this.emit("notify-remote-heads",{targetId:e,documentId:n,heads:i.heads,timestamp:i.timestamp,storageId:o})}}#a(e,n){let r=this.#o.get(e);return r&&r.has(n)}#s(e){let n=[],{documentId:r,newHeads:s}=e;for(let[o,{heads:i,timestamp:a}]of Object.entries(s)){if(!this.#e.has(o)&&!this.#r.has(o))continue;let c=this.#t.get(r);c||(c=new Map,this.#t.set(r,c));let l=c.get(o);l&&l.timestamp>=a||(c.set(o,{timestamp:a,heads:i}),n.push({documentId:r,storageId:o,remoteHeads:i,timestamp:a}))}return n}};var Nn=(t,e)=>{let n=Date.now(),r,s;return function(...o){r=n+e-Date.now(),clearTimeout(s),s=setTimeout(()=>{t(...o),n=Date.now()},r)}};var ac=Me(rt(),1);var Uo=t=>yd(t)||Do(t)||jo(t)||_d(t)||md(t)||bd(t),_d=t=>t.type==="doc-unavailable",jo=t=>t.type==="request",yd=t=>t.type==="sync",Do=t=>t.type==="ephemeral",md=t=>t.type==="remote-subscription-change",bd=t=>t.type==="remote-heads-changed";var wd=t=>`${t.senderId}:${t.sessionId}`,Jr=class extends Se.default{peerId;peerMetadata;#t;#e={};#r=0;#n=Math.random().toString(36).slice(2);#o={};adapters=[];constructor(e,n,r){super(),this.peerId=n,this.peerMetadata=r,this.#t=(0,ac.default)(`automerge-repo:network:${this.peerId}`),e.forEach(s=>this.addNetworkAdapter(s))}disconnect(){this.adapters.forEach(e=>e.disconnect())}reconnect(){this.adapters.forEach(e=>e.connect(this.peerId))}addNetworkAdapter(e){this.adapters.push(e),e.on("peer-candidate",({peerId:n,peerMetadata:r})=>{this.#t(`peer candidate: ${n} `),this.#e[n]||(this.#e[n]=e),this.emit("peer",{peerId:n,peerMetadata:r})}),e.on("peer-disconnected",({peerId:n})=>{this.#t(`peer disconnected: ${n} `),delete this.#e[n],this.emit("peer-disconnected",{peerId:n})}),e.on("message",n=>{if(!Uo(n)){this.#t(`invalid message: ${JSON.stringify(n)}`);return}if(this.#t(`message from ${n.senderId}`),Do(n)){let r=wd(n);(this.#o[r]===void 0||n.count>this.#o[r])&&(this.#o[r]=n.count,this.emit("message",n));return}this.emit("message",n)}),e.on("close",()=>{this.#t("adapter closed"),Object.entries(this.#e).forEach(([n,r])=>{r===e&&delete this.#e[n]})}),this.peerMetadata.then(n=>{e.connect(this.peerId,n)}).catch(n=>{this.#t("error connecting to network",n)})}removeNetworkAdapter(e){this.adapters=this.adapters.filter(n=>n!==e),e.disconnect()}send(e){let n=this.#e[e.targetId];if(!n){this.#t(`Tried to send message but peer not found: ${e.targetId}`);return}let s=(o=>o.type==="ephemeral"?"count"in o?o:{...o,count:++this.#r,sessionId:this.#n,senderId:this.peerId}:{...o,senderId:this.peerId})(e);this.#t("sending message %o",s),n.send(s)}isReady=()=>this.adapters.every(e=>e.isReady());whenReady=async()=>Promise.all(this.adapters.map(e=>e.whenReady()))};var hc=Me(rt(),1);function Kr(t){let e=0;t.forEach(s=>{e+=s.length});let n=new Uint8Array(e),r=0;return t.forEach(s=>{n.set(s,r),r+=s.length}),n}var uc=Me(fc(),1);function Po(t){let e=uc.hash(t);return xd(e)}function lc(t){let e=new TextEncoder,n=Kr(t.map(r=>e.encode(r)));return Po(n)}function xd(t){return Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}function dc(t){if(t.length<2)return null;let e=t[t.length-2];return e==="snapshot"||e==="incremental"?e:null}var Xr=class{#t;#e=new Map;#r=new Map;#n=!1;#o=(0,hc.default)("automerge-repo:storage-subsystem");constructor(e){this.#t=e}async id(){let e=await this.#t.load(["storage-adapter-id"]),n;return e?n=new TextDecoder().decode(e):(n=ht(),await this.#t.save(["storage-adapter-id"],new TextEncoder().encode(n))),n}async load(e,n){let r=[e,n];return await this.#t.load(r)}async save(e,n,r){let s=[e,n];await this.#t.save(s,r)}async remove(e,n){let r=[e,n];await this.#t.remove(r)}async loadDoc(e){let n=await this.#t.loadRange([e]),r=[],s=[];for(let a of n){if(a.data===void 0)continue;let c=dc(a.key);c!=null&&(s.push({key:a.key,type:c,size:a.data.length}),r.push(a.data))}this.#r.set(e,s);let o=Kr(r);if(o.length===0)return null;let i=_t(Ve(),o);return this.#e.set(e,ue(i)),i}async saveDoc(e,n){if(!this.#s(e,n))return;let r=this.#r.get(e)??[];this.#c(r)?await this.#a(e,n,r):await this.#i(e,n),this.#e.set(e,ue(n))}async removeDoc(e){await this.#t.removeRange([e,"snapshot"]),await this.#t.removeRange([e,"incremental"]),await this.#t.removeRange([e,"sync-state"])}async#i(e,n){let r=bn(n,this.#e.get(e)??[]);if(r&&r.length>0){let s=[e,"incremental",Po(r)];this.#o(`Saving incremental ${s} for document ${e}`),await this.#t.save(s,r),this.#r.has(e)||this.#r.set(e,[]),this.#r.get(e).push({key:s,type:"incremental",size:r.length}),this.#e.set(e,ue(n))}else return Promise.resolve()}async#a(e,n,r){this.#n=!0;let s=ln(n),o=lc(ue(n)),i=[e,"snapshot",o],a=new Set(r.map(l=>l.key).filter(l=>l[2]!==o));this.#o(`Saving snapshot ${i} for document ${e}`),this.#o(`deleting old chunks ${Array.from(a)}`),await this.#t.save(i,s);for(let l of a)await this.#t.remove(l);let c=this.#r.get(e)?.filter(l=>!a.has(l.key))??[];c.push({key:i,type:"snapshot",size:s.length}),this.#r.set(e,c),this.#n=!1}async loadSyncState(e,n){let r=[e,"sync-state",n];try{let s=await this.#t.load(r);return s?mt(s):void 0}catch{this.#o(`Error loading sync state for ${e} from ${n}`);return}}async saveSyncState(e,n,r){let s=[e,"sync-state",n];await this.#t.save(s,yt(r))}#s(e,n){let r=this.#e.get(e);if(!r)return!0;let s=ue(n);return!Yt(s,r)}#c(e){if(this.#n)return!1;let n=0,r=0;for(let s of e)s.type==="snapshot"?n+=s.size:r+=s.size;return n<1024||r>=n}};var gc=Me(rt(),1);var pc=Me(rt(),1);var Zt=class extends Se.default{};var Yr=class extends Zt{#t;syncDebounceRate=100;#e=[];#r={};#n={};#o={};#i=[];#a=!1;#s;#c;constructor({handle:e,onLoadSyncState:n}){super(),this.#s=e,this.#c=n??(()=>Promise.resolve(void 0));let r=e.documentId.slice(0,5);this.#t=(0,pc.default)(`automerge-repo:docsync:${r}`),e.on("change",Nn(()=>this.#g(),this.syncDebounceRate)),e.on("ephemeral-message-outbound",s=>this.#_(s)),(async()=>(await e.doc([Wr,Hn]),this.#p()))()}get peerStates(){return this.#n}get documentId(){return this.#s.documentId}async#g(){this.#t("syncWithPeers");let e=await this.#s.doc();e!==void 0&&this.#e.forEach(n=>this.#d(n,e))}async#_({data:e}){this.#t("broadcastToPeers",this.#e),this.#e.forEach(n=>this.#y(n,e))}#y(e,n){this.#t(`sendEphemeralMessage ->${e}`);let r={type:"ephemeral",targetId:e,documentId:this.#s.documentId,data:n};this.emit("message",r)}#u(e,n){this.#m(e),e in this.#n||(this.#n[e]="unknown");let r=this.#o[e];if(r){n(r);return}let s=this.#r[e];s||(this.#c(e).then(o=>{this.#b(e,o??yn())}).catch(o=>{this.#t(`Error loading sync state for ${e}: ${o}`)}),s=this.#r[e]=[]),s.push(n)}#m(e){this.#e.includes(e)||(this.#e.push(e),this.emit("open-doc",{documentId:this.documentId,peerId:e}))}#b(e,n){let r=this.#r[e];if(r)for(let s of r)s(n);delete this.#r[e],this.#o[e]=n}#l(e,n){this.#o[e]=n,this.emit("sync-state",{peerId:e,syncState:n,documentId:this.#s.documentId})}#d(e,n){this.#t(`sendSyncMessage ->${e}`),this.#u(e,r=>{let[s,o]=gn(n,r);if(o){this.#l(e,s);let i=ue(n).length===0;!this.#s.isReady()&&i&&s.sharedHeads.length===0&&!Object.values(this.#n).includes("has")&&this.#n[e]==="unknown"?this.emit("message",{type:"request",targetId:e,documentId:this.#s.documentId,data:o}):this.emit("message",{type:"sync",targetId:e,data:o,documentId:this.#s.documentId}),i||(this.#n[e]="has")}})}hasPeer(e){return this.#e.includes(e)}beginSync(e){let n=e.every(s=>this.#n[s]in["unavailable","wants"]),r=this.#s.doc([Wr,Hn,Mo]).then(s=>{if(this.#a=!0,this.#f(),!(s===void 0&&n))return s??Ve()});this.#t(`beginSync: ${e.join(", ")}`),e.forEach(s=>{this.#u(s,o=>{let i=mt(yt(o));this.#l(s,i),r.then(a=>{a&&this.#d(s,a)}).catch(a=>{this.#t(`Error loading doc for ${s}: ${a}`)})})})}endSync(e){this.#t(`removing peer ${e}`),this.#e=this.#e.filter(n=>n!==e)}receiveMessage(e){switch(e.type){case"sync":case"request":this.receiveSyncMessage(e);break;case"ephemeral":this.receiveEphemeralMessage(e);break;case"doc-unavailable":this.#n[e.senderId]="unavailable",this.#f();break;default:throw new Error(`unknown message type: ${e}`)}}receiveEphemeralMessage(e){if(e.documentId!==this.#s.documentId)throw new Error("channelId doesn't match documentId");let{senderId:n,data:r}=e,s=$n(new Uint8Array(r));this.#s.emit("ephemeral-message",{handle:this.#s,senderId:n,message:s}),this.#e.forEach(o=>{o!==n&&this.emit("message",{...e,targetId:o})})}receiveSyncMessage(e){if(e.documentId!==this.#s.documentId)throw new Error("channelId doesn't match documentId");if(!this.#s.inState([Wr,Hn,Mo])){this.#i.push({message:e,received:new Date});return}this.#p(),this.#h(e)}#h(e){jo(e)&&(this.#n[e.senderId]="wants"),this.#f(),mn(e.data).heads.length>0&&(this.#n[e.senderId]="has"),this.#u(e.senderId,n=>{this.#s.update(r=>{let[s,o]=_n(r,n,e.data);return this.#l(e.senderId,o),this.#d(e.senderId,r),s}),this.#f()})}#f(){this.#a&&this.#s.inState([Hn])&&this.#e.every(e=>this.#n[e]==="unavailable"||this.#n[e]==="wants")&&(this.#e.filter(e=>this.#n[e]==="wants").forEach(e=>{let n={type:"doc-unavailable",documentId:this.#s.documentId,targetId:e};this.emit("message",n)}),this.#s.unavailable())}#p(){for(let e of this.#i)this.#h(e.message);this.#i=[]}metrics(){return{peers:this.#e,size:this.#s.metrics()}}};var Bo=(0,gc.default)("automerge-repo:collectionsync"),Zr=class extends Zt{repo;#t=new Set;docSynchronizers={};#e={};constructor(e){super(),this.repo=e}#r(e){if(!this.docSynchronizers[e]){let n=this.repo.find(Jt({documentId:e}));this.docSynchronizers[e]=this.#n(n)}return this.docSynchronizers[e]}#n(e){let n=new Yr({handle:e,onLoadSyncState:async r=>{if(!this.repo.storageSubsystem)return;let{storageId:s,isEphemeral:o}=this.repo.peerMetadataByPeerId[r]||{};if(!(!s||o))return this.repo.storageSubsystem.loadSyncState(e.documentId,s)}});return n.on("message",r=>this.emit("message",r)),n.on("open-doc",r=>this.emit("open-doc",r)),n.on("sync-state",r=>this.emit("sync-state",r)),n}async#o(e){let n=Array.from(this.#t),r=[];for(let s of n)await this.repo.sharePolicy(s,e)&&r.push(s);return r}async receiveMessage(e){Bo(`onSyncMessage: ${e.senderId}, ${e.documentId}, ${"data"in e?e.data.byteLength+"bytes":""}`);let n=e.documentId;if(!n)throw new Error("received a message with an invalid documentId");this.#e[n]=!0;let r=this.#r(n);r.receiveMessage(e);let s=await this.#o(n);r.beginSync(s.filter(o=>!r.hasPeer(o)))}addDocument(e){if(this.#e[e])return;let n=this.#r(e);this.#o(e).then(r=>{n.beginSync(r)})}removeDocument(e){throw new Error("not implemented")}addPeer(e){if(Bo(`adding ${e} & synchronizing with them`),!this.#t.has(e)){this.#t.add(e);for(let n of Object.values(this.docSynchronizers)){let{documentId:r}=n;this.repo.sharePolicy(e,r).then(s=>{s&&n.beginSync([e])})}}}removePeer(e){Bo(`removing peer ${e}`),this.#t.delete(e);for(let n of Object.values(this.docSynchronizers))n.endSync(e)}get peers(){return Array.from(this.#t)}metrics(){return Object.fromEntries(Object.entries(this.docSynchronizers).map(([e,n])=>[e,n.metrics()]))}};function vd(){return"peer-"+Math.random().toString(36).slice(4)}var Fo=class extends Se.default{#t;networkSubsystem;storageSubsystem;saveDebounceRate=100;#e={};synchronizer;sharePolicy=async()=>!0;peerMetadataByPeerId={};#r=new qr;#n=!1;constructor({storage:e,network:n=[],peerId:r=vd(),sharePolicy:s,isEphemeral:o=e===void 0,enableRemoteHeadsGossiping:i=!1}={}){super(),this.#n=i,this.#t=(0,_c.default)("automerge-repo:repo"),this.sharePolicy=s??this.sharePolicy,this.on("delete-document",({documentId:h})=>{a&&a.removeDoc(h).catch(f=>{this.#t("error deleting document",{documentId:h,err:f})})}),this.synchronizer=new Zr(this),this.synchronizer.on("message",h=>{this.#t(`sending ${h.type} message to ${h.targetId}`),l.send(h)}),this.#n&&this.synchronizer.on("open-doc",({peerId:h,documentId:f})=>{this.#r.subscribePeerToDoc(h,f)});let a=e?new Xr(e):void 0;this.storageSubsystem=a;let c=(async()=>({storageId:await a?.id(),isEphemeral:o}))(),l=new Jr(n,r,c);this.networkSubsystem=l,l.on("peer",async({peerId:h,peerMetadata:f})=>{this.#t("peer connected",{peerId:h}),f&&(this.peerMetadataByPeerId[h]={...f}),this.sharePolicy(h).then(d=>{d&&this.#n&&this.#r.addGenerousPeer(h)}).catch(d=>{console.log("error in share policy",{err:d})}),this.synchronizer.addPeer(h)}),l.on("peer-disconnected",({peerId:h})=>{this.synchronizer.removePeer(h),this.#r.removePeer(h)}),l.on("message",async h=>{this.#i(h)}),this.synchronizer.on("sync-state",h=>{this.#s(h);let f=this.#e[h.documentId],{storageId:d}=this.peerMetadataByPeerId[h.peerId]||{};if(!d)return;let g=f.getRemoteHeads(d);h.syncState.theirHeads&&(!g||!Yt(g,h.syncState.theirHeads))&&h.syncState.theirHeads&&(f.setRemoteHeads(d,h.syncState.theirHeads),d&&this.#n&&this.#r.handleImmediateRemoteHeadsChanged(h.documentId,d,h.syncState.theirHeads))}),this.#n&&(this.#r.on("notify-remote-heads",h=>{this.networkSubsystem.send({type:"remote-heads-changed",targetId:h.targetId,documentId:h.documentId,newHeads:{[h.storageId]:{heads:h.heads,timestamp:h.timestamp}}})}),this.#r.on("change-remote-subs",h=>{this.#t("change-remote-subs",h);for(let f of h.peers)this.networkSubsystem.send({type:"remote-subscription-change",targetId:f,add:h.add,remove:h.remove})}),this.#r.on("remote-heads-changed",h=>{this.#e[h.documentId].setRemoteHeads(h.storageId,h.remoteHeads)}))}#o(e){let{storageSubsystem:n}=this;if(n){let r=({handle:s,doc:o})=>{n.saveDoc(s.documentId,o)};e.on("heads-changed",Nn(r,this.saveDebounceRate))}e.on("unavailable",()=>{this.#t("document unavailable",{documentId:e.documentId}),this.emit("unavailable-document",{documentId:e.documentId})}),this.synchronizer.addDocument(e.documentId),this.emit("document",{handle:e})}#i(e){switch(e.type){case"remote-subscription-change":this.#n&&this.#r.handleControlMessage(e);break;case"remote-heads-changed":this.#n&&this.#r.handleRemoteHeads(e);break;case"sync":case"request":case"ephemeral":case"doc-unavailable":this.synchronizer.receiveMessage(e).catch(n=>{console.log("error receiving message",{err:n})})}}#a={};#s(e){if(!this.storageSubsystem)return;let{storageId:n,isEphemeral:r}=this.peerMetadataByPeerId[e.peerId]||{};if(!n||r)return;let s=this.#a[n];s||(s=this.#a[n]=Nn(({documentId:o,syncState:i})=>{this.storageSubsystem.saveSyncState(o,n,i)},this.saveDebounceRate)),s(e)}#c({documentId:e}){if(this.#e[e])return this.#e[e];if(!e)throw new Error(`Invalid documentId ${e}`);let n=new zn(e);return this.#e[e]=n,n}get handles(){return this.#e}get peers(){return this.synchronizer.peers}getStorageIdOfPeer(e){return this.peerMetadataByPeerId[e]?.storageId}create(e){let{documentId:n}=Un(lo()),r=this.#c({documentId:n});return this.#o(r),r.update(()=>{let s;return e?s=De.from(e):s=De.emptyChange(De.init()),s}),r.doneLoading(),r}clone(e){if(!e.isReady())throw new Error(`Cloned handle is not yet in ready state.
        (Try await handle.whenReady() first.)`);let n=e.docSync();if(!n)throw new Error("Cloned handle doesn't have a document.");let r=this.create();return r.update(()=>De.clone(n)),r}find(e){let n=jn(e);if(this.#e[n])return this.#e[n].isUnavailable()&&setTimeout(()=>{this.#e[n].emit("unavailable",{handle:this.#e[n]})}),this.#e[n];let r=this.#c({documentId:n});return(this.storageSubsystem?this.storageSubsystem.loadDoc(r.documentId):Promise.resolve(null)).then(async o=>{o?(r.update(()=>o),r.doneLoading()):(await this.networkSubsystem.whenReady(),r.request()),this.#o(r)}).catch(o=>{this.#t("error waiting for network",{err:o})}),r}delete(e){let n=jn(e);this.#c({documentId:n}).delete(),delete this.#e[n],this.emit("delete-document",{documentId:n})}async export(e){let n=jn(e),s=await this.#c({documentId:n}).doc();if(s)return De.save(s)}import(e){let n=De.load(e),r=this.create();return r.update(()=>De.clone(n)),r}subscribeToRemotes=e=>{this.#n?(this.#t("subscribeToRemotes",{remotes:e}),this.#r.subscribeToRemotes(e)):this.#t("WARN: subscribeToRemotes called but remote heads gossiping is not enabled")};storageId=async()=>{if(this.storageSubsystem)return this.storageSubsystem.id()};async flush(e){if(!this.storageSubsystem)return;let n=e?e.map(r=>this.#e[r]):Object.values(this.#e);await Promise.all(n.map(async r=>{let s=r.docSync();if(s)return this.storageSubsystem.saveDoc(r.documentId,s)}))}shutdown(){return this.networkSubsystem.adapters.forEach(e=>{e.disconnect()}),this.flush()}metrics(){return{documents:this.synchronizer.metrics()}}};var $o=class extends Se.default{peerId;peerMetadata};var Lo=class{};export{oc as Automerge,de as Counter,zn as DocHandle,$o as NetworkAdapter,Ue as RawString,Fo as Repo,Lo as StorageAdapter,pn as applyChanges,ec as cbor,ar as deleteAt,lo as generateAutomergeUrl,hn as getAllChanges,fr as getChanges,_i as getConflicts,di as getCursor,hi as getCursorPosition,an as initializeBase64Wasm,Tt as initializeWasm,ir as insertAt,jn as interpretAsDocumentId,Uo as isRepoMessage,Da as isValidAutomergeUrl,uo as isValidDocumentId,pi as mark,Un as parseAutomergeUrl,ui as splice,Jt as stringifyAutomergeUrl,gi as unmark,li as updateText,Mt as view};
/*! Bundled license information:

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=slim.bundle.js.map